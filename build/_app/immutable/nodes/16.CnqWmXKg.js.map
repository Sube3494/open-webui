{"version":3,"file":"16.CnqWmXKg.js","sources":["../../../../../../src/lib/components/channel/Messages/Message/ProfilePreview.svelte","../../../../../../src/lib/components/icons/ChatBubbleOvalEllipsis.svelte","../../../../../../src/lib/components/icons/FaceSmile.svelte","../../../../../../node_modules/@sveltejs/svelte-virtual-list/VirtualList.svelte","../../../../../../src/lib/components/channel/Messages/Message/ReactionPicker.svelte","../../../../../../src/lib/components/channel/Messages/Message.svelte","../../../../../../src/lib/components/channel/Messages.svelte","../../../../../../src/lib/components/channel/MessageInput/InputMenu.svelte","../../../../../../src/lib/components/channel/MessageInput.svelte","../../../../../../src/lib/components/channel/Navbar.svelte","../../../../../../src/lib/components/channel/Thread.svelte","../../../../../../src/lib/components/channel/Channel.svelte","../../../../../../src/routes/(app)/channels/[id]/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\r\n\timport { DropdownMenu } from 'bits-ui';\r\n\timport { createEventDispatcher } from 'svelte';\r\n\r\n\timport { flyAndScale } from '$lib/utils/transitions';\r\n\timport { WEBUI_BASE_URL } from '$lib/constants';\r\n\timport { activeUserIds } from '$lib/stores';\r\n\r\n\texport let side = 'right';\r\n\texport let align = 'top';\r\n\r\n\texport let user = null;\r\n\tlet show = false;\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n</script>\r\n\r\n<DropdownMenu.Root\r\n\tbind:open={show}\r\n\tcloseFocus={false}\r\n\tonOpenChange={(state) => {\r\n\t\tdispatch('change', state);\r\n\t}}\r\n\ttypeahead={false}\r\n>\r\n\t<DropdownMenu.Trigger>\r\n\t\t<slot />\r\n\t</DropdownMenu.Trigger>\r\n\r\n\t<slot name=\"content\">\r\n\t\t<DropdownMenu.Content\r\n\t\t\tclass=\"max-w-full w-[240px] rounded-lg z-9999 bg-white dark:bg-black dark:text-white shadow-lg\"\r\n\t\t\tsideOffset={8}\r\n\t\t\t{side}\r\n\t\t\t{align}\r\n\t\t\ttransition={flyAndScale}\r\n\t\t>\r\n\t\t\t{#if user}\r\n\t\t\t\t<div class=\" flex flex-col gap-2 w-full rounded-lg\">\r\n\t\t\t\t\t<div class=\"py-8 relative bg-gray-900 rounded-t-lg\">\r\n\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\tcrossorigin=\"anonymous\"\r\n\t\t\t\t\t\t\tsrc={user?.profile_image_url ?? `${WEBUI_BASE_URL}/static/favicon.png`}\r\n\t\t\t\t\t\t\tclass=\" absolute -bottom-5 left-3 size-12 ml-0.5 object-cover rounded-full -translate-y-[1px]\"\r\n\t\t\t\t\t\t\talt=\"profile\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\" flex flex-col pt-4 pb-2.5 px-4\">\r\n\t\t\t\t\t\t<div class=\" -mb-1\">\r\n\t\t\t\t\t\t\t<span class=\"font-medium text-sm line-clamp-1\"> {user.name} </span>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\" flex items-center gap-2\">\r\n\t\t\t\t\t\t\t{#if $activeUserIds.includes(user.id)}\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<span class=\"relative flex size-2\">\r\n\t\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"relative inline-flex rounded-full size-2 bg-green-500\" />\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\" -translate-y-[1px]\">\r\n\t\t\t\t\t\t\t\t\t<span class=\"text-xs\"> Active </span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<span class=\"relative flex size-2\">\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"relative inline-flex rounded-full size-2 bg-gray-500\" />\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\" -translate-y-[1px]\">\r\n\t\t\t\t\t\t\t\t\t<span class=\"text-xs\"> Away </span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\t\t</DropdownMenu.Content>\r\n\t</slot>\r\n</DropdownMenu.Root>\r\n","<script lang=\"ts\">\r\n\texport let className = 'size-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\texport let className = 'size-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M15.182 15.182a4.5 4.5 0 0 1-6.364 0M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0ZM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Z\"\r\n\t/>\r\n</svg>\r\n","<script>\n\timport { onMount, tick } from 'svelte';\n\n\t// props\n\texport let items;\n\texport let height = '100%';\n\texport let itemHeight = undefined;\n\n\tlet foo;\n\n\t// read-only, but visible to consumers via bind:start\n\texport let start = 0;\n\texport let end = 0;\n\n\t// local state\n\tlet height_map = [];\n\tlet rows;\n\tlet viewport;\n\tlet contents;\n\tlet viewport_height = 0;\n\tlet visible;\n\tlet mounted;\n\n\tlet top = 0;\n\tlet bottom = 0;\n\tlet average_height;\n\n\t$: visible = items.slice(start, end).map((data, i) => {\n\t\treturn { index: i + start, data };\n\t});\n\n\t// whenever `items` changes, invalidate the current heightmap\n\t$: if (mounted) refresh(items, viewport_height, itemHeight);\n\n\tasync function refresh(items, viewport_height, itemHeight) {\n\t\tconst { scrollTop } = viewport;\n\n\t\tawait tick(); // wait until the DOM is up to date\n\n\t\tlet content_height = top - scrollTop;\n\t\tlet i = start;\n\n\t\twhile (content_height < viewport_height && i < items.length) {\n\t\t\tlet row = rows[i - start];\n\n\t\t\tif (!row) {\n\t\t\t\tend = i + 1;\n\t\t\t\tawait tick(); // render the newly visible row\n\t\t\t\trow = rows[i - start];\n\t\t\t}\n\n\t\t\tconst row_height = height_map[i] = itemHeight || row.offsetHeight;\n\t\t\tcontent_height += row_height;\n\t\t\ti += 1;\n\t\t}\n\n\t\tend = i;\n\n\t\tconst remaining = items.length - end;\n\t\taverage_height = (top + content_height) / end;\n\n\t\tbottom = remaining * average_height;\n\t\theight_map.length = items.length;\n\n\t}\n\n\tasync function handle_scroll() {\n\t\tconst { scrollTop } = viewport;\n\n\t\tconst old_start = start;\n\n\t\tfor (let v = 0; v < rows.length; v += 1) {\n\t\t\theight_map[start + v] = itemHeight || rows[v].offsetHeight;\n\t\t}\n\n\t\tlet i = 0;\n\t\tlet y = 0;\n\n\t\twhile (i < items.length) {\n\t\t\tconst row_height = height_map[i] || average_height;\n\t\t\tif (y + row_height > scrollTop) {\n\t\t\t\tstart = i;\n\t\t\t\ttop = y;\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\ty += row_height;\n\t\t\ti += 1;\n\t\t}\n\n\t\twhile (i < items.length) {\n\t\t\ty += height_map[i] || average_height;\n\t\t\ti += 1;\n\n\t\t\tif (y > scrollTop + viewport_height) break;\n\t\t}\n\n\t\tend = i;\n\n\t\tconst remaining = items.length - end;\n\t\taverage_height = y / end;\n\n\t\twhile (i < items.length) height_map[i++] = average_height;\n\t\tbottom = remaining * average_height;\n\n\t\t// prevent jumping if we scrolled up into unknown territory\n\t\tif (start < old_start) {\n\t\t\tawait tick();\n\n\t\t\tlet expected_height = 0;\n\t\t\tlet actual_height = 0;\n\n\t\t\tfor (let i = start; i < old_start; i +=1) {\n\t\t\t\tif (rows[i - start]) {\n\t\t\t\t\texpected_height += height_map[i];\n\t\t\t\t\tactual_height += itemHeight || rows[i - start].offsetHeight;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst d = actual_height - expected_height;\n\t\t\tviewport.scrollTo(0, scrollTop + d);\n\t\t}\n\n\t\t// TODO if we overestimated the space these\n\t\t// rows would occupy we may need to add some\n\t\t// more. maybe we can just call handle_scroll again?\n\t}\n\n\t// trigger initial refresh\n\tonMount(() => {\n\t\trows = contents.getElementsByTagName('svelte-virtual-list-row');\n\t\tmounted = true;\n\t});\n</script>\n\n<style>\n\tsvelte-virtual-list-viewport {\n\t\tposition: relative;\n\t\toverflow-y: auto;\n\t\t-webkit-overflow-scrolling:touch;\n\t\tdisplay: block;\n\t}\n\n\tsvelte-virtual-list-contents, svelte-virtual-list-row {\n\t\tdisplay: block;\n\t}\n\n\tsvelte-virtual-list-row {\n\t\toverflow: hidden;\n\t}\n</style>\n\n<svelte-virtual-list-viewport\n\tbind:this={viewport}\n\tbind:offsetHeight={viewport_height}\n\ton:scroll={handle_scroll}\n\tstyle=\"height: {height};\"\n>\n\t<svelte-virtual-list-contents\n\t\tbind:this={contents}\n\t\tstyle=\"padding-top: {top}px; padding-bottom: {bottom}px;\"\n\t>\n\t\t{#each visible as row (row.index)}\n\t\t\t<svelte-virtual-list-row>\n\t\t\t\t<slot item={row.data}>Missing template</slot>\n\t\t\t</svelte-virtual-list-row>\n\t\t{/each}\n\t</svelte-virtual-list-contents>\n</svelte-virtual-list-viewport>\n","<script lang=\"ts\">\r\n\timport { DropdownMenu } from 'bits-ui';\r\n\timport { flyAndScale } from '$lib/utils/transitions';\r\n\timport emojiGroups from '$lib/emoji-groups.json';\r\n\timport emojiShortCodes from '$lib/emoji-shortcodes.json';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport VirtualList from '@sveltejs/svelte-virtual-list';\r\n\r\n\texport let onClose = () => {};\r\n\texport let onSubmit = (name) => {};\r\n\texport let side = 'top';\r\n\texport let align = 'start';\r\n\texport let user = null;\r\n\r\n\tlet show = false;\r\n\tlet emojis = emojiShortCodes;\r\n\tlet search = '';\r\n\tlet flattenedEmojis = [];\r\n\tlet emojiRows = [];\r\n\r\n\t// Reactive statement to filter the emojis based on search query\r\n\t$: {\r\n\t\tif (search) {\r\n\t\t\temojis = Object.keys(emojiShortCodes).reduce((acc, key) => {\r\n\t\t\t\tif (key.includes(search)) {\r\n\t\t\t\t\tacc[key] = emojiShortCodes[key];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (Array.isArray(emojiShortCodes[key])) {\r\n\t\t\t\t\t\tconst filtered = emojiShortCodes[key].filter((emoji) => emoji.includes(search));\r\n\t\t\t\t\t\tif (filtered.length) {\r\n\t\t\t\t\t\t\tacc[key] = filtered;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (emojiShortCodes[key].includes(search)) {\r\n\t\t\t\t\t\t\tacc[key] = emojiShortCodes[key];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn acc;\r\n\t\t\t}, {});\r\n\t\t} else {\r\n\t\t\temojis = emojiShortCodes;\r\n\t\t}\r\n\t}\r\n\t// Flatten emoji groups and group them into rows of 8 for virtual scrolling\r\n\t$: {\r\n\t\tflattenedEmojis = [];\r\n\t\tObject.keys(emojiGroups).forEach((group) => {\r\n\t\t\tconst groupEmojis = emojiGroups[group].filter((emoji) => emojis[emoji]);\r\n\t\t\tif (groupEmojis.length > 0) {\r\n\t\t\t\tflattenedEmojis.push({ type: 'group', label: group });\r\n\t\t\t\tflattenedEmojis.push(\r\n\t\t\t\t\t...groupEmojis.map((emoji) => ({\r\n\t\t\t\t\t\ttype: 'emoji',\r\n\t\t\t\t\t\tname: emoji,\r\n\t\t\t\t\t\tshortCodes:\r\n\t\t\t\t\t\t\ttypeof emojiShortCodes[emoji] === 'string'\r\n\t\t\t\t\t\t\t\t? [emojiShortCodes[emoji]]\r\n\t\t\t\t\t\t\t\t: emojiShortCodes[emoji]\r\n\t\t\t\t\t}))\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t});\r\n\t\t// Group emojis into rows of 8\r\n\t\temojiRows = [];\r\n\t\tlet currentRow = [];\r\n\t\tflattenedEmojis.forEach((item) => {\r\n\t\t\tif (item.type === 'emoji') {\r\n\t\t\t\tcurrentRow.push(item);\r\n\t\t\t\tif (currentRow.length === 8) {\r\n\t\t\t\t\temojiRows.push(currentRow);\r\n\t\t\t\t\tcurrentRow = [];\r\n\t\t\t\t}\r\n\t\t\t} else if (item.type === 'group') {\r\n\t\t\t\tif (currentRow.length > 0) {\r\n\t\t\t\t\temojiRows.push(currentRow); // Push the remaining row\r\n\t\t\t\t\tcurrentRow = [];\r\n\t\t\t\t}\r\n\t\t\t\temojiRows.push([item]); // Add the group label as a separate row\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (currentRow.length > 0) {\r\n\t\t\temojiRows.push(currentRow); // Push the final row\r\n\t\t}\r\n\t}\r\n\tconst ROW_HEIGHT = 48; // Approximate height for a row with multiple emojis\r\n\t// Handle emoji selection\r\n\tfunction selectEmoji(emoji) {\r\n\t\tconst selectedCode = emoji.shortCodes[0];\r\n\t\tonSubmit(selectedCode);\r\n\t\tshow = false;\r\n\t}\r\n</script>\r\n\r\n<DropdownMenu.Root\r\n\tbind:open={show}\r\n\tcloseFocus={false}\r\n\tonOpenChange={(state) => {\r\n\t\tif (!state) {\r\n\t\t\tsearch = '';\r\n\t\t\tonClose();\r\n\t\t}\r\n\t}}\r\n\ttypeahead={false}\r\n>\r\n\t<DropdownMenu.Trigger>\r\n\t\t<slot />\r\n\t</DropdownMenu.Trigger>\r\n\t<DropdownMenu.Content\r\n\t\tclass=\"max-w-full w-80 bg-gray-50 dark:bg-gray-850 rounded-lg z-9999 shadow-lg dark:text-white\"\r\n\t\tsideOffset={8}\r\n\t\t{side}\r\n\t\t{align}\r\n\t\ttransition={flyAndScale}\r\n\t>\r\n\t\t<div class=\"mb-1 px-3 pt-2 pb-2\">\r\n\t\t\t<input\r\n\t\t\t\ttype=\"text\"\r\n\t\t\t\tclass=\"w-full text-sm bg-transparent outline-hidden\"\r\n\t\t\t\tplaceholder=\"Search all emojis\"\r\n\t\t\t\tbind:value={search}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t\t<!-- Virtualized Emoji List -->\r\n\t\t<div class=\"w-full flex justify-start h-96 overflow-y-auto px-3 pb-3 text-sm\">\r\n\t\t\t{#if emojiRows.length === 0}\r\n\t\t\t\t<div class=\"text-center text-xs text-gray-500 dark:text-gray-400\">No results</div>\r\n\t\t\t{:else}\r\n\t\t\t\t<div class=\"w-full flex ml-0.5\">\r\n\t\t\t\t\t<VirtualList rowHeight={ROW_HEIGHT} items={emojiRows} height={384} let:item>\r\n\t\t\t\t\t\t<div class=\"w-full\">\r\n\t\t\t\t\t\t\t{#if item.length === 1 && item[0].type === 'group'}\r\n\t\t\t\t\t\t\t\t<!-- Render group header -->\r\n\t\t\t\t\t\t\t\t<div class=\"text-xs font-medium mb-2 text-gray-500 dark:text-gray-400\">\r\n\t\t\t\t\t\t\t\t\t{item[0].label}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t<!-- Render emojis in a row -->\r\n\t\t\t\t\t\t\t\t<div class=\"flex items-center gap-1.5 w-full\">\r\n\t\t\t\t\t\t\t\t\t{#each item as emojiItem}\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\t\t\t\tcontent={emojiItem.shortCodes.map((code) => `:${code}:`).join(', ')}\r\n\t\t\t\t\t\t\t\t\t\t\tplacement=\"top\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"p-1.5 rounded-lg cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-700 transition\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => selectEmoji(emojiItem)}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"/assets/emojis/{emojiItem.name.toLowerCase()}.svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\talt={emojiItem.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tloading=\"lazy\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</VirtualList>\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t</DropdownMenu.Content>\r\n</DropdownMenu.Root>\r\n","<script lang=\"ts\">\r\n\timport dayjs from 'dayjs';\r\n\timport relativeTime from 'dayjs/plugin/relativeTime';\r\n\timport isToday from 'dayjs/plugin/isToday';\r\n\timport isYesterday from 'dayjs/plugin/isYesterday';\r\n\timport localizedFormat from 'dayjs/plugin/localizedFormat';\r\n\r\n\tdayjs.extend(relativeTime);\r\n\tdayjs.extend(isToday);\r\n\tdayjs.extend(isYesterday);\r\n\tdayjs.extend(localizedFormat);\r\n\r\n\timport { getContext, onMount } from 'svelte';\r\n\tconst i18n = getContext<Writable<i18nType>>('i18n');\r\n\r\n\timport { settings, user, shortCodesToEmojis } from '$lib/stores';\r\n\r\n\timport { WEBUI_BASE_URL } from '$lib/constants';\r\n\r\n\timport Markdown from '$lib/components/chat/Messages/Markdown.svelte';\r\n\timport ProfileImage from '$lib/components/chat/Messages/ProfileImage.svelte';\r\n\timport Name from '$lib/components/chat/Messages/Name.svelte';\r\n\timport ConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\r\n\timport GarbageBin from '$lib/components/icons/GarbageBin.svelte';\r\n\timport Pencil from '$lib/components/icons/Pencil.svelte';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport Textarea from '$lib/components/common/Textarea.svelte';\r\n\timport Image from '$lib/components/common/Image.svelte';\r\n\timport FileItem from '$lib/components/common/FileItem.svelte';\r\n\timport ProfilePreview from './Message/ProfilePreview.svelte';\r\n\timport ChatBubbleOvalEllipsis from '$lib/components/icons/ChatBubbleOvalEllipsis.svelte';\r\n\timport FaceSmile from '$lib/components/icons/FaceSmile.svelte';\r\n\timport ReactionPicker from './Message/ReactionPicker.svelte';\r\n\timport ChevronRight from '$lib/components/icons/ChevronRight.svelte';\r\n\timport { formatDate } from '$lib/utils';\r\n\r\n\texport let message;\r\n\texport let showUserProfile = true;\r\n\texport let thread = false;\r\n\r\n\texport let onDelete: Function = () => {};\r\n\texport let onEdit: Function = () => {};\r\n\texport let onThread: Function = () => {};\r\n\texport let onReaction: Function = () => {};\r\n\r\n\tlet showButtons = false;\r\n\r\n\tlet edit = false;\r\n\tlet editedContent = null;\r\n\tlet showDeleteConfirmDialog = false;\r\n</script>\r\n\r\n<ConfirmDialog\r\n\tbind:show={showDeleteConfirmDialog}\r\n\ttitle={$i18n.t('Delete Message')}\r\n\tmessage={$i18n.t('Are you sure you want to delete this message?')}\r\n\tonConfirm={async () => {\r\n\t\tawait onDelete();\r\n\t}}\r\n/>\r\n\r\n{#if message}\r\n\t<div\r\n\t\tclass=\"flex flex-col justify-between px-5 {showUserProfile\r\n\t\t\t? 'pt-1.5 pb-0.5'\r\n\t\t\t: ''} w-full {($settings?.widescreenMode ?? null)\r\n\t\t\t? 'max-w-full'\r\n\t\t\t: 'max-w-5xl'} mx-auto group hover:bg-gray-300/5 dark:hover:bg-gray-700/5 transition relative\"\r\n\t>\r\n\t\t{#if !edit}\r\n\t\t\t<div\r\n\t\t\t\tclass=\" absolute {showButtons ? '' : 'invisible group-hover:visible'} right-1 -top-2 z-10\"\r\n\t\t\t>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"flex gap-1 rounded-lg bg-white dark:bg-gray-850 shadow-md p-0.5 border border-gray-100 dark:border-gray-850\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<ReactionPicker\r\n\t\t\t\t\t\tonClose={() => (showButtons = false)}\r\n\t\t\t\t\t\tonSubmit={(name) => {\r\n\t\t\t\t\t\t\tshowButtons = false;\r\n\t\t\t\t\t\t\tonReaction(name);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Tooltip content={$i18n.t('Add Reaction')}>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclass=\"hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1\"\r\n\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\tshowButtons = true;\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<FaceSmile />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t</ReactionPicker>\r\n\r\n\t\t\t\t\t{#if !thread}\r\n\t\t\t\t\t\t<Tooltip content={$i18n.t('Reply in Thread')}>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclass=\"hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1\"\r\n\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\tonThread(message.id);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<ChatBubbleOvalEllipsis />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t{#if message.user_id === $user.id || $user.role === 'admin'}\r\n\t\t\t\t\t\t<Tooltip content={$i18n.t('Edit')}>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclass=\"hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1\"\r\n\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\tedit = true;\r\n\t\t\t\t\t\t\t\t\teditedContent = message.content;\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Pencil />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t\t\t<Tooltip content={$i18n.t('Delete')}>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclass=\"hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1\"\r\n\t\t\t\t\t\t\t\ton:click={() => (showDeleteConfirmDialog = true)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<GarbageBin />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\r\n\t\t<div\r\n\t\t\tclass=\" flex w-full message-{message.id}\"\r\n\t\t\tid=\"message-{message.id}\"\r\n\t\t\tdir={$settings.chatDirection}\r\n\t\t>\r\n\t\t\t<div\r\n\t\t\t\tclass={`shrink-0 ${($settings?.chatDirection ?? 'LTR') === 'LTR' ? 'mr-3' : 'ml-3'} w-9`}\r\n\t\t\t>\r\n\t\t\t\t{#if showUserProfile}\r\n\t\t\t\t\t<ProfilePreview user={message.user}>\r\n\t\t\t\t\t\t<ProfileImage\r\n\t\t\t\t\t\t\tsrc={message.user?.profile_image_url ??\r\n\t\t\t\t\t\t\t\t($i18n.language === 'dg-DG' ? `/doge.png` : `${WEBUI_BASE_URL}/static/favicon.png`)}\r\n\t\t\t\t\t\t\tclassName={'size-8 translate-y-1 ml-0.5'}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</ProfilePreview>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<!-- <div class=\"w-7 h-7 rounded-full bg-transparent\" /> -->\r\n\r\n\t\t\t\t\t{#if message.created_at}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\"mt-1.5 flex shrink-0 items-center text-xs self-center invisible group-hover:visible text-gray-500 font-medium first-letter:capitalize\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Tooltip content={dayjs(message.created_at / 1000000).format('LLLL')}>\r\n\t\t\t\t\t\t\t\t{dayjs(message.created_at / 1000000).format('HH:mm')}\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"flex-auto w-0 pl-1\">\r\n\t\t\t\t{#if showUserProfile}\r\n\t\t\t\t\t<Name>\r\n\t\t\t\t\t\t<div class=\" self-end text-base shrink-0 font-medium truncate\">\r\n\t\t\t\t\t\t\t{message?.user?.name}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{#if message.created_at}\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Tooltip content={dayjs(message.created_at / 1000000).format('LLLL')}>\r\n\t\t\t\t\t\t\t\t\t<span class=\"line-clamp-1\">{formatDate(message.created_at / 1000000)}</span>\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</Name>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if (message?.data?.files ?? []).length > 0}\r\n\t\t\t\t\t<div class=\"my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap\">\r\n\t\t\t\t\t\t{#each message?.data?.files as file}\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t{#if file.type === 'image'}\r\n\t\t\t\t\t\t\t\t\t<Image src={file.url} alt={file.name} imageClassName=\" max-h-96 rounded-lg\" />\r\n\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t<FileItem\r\n\t\t\t\t\t\t\t\t\t\titem={file}\r\n\t\t\t\t\t\t\t\t\t\turl={file.url}\r\n\t\t\t\t\t\t\t\t\t\tname={file.name}\r\n\t\t\t\t\t\t\t\t\t\ttype={file.type}\r\n\t\t\t\t\t\t\t\t\t\tsize={file?.size}\r\n\t\t\t\t\t\t\t\t\t\tcolorClassName=\"bg-white dark:bg-gray-850 \"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if edit}\r\n\t\t\t\t\t<div class=\"py-2\">\r\n\t\t\t\t\t\t<Textarea\r\n\t\t\t\t\t\t\tclassName=\" bg-transparent outline-hidden w-full resize-none\"\r\n\t\t\t\t\t\t\tbind:value={editedContent}\r\n\t\t\t\t\t\t\tonKeydown={(e) => {\r\n\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\r\n\t\t\t\t\t\t\t\t\tdocument.getElementById('close-edit-message-button')?.click();\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tconst isCmdOrCtrlPressed = e.metaKey || e.ctrlKey;\r\n\t\t\t\t\t\t\t\tconst isEnterPressed = e.key === 'Enter';\r\n\r\n\t\t\t\t\t\t\t\tif (isCmdOrCtrlPressed && isEnterPressed) {\r\n\t\t\t\t\t\t\t\t\tdocument.getElementById('confirm-edit-message-button')?.click();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<div class=\" mt-2 mb-1 flex justify-end text-sm font-medium\">\r\n\t\t\t\t\t\t\t<div class=\"flex space-x-1.5\">\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tid=\"close-edit-message-button\"\r\n\t\t\t\t\t\t\t\t\tclass=\"px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\tedit = false;\r\n\t\t\t\t\t\t\t\t\t\teditedContent = null;\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{$i18n.t('Cancel')}\r\n\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tid=\"confirm-edit-message-button\"\r\n\t\t\t\t\t\t\t\t\tclass=\" px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\t\t\t\t\tonEdit(editedContent);\r\n\t\t\t\t\t\t\t\t\t\tedit = false;\r\n\t\t\t\t\t\t\t\t\t\teditedContent = null;\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{$i18n.t('Save')}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<div class=\" min-w-full markdown-prose\">\r\n\t\t\t\t\t\t<Markdown\r\n\t\t\t\t\t\t\tid={message.id}\r\n\t\t\t\t\t\t\tcontent={message.content}\r\n\t\t\t\t\t\t/>{#if message.created_at !== message.updated_at}<span class=\"text-gray-500 text-[10px]\"\r\n\t\t\t\t\t\t\t\t>(edited)</span\r\n\t\t\t\t\t\t\t>{/if}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if (message?.reactions ?? []).length > 0}\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<div class=\"flex items-center flex-wrap gap-y-1.5 gap-1 mt-1 mb-2\">\r\n\t\t\t\t\t\t\t\t{#each message.reactions as reaction}\r\n\t\t\t\t\t\t\t\t\t<Tooltip content={`:${reaction.name}:`}>\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"flex items-center gap-1.5 transition rounded-xl px-2 py-1 cursor-pointer {reaction.user_ids.includes(\r\n\t\t\t\t\t\t\t\t\t\t\t\t$user.id\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t? ' bg-blue-300/10 outline outline-blue-500/50 outline-1'\r\n\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-gray-300/10 dark:bg-gray-500/10 hover:outline hover:outline-gray-700/30 dark:hover:outline-gray-300/30 hover:outline-1'}\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tonReaction(reaction.name);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{#if $shortCodesToEmojis[reaction.name]}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsrc=\"/assets/emojis/{$shortCodesToEmojis[\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treaction.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t].toLowerCase()}.svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\talt={reaction.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" size-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tloading=\"lazy\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{reaction.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t{#if reaction.user_ids.length > 0}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"text-xs font-medium text-gray-500 dark:text-gray-400\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{reaction.user_ids?.length}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t\t\t\t<ReactionPicker\r\n\t\t\t\t\t\t\t\t\tonSubmit={(name) => {\r\n\t\t\t\t\t\t\t\t\t\tonReaction(name);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Add Reaction')}>\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"flex items-center gap-1.5 bg-gray-500/10 hover:outline hover:outline-gray-700/30 dark:hover:outline-gray-300/30 hover:outline-1 transition rounded-xl px-1 py-1 cursor-pointer text-gray-500 dark:text-gray-400\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<FaceSmile />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t</ReactionPicker>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t{#if !thread && message.reply_count > 0}\r\n\t\t\t\t\t\t<div class=\"flex items-center gap-1.5 -mt-0.5 mb-1.5\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclass=\"flex items-center text-xs py-1 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition\"\r\n\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\tonThread(message.id);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<span class=\"font-medium mr-1\">\r\n\t\t\t\t\t\t\t\t\t{$i18n.t('{{COUNT}} Replies', { COUNT: message.reply_count })}</span\r\n\t\t\t\t\t\t\t\t><span>\r\n\t\t\t\t\t\t\t\t\t{' - '}{$i18n.t('Last reply')}\r\n\t\t\t\t\t\t\t\t\t{dayjs.unix(message.latest_reply_at / 1000000000).fromNow()}</span\r\n\t\t\t\t\t\t\t\t>\r\n\r\n\t\t\t\t\t\t\t\t<span class=\"ml-1\">\r\n\t\t\t\t\t\t\t\t\t<ChevronRight className=\"size-2.5\" strokeWidth=\"3\" />\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t<!-- {$i18n.t('View Replies')} -->\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\timport dayjs from 'dayjs';\r\n\timport relativeTime from 'dayjs/plugin/relativeTime';\r\n\timport isToday from 'dayjs/plugin/isToday';\r\n\timport isYesterday from 'dayjs/plugin/isYesterday';\r\n\r\n\tdayjs.extend(relativeTime);\r\n\tdayjs.extend(isToday);\r\n\tdayjs.extend(isYesterday);\r\n\timport { tick, getContext, onMount, createEventDispatcher } from 'svelte';\r\n\r\n\timport { settings, user } from '$lib/stores';\r\n\r\n\timport Message from './Messages/Message.svelte';\r\n\timport Loader from '../common/Loader.svelte';\r\n\timport Spinner from '../common/Spinner.svelte';\r\n\timport { addReaction, deleteMessage, removeReaction, updateMessage } from '$lib/apis/channels';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let id = null;\r\n\texport let channel = null;\r\n\texport let messages = [];\r\n\texport let top = false;\r\n\texport let thread = false;\r\n\r\n\texport let onLoad: Function = () => {};\r\n\texport let onThread: Function = () => {};\r\n\r\n\tlet messagesLoading = false;\r\n\r\n\tconst loadMoreMessages = async () => {\r\n\t\t// scroll slightly down to disable continuous loading\r\n\t\tconst element = document.getElementById('messages-container');\r\n\t\telement.scrollTop = element.scrollTop + 100;\r\n\r\n\t\tmessagesLoading = true;\r\n\r\n\t\tawait onLoad();\r\n\r\n\t\tawait tick();\r\n\t\tmessagesLoading = false;\r\n\t};\r\n</script>\r\n\r\n{#if messages}\r\n\t{@const messageList = messages.slice().reverse()}\r\n\t<div>\r\n\t\t{#if !top}\r\n\t\t\t<Loader\r\n\t\t\t\ton:visible={(e) => {\r\n\t\t\t\t\tconsole.log('visible');\r\n\t\t\t\t\tif (!messagesLoading) {\r\n\t\t\t\t\t\tloadMoreMessages();\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<div class=\"w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2\">\r\n\t\t\t\t\t<Spinner className=\" size-4\" />\r\n\t\t\t\t\t<div class=\" \">Loading...</div>\r\n\t\t\t\t</div>\r\n\t\t\t</Loader>\r\n\t\t{:else if !thread}\r\n\t\t\t<div\r\n\t\t\t\tclass=\"px-5\r\n\t\t\t\r\n\t\t\t{($settings?.widescreenMode ?? null) ? 'max-w-full' : 'max-w-5xl'} mx-auto\"\r\n\t\t\t>\r\n\t\t\t\t{#if channel}\r\n\t\t\t\t\t<div class=\"flex flex-col gap-1.5 pb-5 pt-10\">\r\n\t\t\t\t\t\t<div class=\"text-2xl font-medium capitalize\">{channel.name}</div>\r\n\r\n\t\t\t\t\t\t<div class=\" text-gray-500\">\r\n\t\t\t\t\t\t\tThis channel was created on {dayjs(channel.created_at / 1000000).format(\r\n\t\t\t\t\t\t\t\t'MMMM D, YYYY'\r\n\t\t\t\t\t\t\t)}. This is the very beginning of the {channel.name}\r\n\t\t\t\t\t\t\tchannel.\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<div class=\"flex justify-center text-xs items-center gap-2 py-5\">\r\n\t\t\t\t\t\t<div class=\" \">Start of the channel</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if messageList.length > 0}\r\n\t\t\t\t\t<hr class=\" border-gray-50 dark:border-gray-700/20 py-2.5 w-full\" />\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\r\n\t\t{#each messageList as message, messageIdx (id ? `${id}-${message.id}` : message.id)}\r\n\t\t\t<Message\r\n\t\t\t\t{message}\r\n\t\t\t\t{thread}\r\n\t\t\t\tshowUserProfile={messageIdx === 0 ||\r\n\t\t\t\t\tmessageList.at(messageIdx - 1)?.user_id !== message.user_id}\r\n\t\t\t\tonDelete={() => {\r\n\t\t\t\t\tmessages = messages.filter((m) => m.id !== message.id);\r\n\r\n\t\t\t\t\tconst res = deleteMessage(localStorage.token, message.channel_id, message.id).catch(\r\n\t\t\t\t\t\t(error) => {\r\n\t\t\t\t\t\t\ttoast.error(`${error}`);\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t}}\r\n\t\t\t\tonEdit={(content) => {\r\n\t\t\t\t\tmessages = messages.map((m) => {\r\n\t\t\t\t\t\tif (m.id === message.id) {\r\n\t\t\t\t\t\t\tm.content = content;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn m;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tconst res = updateMessage(localStorage.token, message.channel_id, message.id, {\r\n\t\t\t\t\t\tcontent: content\r\n\t\t\t\t\t}).catch((error) => {\r\n\t\t\t\t\t\ttoast.error(`${error}`);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t});\r\n\t\t\t\t}}\r\n\t\t\t\tonThread={(id) => {\r\n\t\t\t\t\tonThread(id);\r\n\t\t\t\t}}\r\n\t\t\t\tonReaction={(name) => {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\t(message?.reactions ?? [])\r\n\t\t\t\t\t\t\t.find((reaction) => reaction.name === name)\r\n\t\t\t\t\t\t\t?.user_ids?.includes($user.id) ??\r\n\t\t\t\t\t\tfalse\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tmessages = messages.map((m) => {\r\n\t\t\t\t\t\t\tif (m.id === message.id) {\r\n\t\t\t\t\t\t\t\tconst reaction = m.reactions.find((reaction) => reaction.name === name);\r\n\r\n\t\t\t\t\t\t\t\tif (reaction) {\r\n\t\t\t\t\t\t\t\t\treaction.user_ids = reaction.user_ids.filter((id) => id !== $user.id);\r\n\t\t\t\t\t\t\t\t\treaction.count = reaction.user_ids.length;\r\n\r\n\t\t\t\t\t\t\t\t\tif (reaction.count === 0) {\r\n\t\t\t\t\t\t\t\t\t\tm.reactions = m.reactions.filter((r) => r.name !== name);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn m;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tconst res = removeReaction(\r\n\t\t\t\t\t\t\tlocalStorage.token,\r\n\t\t\t\t\t\t\tmessage.channel_id,\r\n\t\t\t\t\t\t\tmessage.id,\r\n\t\t\t\t\t\t\tname\r\n\t\t\t\t\t\t).catch((error) => {\r\n\t\t\t\t\t\t\ttoast.error(`${error}`);\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmessages = messages.map((m) => {\r\n\t\t\t\t\t\t\tif (m.id === message.id) {\r\n\t\t\t\t\t\t\t\tif (m.reactions) {\r\n\t\t\t\t\t\t\t\t\tconst reaction = m.reactions.find((reaction) => reaction.name === name);\r\n\r\n\t\t\t\t\t\t\t\t\tif (reaction) {\r\n\t\t\t\t\t\t\t\t\t\treaction.user_ids.push($user.id);\r\n\t\t\t\t\t\t\t\t\t\treaction.count = reaction.user_ids.length;\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tm.reactions.push({\r\n\t\t\t\t\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\t\t\t\t\tuser_ids: [$user.id],\r\n\t\t\t\t\t\t\t\t\t\t\tcount: 1\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn m;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tconst res = addReaction(localStorage.token, message.channel_id, message.id, name).catch(\r\n\t\t\t\t\t\t\t(error) => {\r\n\t\t\t\t\t\t\t\ttoast.error(`${error}`);\r\n\t\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t{/each}\r\n\r\n\t\t<div class=\"pb-6\" />\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { DropdownMenu } from 'bits-ui';\r\n\timport { flyAndScale } from '$lib/utils/transitions';\r\n\timport { getContext, onMount, tick } from 'svelte';\r\n\r\n\timport { config, user, tools as _tools, mobile } from '$lib/stores';\r\n\timport { getTools } from '$lib/apis/tools';\r\n\r\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport DocumentArrowUpSolid from '$lib/components/icons/DocumentArrowUpSolid.svelte';\r\n\timport Switch from '$lib/components/common/Switch.svelte';\r\n\timport GlobeAltSolid from '$lib/components/icons/GlobeAltSolid.svelte';\r\n\timport WrenchSolid from '$lib/components/icons/WrenchSolid.svelte';\r\n\timport CameraSolid from '$lib/components/icons/CameraSolid.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let screenCaptureHandler: Function;\r\n\texport let uploadFilesHandler: Function;\r\n\r\n\texport let onClose: Function = () => {};\r\n\r\n\tlet show = false;\r\n\r\n\t$: if (show) {\r\n\t\tinit();\r\n\t}\r\n\r\n\tconst init = async () => {};\r\n</script>\r\n\r\n<Dropdown\r\n\tbind:show\r\n\ton:change={(e) => {\r\n\t\tif (e.detail === false) {\r\n\t\t\tonClose();\r\n\t\t}\r\n\t}}\r\n>\r\n\t<Tooltip content={$i18n.t('More')}>\r\n\t\t<slot />\r\n\t</Tooltip>\r\n\r\n\t<div slot=\"content\">\r\n\t\t<DropdownMenu.Content\r\n\t\t\tclass=\"w-full max-w-[200px] rounded-xl px-1 py-1  border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-sm\"\r\n\t\t\tsideOffset={15}\r\n\t\t\talignOffset={-8}\r\n\t\t\tside=\"top\"\r\n\t\t\talign=\"start\"\r\n\t\t\ttransition={flyAndScale}\r\n\t\t>\r\n\t\t\t{#if !$mobile}\r\n\t\t\t\t<DropdownMenu.Item\r\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl\"\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tscreenCaptureHandler();\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<CameraSolid />\r\n\t\t\t\t\t<div class=\" line-clamp-1\">{$i18n.t('Capture')}</div>\r\n\t\t\t\t</DropdownMenu.Item>\r\n\t\t\t{/if}\r\n\r\n\t\t\t<DropdownMenu.Item\r\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\r\n\t\t\t\ton:click={() => {\r\n\t\t\t\t\tuploadFilesHandler();\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<DocumentArrowUpSolid />\r\n\t\t\t\t<div class=\"line-clamp-1\">{$i18n.t('Upload Files')}</div>\r\n\t\t\t</DropdownMenu.Item>\r\n\t\t</DropdownMenu.Content>\r\n\t</div>\r\n</Dropdown>\r\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\timport { v4 as uuidv4 } from 'uuid';\r\n\r\n\timport { tick, getContext, onMount, onDestroy } from 'svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\timport { config, mobile, settings, socket } from '$lib/stores';\r\n\timport { blobToFile, compressImage } from '$lib/utils';\r\n\r\n\timport Tooltip from '../common/Tooltip.svelte';\r\n\timport RichTextInput from '../common/RichTextInput.svelte';\r\n\timport VoiceRecording from '../chat/MessageInput/VoiceRecording.svelte';\r\n\timport InputMenu from './MessageInput/InputMenu.svelte';\r\n\timport { uploadFile } from '$lib/apis/files';\r\n\timport { WEBUI_API_BASE_URL } from '$lib/constants';\r\n\timport FileItem from '../common/FileItem.svelte';\r\n\timport Image from '../common/Image.svelte';\r\n\timport { transcribeAudio } from '$lib/apis/audio';\r\n\timport FilesOverlay from '../chat/MessageInput/FilesOverlay.svelte';\r\n\r\n\texport let placeholder = $i18n.t('Send a Message');\r\n\texport let transparentBackground = false;\r\n\r\n\texport let id = null;\r\n\r\n\tlet draggedOver = false;\r\n\r\n\tlet recording = false;\r\n\tlet content = '';\r\n\tlet files = [];\r\n\r\n\tlet filesInputElement;\r\n\tlet inputFiles;\r\n\r\n\texport let typingUsers = [];\r\n\r\n\texport let onSubmit: Function;\r\n\texport let onChange: Function;\r\n\texport let scrollEnd = true;\r\n\texport let scrollToBottom: Function = () => {};\r\n\r\n\tconst screenCaptureHandler = async () => {\r\n\t\ttry {\r\n\t\t\t// Request screen media\r\n\t\t\tconst mediaStream = await navigator.mediaDevices.getDisplayMedia({\r\n\t\t\t\tvideo: { cursor: 'never' },\r\n\t\t\t\taudio: false\r\n\t\t\t});\r\n\t\t\t// Once the user selects a screen, temporarily create a video element\r\n\t\t\tconst video = document.createElement('video');\r\n\t\t\tvideo.srcObject = mediaStream;\r\n\t\t\t// Ensure the video loads without affecting user experience or tab switching\r\n\t\t\tawait video.play();\r\n\t\t\t// Set up the canvas to match the video dimensions\r\n\t\t\tconst canvas = document.createElement('canvas');\r\n\t\t\tcanvas.width = video.videoWidth;\r\n\t\t\tcanvas.height = video.videoHeight;\r\n\t\t\t// Grab a single frame from the video stream using the canvas\r\n\t\t\tconst context = canvas.getContext('2d');\r\n\t\t\tcontext.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n\t\t\t// Stop all video tracks (stop screen sharing) after capturing the image\r\n\t\t\tmediaStream.getTracks().forEach((track) => track.stop());\r\n\r\n\t\t\t// bring back focus to this current tab, so that the user can see the screen capture\r\n\t\t\twindow.focus();\r\n\r\n\t\t\t// Convert the canvas to a Base64 image URL\r\n\t\t\tconst imageUrl = canvas.toDataURL('image/png');\r\n\t\t\t// Add the captured image to the files array to render it\r\n\t\t\tfiles = [...files, { type: 'image', url: imageUrl }];\r\n\t\t\t// Clean memory: Clear video srcObject\r\n\t\t\tvideo.srcObject = null;\r\n\t\t} catch (error) {\r\n\t\t\t// Handle any errors (e.g., user cancels screen sharing)\r\n\t\t\tconsole.error('Error capturing screen:', error);\r\n\t\t}\r\n\t};\r\n\r\n\tconst inputFilesHandler = async (inputFiles) => {\r\n\t\tinputFiles.forEach((file) => {\r\n\t\t\tconsole.log('Processing file:', {\r\n\t\t\t\tname: file.name,\r\n\t\t\t\ttype: file.type,\r\n\t\t\t\tsize: file.size,\r\n\t\t\t\textension: file.name.split('.').at(-1)\r\n\t\t\t});\r\n\r\n\t\t\tif (\r\n\t\t\t\t($config?.file?.max_size ?? null) !== null &&\r\n\t\t\t\tfile.size > ($config?.file?.max_size ?? 0) * 1024 * 1024\r\n\t\t\t) {\r\n\t\t\t\tconsole.log('File exceeds max size limit:', {\r\n\t\t\t\t\tfileSize: file.size,\r\n\t\t\t\t\tmaxSize: ($config?.file?.max_size ?? 0) * 1024 * 1024\r\n\t\t\t\t});\r\n\t\t\t\ttoast.error(\r\n\t\t\t\t\t$i18n.t(`File size should not exceed {{maxSize}} MB.`, {\r\n\t\t\t\t\t\tmaxSize: $config?.file?.max_size\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\t['image/gif', 'image/webp', 'image/jpeg', 'image/png', 'image/avif'].includes(file['type'])\r\n\t\t\t) {\r\n\t\t\t\tlet reader = new FileReader();\r\n\r\n\t\t\t\treader.onload = async (event) => {\r\n\t\t\t\t\tlet imageUrl = event.target.result;\r\n\r\n\t\t\t\t\tif ($settings?.imageCompression ?? false) {\r\n\t\t\t\t\t\tconst width = $settings?.imageCompressionSize?.width ?? null;\r\n\t\t\t\t\t\tconst height = $settings?.imageCompressionSize?.height ?? null;\r\n\r\n\t\t\t\t\t\tif (width || height) {\r\n\t\t\t\t\t\t\timageUrl = await compressImage(imageUrl, width, height);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfiles = [\r\n\t\t\t\t\t\t...files,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttype: 'image',\r\n\t\t\t\t\t\t\turl: `${imageUrl}`\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t];\r\n\t\t\t\t};\r\n\r\n\t\t\t\treader.readAsDataURL(file);\r\n\t\t\t} else {\r\n\t\t\t\tuploadFileHandler(file);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tconst uploadFileHandler = async (file) => {\r\n\t\tconst tempItemId = uuidv4();\r\n\t\tconst fileItem = {\r\n\t\t\ttype: 'file',\r\n\t\t\tfile: '',\r\n\t\t\tid: null,\r\n\t\t\turl: '',\r\n\t\t\tname: file.name,\r\n\t\t\tcollection_name: '',\r\n\t\t\tstatus: 'uploading',\r\n\t\t\tsize: file.size,\r\n\t\t\terror: '',\r\n\t\t\titemId: tempItemId\r\n\t\t};\r\n\r\n\t\tif (fileItem.size == 0) {\r\n\t\t\ttoast.error($i18n.t('You cannot upload an empty file.'));\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tfiles = [...files, fileItem];\r\n\t\t// Check if the file is an audio file and transcribe/convert it to text file\r\n\t\tif (['audio/mpeg', 'audio/wav', 'audio/ogg', 'audio/x-m4a'].includes(file['type'])) {\r\n\t\t\tconst res = await transcribeAudio(localStorage.token, file).catch((error) => {\r\n\t\t\t\ttoast.error(`${error}`);\r\n\t\t\t\treturn null;\r\n\t\t\t});\r\n\r\n\t\t\tif (res) {\r\n\t\t\t\tconsole.log(res);\r\n\t\t\t\tconst blob = new Blob([res.text], { type: 'text/plain' });\r\n\t\t\t\tfile = blobToFile(blob, `${file.name}.txt`);\r\n\r\n\t\t\t\tfileItem.name = file.name;\r\n\t\t\t\tfileItem.size = file.size;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\t// During the file upload, file content is automatically extracted.\r\n\t\t\tconst uploadedFile = await uploadFile(localStorage.token, file);\r\n\r\n\t\t\tif (uploadedFile) {\r\n\t\t\t\tconsole.log('File upload completed:', {\r\n\t\t\t\t\tid: uploadedFile.id,\r\n\t\t\t\t\tname: fileItem.name,\r\n\t\t\t\t\tcollection: uploadedFile?.meta?.collection_name\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (uploadedFile.error) {\r\n\t\t\t\t\tconsole.warn('File upload warning:', uploadedFile.error);\r\n\t\t\t\t\ttoast.warning(uploadedFile.error);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfileItem.status = 'uploaded';\r\n\t\t\t\tfileItem.file = uploadedFile;\r\n\t\t\t\tfileItem.id = uploadedFile.id;\r\n\t\t\t\tfileItem.collection_name =\r\n\t\t\t\t\tuploadedFile?.meta?.collection_name || uploadedFile?.collection_name;\r\n\t\t\t\tfileItem.url = `${WEBUI_API_BASE_URL}/files/${uploadedFile.id}`;\r\n\r\n\t\t\t\tfiles = files;\r\n\t\t\t} else {\r\n\t\t\t\tfiles = files.filter((item) => item?.itemId !== tempItemId);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\ttoast.error(`${e}`);\r\n\t\t\tfiles = files.filter((item) => item?.itemId !== tempItemId);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleKeyDown = (event: KeyboardEvent) => {\r\n\t\tif (event.key === 'Escape') {\r\n\t\t\tconsole.log('Escape');\r\n\t\t\tdraggedOver = false;\r\n\t\t}\r\n\t};\r\n\r\n\tconst onDragOver = (e) => {\r\n\t\te.preventDefault();\r\n\r\n\t\t// Check if a file is being draggedOver.\r\n\t\tif (e.dataTransfer?.types?.includes('Files')) {\r\n\t\t\tdraggedOver = true;\r\n\t\t} else {\r\n\t\t\tdraggedOver = false;\r\n\t\t}\r\n\t};\r\n\r\n\tconst onDragLeave = () => {\r\n\t\tdraggedOver = false;\r\n\t};\r\n\r\n\tconst onDrop = async (e) => {\r\n\t\te.preventDefault();\r\n\t\tconsole.log(e);\r\n\r\n\t\tif (e.dataTransfer?.files) {\r\n\t\t\tconst inputFiles = Array.from(e.dataTransfer?.files);\r\n\t\t\tif (inputFiles && inputFiles.length > 0) {\r\n\t\t\t\tconsole.log(inputFiles);\r\n\t\t\t\tinputFilesHandler(inputFiles);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tdraggedOver = false;\r\n\t};\r\n\r\n\tconst submitHandler = async () => {\r\n\t\tif (content === '' && files.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tonSubmit({\r\n\t\t\tcontent,\r\n\t\t\tdata: {\r\n\t\t\t\tfiles: files\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tcontent = '';\r\n\t\tfiles = [];\r\n\r\n\t\tawait tick();\r\n\r\n\t\tconst chatInputElement = document.getElementById(`chat-input-${id}`);\r\n\t\tchatInputElement?.focus();\r\n\t};\r\n\r\n\t$: if (content) {\r\n\t\tonChange();\r\n\t}\r\n\r\n\tonMount(async () => {\r\n\t\twindow.setTimeout(() => {\r\n\t\t\tconst chatInput = document.getElementById(`chat-input-${id}`);\r\n\t\t\tchatInput?.focus();\r\n\t\t}, 0);\r\n\r\n\t\twindow.addEventListener('keydown', handleKeyDown);\r\n\t\tawait tick();\r\n\r\n\t\tconst dropzoneElement = document.getElementById('channel-container');\r\n\r\n\t\tdropzoneElement?.addEventListener('dragover', onDragOver);\r\n\t\tdropzoneElement?.addEventListener('drop', onDrop);\r\n\t\tdropzoneElement?.addEventListener('dragleave', onDragLeave);\r\n\t});\r\n\r\n\tonDestroy(() => {\r\n\t\tconsole.log('destroy');\r\n\t\twindow.removeEventListener('keydown', handleKeyDown);\r\n\r\n\t\tconst dropzoneElement = document.getElementById('channel-container');\r\n\r\n\t\tif (dropzoneElement) {\r\n\t\t\tdropzoneElement?.removeEventListener('dragover', onDragOver);\r\n\t\t\tdropzoneElement?.removeEventListener('drop', onDrop);\r\n\t\t\tdropzoneElement?.removeEventListener('dragleave', onDragLeave);\r\n\t\t}\r\n\t});\r\n</script>\r\n\r\n<FilesOverlay show={draggedOver} />\r\n\r\n<input\r\n\tbind:this={filesInputElement}\r\n\tbind:files={inputFiles}\r\n\ttype=\"file\"\r\n\thidden\r\n\tmultiple\r\n\ton:change={async () => {\r\n\t\tif (inputFiles && inputFiles.length > 0) {\r\n\t\t\tinputFilesHandler(Array.from(inputFiles));\r\n\t\t} else {\r\n\t\t\ttoast.error($i18n.t(`File not found.`));\r\n\t\t}\r\n\r\n\t\tfilesInputElement.value = '';\r\n\t}}\r\n/>\r\n<div class=\"bg-transparent\">\r\n\t<div\r\n\t\tclass=\"{($settings?.widescreenMode ?? null)\r\n\t\t\t? 'max-w-full'\r\n\t\t\t: 'max-w-6xl'} px-2.5 mx-auto inset-x-0 relative\"\r\n\t>\r\n\t\t<div class=\"absolute top-0 left-0 right-0 mx-auto inset-x-0 bg-transparent flex justify-center\">\r\n\t\t\t<div class=\"flex flex-col px-3 w-full\">\r\n\t\t\t\t<div class=\"relative\">\r\n\t\t\t\t\t{#if scrollEnd === false}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\" absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclass=\" bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto\"\r\n\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\tscrollEnd = true;\r\n\t\t\t\t\t\t\t\t\tscrollToBottom();\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\tclass=\"w-5 h-5\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t\td=\"M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z\"\r\n\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"relative\">\r\n\t\t\t\t\t<div class=\" -mt-5\">\r\n\t\t\t\t\t\t{#if typingUsers.length > 0}\r\n\t\t\t\t\t\t\t<div class=\" text-xs px-4 mb-1\">\r\n\t\t\t\t\t\t\t\t<span class=\" font-normal text-black dark:text-white\">\r\n\t\t\t\t\t\t\t\t\t{typingUsers.map((user) => user.name).join(', ')}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t{$i18n.t('is typing...')}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"\">\r\n\t\t\t{#if recording}\r\n\t\t\t\t<VoiceRecording\r\n\t\t\t\t\tbind:recording\r\n\t\t\t\t\ton:cancel={async () => {\r\n\t\t\t\t\t\trecording = false;\r\n\r\n\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\tdocument.getElementById(`chat-input-${id}`)?.focus();\r\n\t\t\t\t\t}}\r\n\t\t\t\t\ton:confirm={async (e) => {\r\n\t\t\t\t\t\tconst { text, filename } = e.detail;\r\n\t\t\t\t\t\tcontent = `${content}${text} `;\r\n\t\t\t\t\t\trecording = false;\r\n\r\n\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\tdocument.getElementById(`chat-input-${id}`)?.focus();\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t{:else}\r\n\t\t\t\t<form\r\n\t\t\t\t\tclass=\"w-full flex gap-1.5\"\r\n\t\t\t\t\ton:submit|preventDefault={() => {\r\n\t\t\t\t\t\tsubmitHandler();\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\"flex-1 flex flex-col relative w-full rounded-3xl px-1 bg-gray-600/5 dark:bg-gray-400/5 dark:text-gray-100\"\r\n\t\t\t\t\t\tdir={$settings?.chatDirection ?? 'LTR'}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#if files.length > 0}\r\n\t\t\t\t\t\t\t<div class=\"mx-2 mt-2.5 -mb-1 flex flex-wrap gap-2\">\r\n\t\t\t\t\t\t\t\t{#each files as file, fileIdx}\r\n\t\t\t\t\t\t\t\t\t{#if file.type === 'image'}\r\n\t\t\t\t\t\t\t\t\t\t<div class=\" relative group\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"relative\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Image\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={file.url}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"input\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\timageClassName=\" h-16 w-16 rounded-xl object-cover\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\" absolute -top-1 -right-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" bg-white text-black border border-white rounded-full group-hover:visible invisible transition\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles.splice(fileIdx, 1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles = files;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t<FileItem\r\n\t\t\t\t\t\t\t\t\t\t\titem={file}\r\n\t\t\t\t\t\t\t\t\t\t\tname={file.name}\r\n\t\t\t\t\t\t\t\t\t\t\ttype={file.type}\r\n\t\t\t\t\t\t\t\t\t\t\tsize={file?.size}\r\n\t\t\t\t\t\t\t\t\t\t\tloading={file.status === 'uploading'}\r\n\t\t\t\t\t\t\t\t\t\t\tdismissible={true}\r\n\t\t\t\t\t\t\t\t\t\t\tedit={true}\r\n\t\t\t\t\t\t\t\t\t\t\ton:dismiss={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tfiles.splice(fileIdx, 1);\r\n\t\t\t\t\t\t\t\t\t\t\t\tfiles = files;\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(file);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t<div class=\"px-2.5\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\"scrollbar-hidden font-primary text-left bg-transparent dark:text-gray-100 outline-hidden w-full pt-3 px-1 rounded-xl resize-none h-fit max-h-80 overflow-auto\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<RichTextInput\r\n\t\t\t\t\t\t\t\t\tbind:value={content}\r\n\t\t\t\t\t\t\t\t\tid={`chat-input-${id}`}\r\n\t\t\t\t\t\t\t\t\tmessageInput={true}\r\n\t\t\t\t\t\t\t\t\tshiftEnter={!$mobile ||\r\n\t\t\t\t\t\t\t\t\t\t!(\r\n\t\t\t\t\t\t\t\t\t\t\t'ontouchstart' in window ||\r\n\t\t\t\t\t\t\t\t\t\t\tnavigator.maxTouchPoints > 0 ||\r\n\t\t\t\t\t\t\t\t\t\t\tnavigator.msMaxTouchPoints > 0\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t{placeholder}\r\n\t\t\t\t\t\t\t\t\tlargeTextAsFile={$settings?.largeTextAsFile ?? false}\r\n\t\t\t\t\t\t\t\t\ton:keydown={async (e) => {\r\n\t\t\t\t\t\t\t\t\t\te = e.detail.event;\r\n\t\t\t\t\t\t\t\t\t\tconst isCtrlPressed = e.ctrlKey || e.metaKey; // metaKey is for Cmd key on Mac\r\n\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\t!$mobile ||\r\n\t\t\t\t\t\t\t\t\t\t\t!(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'ontouchstart' in window ||\r\n\t\t\t\t\t\t\t\t\t\t\t\tnavigator.maxTouchPoints > 0 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\tnavigator.msMaxTouchPoints > 0\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t\t// Prevent Enter key from creating a new line\r\n\t\t\t\t\t\t\t\t\t\t\t// Uses keyCode '13' for Enter key for chinese/japanese keyboards\r\n\t\t\t\t\t\t\t\t\t\t\tif (e.keyCode === 13 && !e.shiftKey) {\r\n\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t// Submit the content when Enter key is pressed\r\n\t\t\t\t\t\t\t\t\t\t\tif (content !== '' && e.keyCode === 13 && !e.shiftKey) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsubmitHandler();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('Escape');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\ton:paste={async (e) => {\r\n\t\t\t\t\t\t\t\t\t\te = e.detail.event;\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(e);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\" flex justify-between mb-2.5 mt-1.5 mx-0.5\">\r\n\t\t\t\t\t\t\t<div class=\"ml-1 self-end flex space-x-1\">\r\n\t\t\t\t\t\t\t\t<InputMenu\r\n\t\t\t\t\t\t\t\t\t{screenCaptureHandler}\r\n\t\t\t\t\t\t\t\t\tuploadFilesHandler={() => {\r\n\t\t\t\t\t\t\t\t\t\tfilesInputElement.click();\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"bg-transparent hover:bg-white/80 text-gray-800 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5 outline-hidden focus:outline-hidden\"\r\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\taria-label=\"More\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</InputMenu>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"self-end flex space-x-1 mr-1\">\r\n\t\t\t\t\t\t\t\t{#if content === ''}\r\n\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Record voice')}>\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"voice-input-button\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\" text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 transition rounded-full p-1.5 mr-0.5 self-center\"\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet stream = await navigator.mediaDevices\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.getUserMedia({ audio: true })\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.catch(function (err) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$i18n.t(`Permission denied when accessing microphone: {{error}}`, {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\terror: err\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (stream) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trecording = true;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst tracks = stream.getTracks();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttracks.forEach((track) => track.stop());\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstream = null;\r\n\t\t\t\t\t\t\t\t\t\t\t\t} catch {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error($i18n.t('Permission denied when accessing microphone'));\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\taria-label=\"Voice Input\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-5 h-5 translate-y-[0.5px]\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path d=\"M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t<div class=\" flex items-center\">\r\n\t\t\t\t\t\t\t\t\t<div class=\" flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Send message')}>\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"send-message-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{content !== '' || files.length !== 0\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 '\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled'} transition rounded-full p-1.5 self-center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={content === '' && files.length === 0}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n","<script lang=\"ts\">\r\n\timport { getContext } from 'svelte';\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\timport { showArchivedChats, showSidebar, user } from '$lib/stores';\r\n\r\n\timport { slide } from 'svelte/transition';\r\n\timport { page } from '$app/stores';\r\n\r\n\timport UserMenu from '$lib/components/layout/Sidebar/UserMenu.svelte';\r\n\timport MenuLines from '../icons/MenuLines.svelte';\r\n\timport PencilSquare from '../icons/PencilSquare.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let channel;\r\n</script>\r\n\r\n<nav class=\"sticky top-0 z-30 w-full px-1.5 py-1.5 -mb-8 flex items-center drag-region\">\r\n\t<div\r\n\t\tclass=\" bg-linear-to-b via-50% from-white via-white to-transparent dark:from-gray-900 dark:via-gray-900 dark:to-transparent pointer-events-none absolute inset-0 -bottom-7 z-[-1]\"\r\n\t></div>\r\n\r\n\t<div class=\" flex max-w-full w-full mx-auto px-1 pt-0.5 bg-transparent\">\r\n\t\t<div class=\"flex items-center w-full max-w-full\">\r\n\t\t\t<div\r\n\t\t\t\tclass=\"{$showSidebar\r\n\t\t\t\t\t? 'md:hidden'\r\n\t\t\t\t\t: ''} mr-1 self-start flex flex-none items-center text-gray-600 dark:text-gray-400\"\r\n\t\t\t>\r\n\t\t\t\t<button\r\n\t\t\t\t\tid=\"sidebar-toggle-button\"\r\n\t\t\t\t\tclass=\"cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tshowSidebar.set(!$showSidebar);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\taria-label=\"Toggle Sidebar\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div class=\" m-auto self-center\">\r\n\t\t\t\t\t\t<MenuLines />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclass=\"flex-1 overflow-hidden max-w-full py-0.5\r\n\t\t\t{$showSidebar ? 'ml-1' : ''}\r\n\t\t\t\"\r\n\t\t\t>\r\n\t\t\t\t{#if channel}\r\n\t\t\t\t\t<div class=\"line-clamp-1 capitalize font-medium font-primary text-lg\">\r\n\t\t\t\t\t\t{channel.name}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"self-start flex flex-none items-center text-gray-600 dark:text-gray-400\">\r\n\t\t\t\t{#if $user !== undefined}\r\n\t\t\t\t\t<UserMenu\r\n\t\t\t\t\t\tclassName=\"max-w-[200px]\"\r\n\t\t\t\t\t\trole={$user.role}\r\n\t\t\t\t\t\ton:show={(e) => {\r\n\t\t\t\t\t\t\tif (e.detail === 'archived-chat') {\r\n\t\t\t\t\t\t\t\tshowArchivedChats.set(true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass=\"select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\r\n\t\t\t\t\t\t\taria-label=\"User Menu\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div class=\" self-center\">\r\n\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\tsrc={$user.profile_image_url}\r\n\t\t\t\t\t\t\t\t\tclass=\"size-6 object-cover rounded-full\"\r\n\t\t\t\t\t\t\t\t\talt=\"User profile\"\r\n\t\t\t\t\t\t\t\t\tdraggable=\"false\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</UserMenu>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</nav>\r\n","<script lang=\"ts\">\r\n\timport { goto } from '$app/navigation';\r\n\r\n\timport { socket, user } from '$lib/stores';\r\n\r\n\timport { getChannelThreadMessages, sendMessage } from '$lib/apis/channels';\r\n\r\n\timport XMark from '$lib/components/icons/XMark.svelte';\r\n\timport MessageInput from './MessageInput.svelte';\r\n\timport Messages from './Messages.svelte';\r\n\timport { onDestroy, onMount, tick } from 'svelte';\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\texport let threadId = null;\r\n\texport let channel = null;\r\n\r\n\texport let onClose = () => {};\r\n\r\n\tlet messages = null;\r\n\tlet top = false;\r\n\r\n\tlet typingUsers = [];\r\n\tlet typingUsersTimeout = {};\r\n\r\n\tlet messagesContainerElement = null;\r\n\r\n\t$: if (threadId) {\r\n\t\tinitHandler();\r\n\t}\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tmessagesContainerElement.scrollTop = messagesContainerElement.scrollHeight;\r\n\t};\r\n\r\n\tconst initHandler = async () => {\r\n\t\tmessages = null;\r\n\t\ttop = false;\r\n\r\n\t\ttypingUsers = [];\r\n\t\ttypingUsersTimeout = {};\r\n\r\n\t\tif (channel) {\r\n\t\t\tmessages = await getChannelThreadMessages(localStorage.token, channel.id, threadId);\r\n\r\n\t\t\tif (messages.length < 50) {\r\n\t\t\t\ttop = true;\r\n\t\t\t}\r\n\r\n\t\t\tawait tick();\r\n\t\t\tscrollToBottom();\r\n\t\t} else {\r\n\t\t\tgoto('/');\r\n\t\t}\r\n\t};\r\n\r\n\tconst channelEventHandler = async (event) => {\r\n\t\tconsole.log(event);\r\n\t\tif (event.channel_id === channel.id) {\r\n\t\t\tconst type = event?.data?.type ?? null;\r\n\t\t\tconst data = event?.data?.data ?? null;\r\n\r\n\t\t\tif (type === 'message') {\r\n\t\t\t\tif ((data?.parent_id ?? null) === threadId) {\r\n\t\t\t\t\tif (messages) {\r\n\t\t\t\t\t\tmessages = [data, ...messages];\r\n\r\n\t\t\t\t\t\tif (typingUsers.find((user) => user.id === event.user.id)) {\r\n\t\t\t\t\t\t\ttypingUsers = typingUsers.filter((user) => user.id !== event.user.id);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'message:update') {\r\n\t\t\t\tif (messages) {\r\n\t\t\t\t\tconst idx = messages.findIndex((message) => message.id === data.id);\r\n\r\n\t\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\t\tmessages[idx] = data;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'message:delete') {\r\n\t\t\t\tif (messages) {\r\n\t\t\t\t\tmessages = messages.filter((message) => message.id !== data.id);\r\n\t\t\t\t}\r\n\t\t\t} else if (type.includes('message:reaction')) {\r\n\t\t\t\tif (messages) {\r\n\t\t\t\t\tconst idx = messages.findIndex((message) => message.id === data.id);\r\n\t\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\t\tmessages[idx] = data;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'typing' && event.message_id === threadId) {\r\n\t\t\t\tif (event.user.id === $user.id) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttypingUsers = data.typing\r\n\t\t\t\t\t? [\r\n\t\t\t\t\t\t\t...typingUsers,\r\n\t\t\t\t\t\t\t...(typingUsers.find((user) => user.id === event.user.id)\r\n\t\t\t\t\t\t\t\t? []\r\n\t\t\t\t\t\t\t\t: [\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tid: event.user.id,\r\n\t\t\t\t\t\t\t\t\t\t\tname: event.user.name\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t])\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t: typingUsers.filter((user) => user.id !== event.user.id);\r\n\r\n\t\t\t\tif (typingUsersTimeout[event.user.id]) {\r\n\t\t\t\t\tclearTimeout(typingUsersTimeout[event.user.id]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttypingUsersTimeout[event.user.id] = setTimeout(() => {\r\n\t\t\t\t\ttypingUsers = typingUsers.filter((user) => user.id !== event.user.id);\r\n\t\t\t\t}, 5000);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst submitHandler = async ({ content, data }) => {\r\n\t\tif (!content) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst res = await sendMessage(localStorage.token, channel.id, {\r\n\t\t\tparent_id: threadId,\r\n\t\t\tcontent: content,\r\n\t\t\tdata: data\r\n\t\t}).catch((error) => {\r\n\t\t\ttoast.error(`${error}`);\r\n\t\t\treturn null;\r\n\t\t});\r\n\t};\r\n\r\n\tconst onChange = async () => {\r\n\t\t$socket?.emit('channel-events', {\r\n\t\t\tchannel_id: channel.id,\r\n\t\t\tmessage_id: threadId,\r\n\t\t\tdata: {\r\n\t\t\t\ttype: 'typing',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\ttyping: true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tonMount(() => {\r\n\t\t$socket?.on('channel-events', channelEventHandler);\r\n\t});\r\n\r\n\tonDestroy(() => {\r\n\t\t$socket?.off('channel-events', channelEventHandler);\r\n\t});\r\n</script>\r\n\r\n{#if channel}\r\n\t<div class=\"flex flex-col w-full h-full bg-gray-50 dark:bg-gray-850\">\r\n\t\t<div class=\"flex items-center justify-between px-3.5 pt-3\">\r\n\t\t\t<div class=\" font-medium text-lg\">Thread</div>\r\n\r\n\t\t\t<div>\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 p-2\"\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tonClose();\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<XMark />\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\" max-h-full w-full overflow-y-auto pt-3\" bind:this={messagesContainerElement}>\r\n\t\t\t<Messages\r\n\t\t\t\tid={threadId}\r\n\t\t\t\t{channel}\r\n\t\t\t\t{messages}\r\n\t\t\t\t{top}\r\n\t\t\t\tthread={true}\r\n\t\t\t\tonLoad={async () => {\r\n\t\t\t\t\tconst newMessages = await getChannelThreadMessages(\r\n\t\t\t\t\t\tlocalStorage.token,\r\n\t\t\t\t\t\tchannel.id,\r\n\t\t\t\t\t\tthreadId,\r\n\t\t\t\t\t\tmessages.length\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tmessages = [...messages, ...newMessages];\r\n\r\n\t\t\t\t\tif (newMessages.length < 50) {\r\n\t\t\t\t\t\ttop = true;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\r\n\t\t\t<div class=\" pb-[1rem]\">\r\n\t\t\t\t<MessageInput id={threadId} {typingUsers} {onChange} onSubmit={submitHandler} />\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\timport { Pane, PaneGroup, PaneResizer } from 'paneforge';\r\n\r\n\timport { onDestroy, onMount, tick } from 'svelte';\r\n\timport { goto } from '$app/navigation';\r\n\r\n\timport { chatId, showSidebar, socket, user } from '$lib/stores';\r\n\timport { getChannelById, getChannelMessages, sendMessage } from '$lib/apis/channels';\r\n\r\n\timport Messages from './Messages.svelte';\r\n\timport MessageInput from './MessageInput.svelte';\r\n\timport Navbar from './Navbar.svelte';\r\n\timport Drawer from '../common/Drawer.svelte';\r\n\timport EllipsisVertical from '../icons/EllipsisVertical.svelte';\r\n\timport Thread from './Thread.svelte';\r\n\r\n\texport let id = '';\r\n\r\n\tlet scrollEnd = true;\r\n\tlet messagesContainerElement = null;\r\n\r\n\tlet top = false;\r\n\r\n\tlet channel = null;\r\n\tlet messages = null;\r\n\r\n\tlet threadId = null;\r\n\r\n\tlet typingUsers = [];\r\n\tlet typingUsersTimeout = {};\r\n\r\n\t$: if (id) {\r\n\t\tinitHandler();\r\n\t}\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tif (messagesContainerElement) {\r\n\t\t\tmessagesContainerElement.scrollTop = messagesContainerElement.scrollHeight;\r\n\t\t}\r\n\t};\r\n\r\n\tconst initHandler = async () => {\r\n\t\ttop = false;\r\n\t\tmessages = null;\r\n\t\tchannel = null;\r\n\t\tthreadId = null;\r\n\r\n\t\ttypingUsers = [];\r\n\t\ttypingUsersTimeout = {};\r\n\r\n\t\tchannel = await getChannelById(localStorage.token, id).catch((error) => {\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\t\tif (channel) {\r\n\t\t\tmessages = await getChannelMessages(localStorage.token, id, 0);\r\n\r\n\t\t\tif (messages) {\r\n\t\t\t\tscrollToBottom();\r\n\r\n\t\t\t\tif (messages.length < 50) {\r\n\t\t\t\t\ttop = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tgoto('/');\r\n\t\t}\r\n\t};\r\n\r\n\tconst channelEventHandler = async (event) => {\r\n\t\tif (event.channel_id === id) {\r\n\t\t\tconst type = event?.data?.type ?? null;\r\n\t\t\tconst data = event?.data?.data ?? null;\r\n\r\n\t\t\tif (type === 'message') {\r\n\t\t\t\tif ((data?.parent_id ?? null) === null) {\r\n\t\t\t\t\tmessages = [data, ...messages];\r\n\r\n\t\t\t\t\tif (typingUsers.find((user) => user.id === event.user.id)) {\r\n\t\t\t\t\t\ttypingUsers = typingUsers.filter((user) => user.id !== event.user.id);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tawait tick();\r\n\t\t\t\t\tif (scrollEnd) {\r\n\t\t\t\t\t\tscrollToBottom();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'message:update') {\r\n\t\t\t\tconst idx = messages.findIndex((message) => message.id === data.id);\r\n\r\n\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\tmessages[idx] = data;\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'message:delete') {\r\n\t\t\t\tmessages = messages.filter((message) => message.id !== data.id);\r\n\t\t\t} else if (type === 'message:reply') {\r\n\t\t\t\tconst idx = messages.findIndex((message) => message.id === data.id);\r\n\r\n\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\tmessages[idx] = data;\r\n\t\t\t\t}\r\n\t\t\t} else if (type.includes('message:reaction')) {\r\n\t\t\t\tconst idx = messages.findIndex((message) => message.id === data.id);\r\n\t\t\t\tif (idx !== -1) {\r\n\t\t\t\t\tmessages[idx] = data;\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'typing' && event.message_id === null) {\r\n\t\t\t\tif (event.user.id === $user.id) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttypingUsers = data.typing\r\n\t\t\t\t\t? [\r\n\t\t\t\t\t\t\t...typingUsers,\r\n\t\t\t\t\t\t\t...(typingUsers.find((user) => user.id === event.user.id)\r\n\t\t\t\t\t\t\t\t? []\r\n\t\t\t\t\t\t\t\t: [\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tid: event.user.id,\r\n\t\t\t\t\t\t\t\t\t\t\tname: event.user.name\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t])\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t: typingUsers.filter((user) => user.id !== event.user.id);\r\n\r\n\t\t\t\tif (typingUsersTimeout[event.user.id]) {\r\n\t\t\t\t\tclearTimeout(typingUsersTimeout[event.user.id]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttypingUsersTimeout[event.user.id] = setTimeout(() => {\r\n\t\t\t\t\ttypingUsers = typingUsers.filter((user) => user.id !== event.user.id);\r\n\t\t\t\t}, 5000);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst submitHandler = async ({ content, data }) => {\r\n\t\tif (!content && (data?.files ?? []).length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst res = await sendMessage(localStorage.token, id, { content: content, data: data }).catch(\r\n\t\t\t(error) => {\r\n\t\t\t\ttoast.error(`${error}`);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tif (res) {\r\n\t\t\tmessagesContainerElement.scrollTop = messagesContainerElement.scrollHeight;\r\n\t\t}\r\n\t};\r\n\r\n\tconst onChange = async () => {\r\n\t\t$socket?.emit('channel-events', {\r\n\t\t\tchannel_id: id,\r\n\t\t\tmessage_id: null,\r\n\t\t\tdata: {\r\n\t\t\t\ttype: 'typing',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\ttyping: true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tlet mediaQuery;\r\n\tlet largeScreen = false;\r\n\r\n\tonMount(() => {\r\n\t\tif ($chatId) {\r\n\t\t\tchatId.set('');\r\n\t\t}\r\n\r\n\t\t$socket?.on('channel-events', channelEventHandler);\r\n\r\n\t\tmediaQuery = window.matchMedia('(min-width: 1024px)');\r\n\r\n\t\tconst handleMediaQuery = async (e) => {\r\n\t\t\tif (e.matches) {\r\n\t\t\t\tlargeScreen = true;\r\n\t\t\t} else {\r\n\t\t\t\tlargeScreen = false;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tmediaQuery.addEventListener('change', handleMediaQuery);\r\n\t\thandleMediaQuery(mediaQuery);\r\n\t});\r\n\r\n\tonDestroy(() => {\r\n\t\t$socket?.off('channel-events', channelEventHandler);\r\n\t});\r\n</script>\r\n\r\n<svelte:head>\r\n\t<title>#{channel?.name ?? 'Channel'} | Open WebUI</title>\r\n</svelte:head>\r\n\r\n<div\r\n\tclass=\"h-screen max-h-[100dvh] transition-width duration-200 ease-in-out {$showSidebar\r\n\t\t? 'md:max-w-[calc(100%-260px)]'\r\n\t\t: ''} w-full max-w-full flex flex-col\"\r\n\tid=\"channel-container\"\r\n>\r\n\t<PaneGroup direction=\"horizontal\" class=\"w-full h-full\">\r\n\t\t<Pane defaultSize={50} minSize={50} class=\"h-full flex flex-col w-full relative\">\r\n\t\t\t<Navbar {channel} />\r\n\r\n\t\t\t<div class=\"flex-1 overflow-y-auto\">\r\n\t\t\t\t{#if channel}\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\" pb-2.5 max-w-full z-10 scrollbar-hidden w-full h-full pt-6 flex-1 flex flex-col-reverse overflow-auto\"\r\n\t\t\t\t\t\tid=\"messages-container\"\r\n\t\t\t\t\t\tbind:this={messagesContainerElement}\r\n\t\t\t\t\t\ton:scroll={(e) => {\r\n\t\t\t\t\t\t\tscrollEnd = Math.abs(messagesContainerElement.scrollTop) <= 50;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#key id}\r\n\t\t\t\t\t\t\t<Messages\r\n\t\t\t\t\t\t\t\t{channel}\r\n\t\t\t\t\t\t\t\t{messages}\r\n\t\t\t\t\t\t\t\t{top}\r\n\t\t\t\t\t\t\t\tonThread={(id) => {\r\n\t\t\t\t\t\t\t\t\tthreadId = id;\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonLoad={async () => {\r\n\t\t\t\t\t\t\t\t\tconst newMessages = await getChannelMessages(\r\n\t\t\t\t\t\t\t\t\t\tlocalStorage.token,\r\n\t\t\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\t\t\tmessages.length\r\n\t\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t\t\tmessages = [...messages, ...newMessages];\r\n\r\n\t\t\t\t\t\t\t\t\tif (newMessages.length < 50) {\r\n\t\t\t\t\t\t\t\t\t\ttop = true;\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{/key}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\" pb-[1rem]\">\r\n\t\t\t\t<MessageInput\r\n\t\t\t\t\tid=\"root\"\r\n\t\t\t\t\t{typingUsers}\r\n\t\t\t\t\t{onChange}\r\n\t\t\t\t\tonSubmit={submitHandler}\r\n\t\t\t\t\t{scrollToBottom}\r\n\t\t\t\t\t{scrollEnd}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</Pane>\r\n\r\n\t\t{#if !largeScreen}\r\n\t\t\t{#if threadId !== null}\r\n\t\t\t\t<Drawer\r\n\t\t\t\t\tshow={threadId !== null}\r\n\t\t\t\t\ton:close={() => {\r\n\t\t\t\t\t\tthreadId = null;\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div class=\" {threadId !== null ? ' h-screen  w-full' : 'px-6 py-4'} h-full\">\r\n\t\t\t\t\t\t<Thread\r\n\t\t\t\t\t\t\t{threadId}\r\n\t\t\t\t\t\t\t{channel}\r\n\t\t\t\t\t\t\tonClose={() => {\r\n\t\t\t\t\t\t\t\tthreadId = null;\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Drawer>\r\n\t\t\t{/if}\r\n\t\t{:else if threadId !== null}\r\n\t\t\t<PaneResizer\r\n\t\t\t\tclass=\"relative flex w-[3px] items-center justify-center bg-background group bg-gray-50 dark:bg-gray-850\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"z-10 flex h-7 w-5 items-center justify-center rounded-xs\">\r\n\t\t\t\t\t<EllipsisVertical className=\"size-4 invisible group-hover:visible\" />\r\n\t\t\t\t</div>\r\n\t\t\t</PaneResizer>\r\n\r\n\t\t\t<Pane defaultSize={50} minSize={30} class=\"h-full w-full\">\r\n\t\t\t\t<div class=\"h-full w-full shadow-xl\">\r\n\t\t\t\t\t<Thread\r\n\t\t\t\t\t\t{threadId}\r\n\t\t\t\t\t\t{channel}\r\n\t\t\t\t\t\tonClose={() => {\r\n\t\t\t\t\t\t\tthreadId = null;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</Pane>\r\n\t\t{/if}\r\n\t</PaneGroup>\r\n</div>\r\n","<script lang=\"ts\">\r\n\timport { page } from '$app/stores';\r\n\r\n\timport Channel from '$lib/components/channel/Channel.svelte';\r\n</script>\r\n\r\n<Channel id={$page.params.id} />\r\n"],"names":["t1_value","ctx","show_if","_a","WEBUI_BASE_URL","attr","img","img_src_value","insert_hydration","target","div4","anchor","append_hydration","div0","div3","div1","span","div2","dirty","set_data","t1","create_if_block","flyAndScale","side","$$props","align","user","show","dispatch","createEventDispatcher","state","value","svg","path","className","strokeWidth","get_default_slot_context","svelte_virtual_list_row","get_key","i","svelte_virtual_list_viewport","svelte_virtual_list_contents","items","height","itemHeight","start","end","height_map","rows","viewport","contents","viewport_height","visible","mounted","top","bottom","average_height","refresh","scrollTop","tick","content_height","row","row_height","$$invalidate","remaining","handle_scroll","old_start","v","y","expected_height","actual_height","d","onMount","$$value","data","ROW_HEIGHT","div","each_blocks","t","t_value","img_alt_value","button","func","tooltip_changes","input","code","onClose","onSubmit","name","emojis","emojiShortCodes","search","flattenedEmojis","emojiRows","selectEmoji","emoji","selectedCode","click_handler","emojiItem","acc","key","filtered","emojiGroups","group","groupEmojis","currentRow","item","create_if_block_13","create_if_block_9","if_block3","_b","create_if_block_7","div0_class_value","div2_class_value","div2_id_value","div2_dir_value","current","_c","_d","create_if_block_15","create_if_block_14","if_block","create_if_block_12","profilepreview_changes","dayjs","formatDate","create_if_block_10","t0","t0_value","fileitem_changes","image_changes","if_block0","create_if_block_6","if_block1","create_if_block_3","if_block2","create_if_block_2","markdown_changes","button0","button1","t3","t3_value","each_value","ensure_array_like","src_url_equal","create_if_block_5","create_if_block_4","button_class_value","span0","span1","span2","t2","t2_value","t4","t4_value","relativeTime","isToday","isYesterday","localizedFormat","i18n","getContext","message","showUserProfile","thread","onDelete","onEdit","onThread","onReaction","showButtons","edit","editedContent","showDeleteConfirmDialog","func_1","click_handler_3","e","isCmdOrCtrlPressed","isEnterPressed","reaction","child_ctx","t5_value","t5","hr","message_1_changes","get_if_ctx","id","channel","messages","onLoad","messagesLoading","loadMoreMessages","element","m","deleteMessage","error","toast","content","updateMessage","$user","r","removeReaction","addReaction","screenCaptureHandler","uploadFilesHandler","init","create_if_block_1","form","div7","div6","div5","richtextinput_changes","button_disabled_value","placeholder","$i18n","transparentBackground","draggedOver","recording","files","filesInputElement","inputFiles","typingUsers","onChange","scrollEnd","scrollToBottom","mediaStream","video","canvas","track","imageUrl","inputFilesHandler","file","$config","reader","event","$settings","width","compressImage","uploadFileHandler","tempItemId","uuidv4","fileItem","res","transcribeAudio","blob","blobToFile","uploadedFile","uploadFile","WEBUI_API_BASE_URL","handleKeyDown","onDragOver","onDragLeave","onDrop","submitHandler","chatInputElement","chatInput","dropzoneElement","onDestroy","text","filename","fileIdx","$mobile","stream","err","usermenu_changes","nav","showSidebar","$showSidebar","showArchivedChats","threadId","typingUsersTimeout","messagesContainerElement","initHandler","getChannelThreadMessages","goto","channelEventHandler","type","idx","sendMessage","$socket","newMessages","drawer_changes","div_class_value","getChannelById","getChannelMessages","mediaQuery","largeScreen","$chatId","chatId","handleMediaQuery"],"mappings":"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","x_google_ignoreList":[3]}