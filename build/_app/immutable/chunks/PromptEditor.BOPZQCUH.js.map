{"version":3,"file":"PromptEditor.BOPZQCUH.js","sources":["../../../../../../src/lib/components/workspace/Prompts/PromptEditor.svelte"],"sourcesContent":["<script lang=\"ts\">\r\n\timport { onMount, tick, getContext } from 'svelte';\r\n\r\n\timport Textarea from '$lib/components/common/Textarea.svelte';\r\n\timport { toast } from 'svelte-sonner';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport AccessControl from '../common/AccessControl.svelte';\r\n\timport LockClosed from '$lib/components/icons/LockClosed.svelte';\r\n\timport AccessControlModal from '../common/AccessControlModal.svelte';\r\n\r\n\texport let onSubmit: Function;\r\n\texport let edit = false;\r\n\texport let prompt = null;\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\tlet loading = false;\r\n\r\n\tlet title = '';\r\n\tlet command = '';\r\n\tlet content = '';\r\n\r\n\tlet accessControl = null;\r\n\r\n\tlet showAccessControlModal = false;\r\n\r\n\t$: if (!edit) {\r\n\t\tcommand = title !== '' ? `${title.replace(/\\s+/g, '-').toLowerCase()}` : '';\r\n\t}\r\n\r\n\tconst submitHandler = async () => {\r\n\t\tloading = true;\r\n\r\n\t\tif (validateCommandString(command)) {\r\n\t\t\tawait onSubmit({\r\n\t\t\t\ttitle,\r\n\t\t\t\tcommand,\r\n\t\t\t\tcontent,\r\n\t\t\t\taccess_control: accessControl\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\ttoast.error(\r\n\t\t\t\t$i18n.t('Only alphanumeric characters and hyphens are allowed in the command string.')\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tloading = false;\r\n\t};\r\n\r\n\tconst validateCommandString = (inputString) => {\r\n\t\t// Regular expression to match only alphanumeric characters and hyphen\r\n\t\tconst regex = /^[a-zA-Z0-9-]+$/;\r\n\r\n\t\t// Test the input string against the regular expression\r\n\t\treturn regex.test(inputString);\r\n\t};\r\n\r\n\tonMount(async () => {\r\n\t\tif (prompt) {\r\n\t\t\ttitle = prompt.title;\r\n\t\t\tawait tick();\r\n\r\n\t\t\tcommand = prompt.command.at(0) === '/' ? prompt.command.slice(1) : prompt.command;\r\n\t\t\tcontent = prompt.content;\r\n\r\n\t\t\taccessControl = prompt?.access_control ?? null;\r\n\t\t}\r\n\t});\r\n</script>\r\n\r\n<AccessControlModal\r\n\tbind:show={showAccessControlModal}\r\n\tbind:accessControl\r\n\taccessRoles={['read', 'write']}\r\n/>\r\n\r\n<div class=\"w-full max-h-full flex justify-center\">\r\n\t<form\r\n\t\tclass=\"flex flex-col w-full mb-10\"\r\n\t\ton:submit|preventDefault={() => {\r\n\t\t\tsubmitHandler();\r\n\t\t}}\r\n\t>\r\n\t\t<div class=\"my-2\">\r\n\t\t\t<Tooltip\r\n\t\t\t\tcontent={`${$i18n.t('Only alphanumeric characters and hyphens are allowed')} - ${$i18n.t(\r\n\t\t\t\t\t'Activate this command by typing \"/{{COMMAND}}\" to chat input.',\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tCOMMAND: command\r\n\t\t\t\t\t}\r\n\t\t\t\t)}`}\r\n\t\t\t\tplacement=\"bottom-start\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"flex flex-col w-full\">\r\n\t\t\t\t\t<div class=\"flex items-center\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tclass=\"text-2xl font-semibold w-full bg-transparent outline-hidden\"\r\n\t\t\t\t\t\t\tplaceholder={$i18n.t('Title')}\r\n\t\t\t\t\t\t\tbind:value={title}\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<div class=\"self-center shrink-0\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclass=\"bg-gray-50 hover:bg-gray-100 text-black dark:bg-gray-850 dark:hover:bg-gray-800 dark:text-white transition px-2 py-1 rounded-full flex gap-1 items-center\"\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\tshowAccessControlModal = true;\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<LockClosed strokeWidth=\"2.5\" className=\"size-3.5\" />\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"text-sm font-medium shrink-0\">\r\n\t\t\t\t\t\t\t\t\t{$i18n.t('Access')}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"flex gap-0.5 items-center text-xs text-gray-500\">\r\n\t\t\t\t\t\t<div class=\"\">/</div>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tclass=\" w-full bg-transparent outline-hidden\"\r\n\t\t\t\t\t\t\tplaceholder={$i18n.t('Command')}\r\n\t\t\t\t\t\t\tbind:value={command}\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\tdisabled={edit}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</Tooltip>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"my-2\">\r\n\t\t\t<div class=\"flex w-full justify-between\">\r\n\t\t\t\t<div class=\" self-center text-sm font-semibold\">{$i18n.t('Prompt Content')}</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"mt-2\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Textarea\r\n\t\t\t\t\t\tclassName=\"text-sm w-full bg-transparent outline-hidden overflow-y-hidden resize-none\"\r\n\t\t\t\t\t\tplaceholder={$i18n.t('Write a summary in 50 words that summarizes [topic or keyword].')}\r\n\t\t\t\t\t\tbind:value={content}\r\n\t\t\t\t\t\trows={6}\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"text-xs text-gray-400 dark:text-gray-500\">\r\n\t\t\t\t\tâ“˜ {$i18n.t('Format your variables using brackets like this:')}&nbsp;<span\r\n\t\t\t\t\t\tclass=\" text-gray-600 dark:text-gray-300 font-medium\"\r\n\t\t\t\t\t\t>{'{{'}{$i18n.t('variable')}{'}}'}</span\r\n\t\t\t\t\t>.\r\n\t\t\t\t\t{$i18n.t('Make sure to enclose them with')}\r\n\t\t\t\t\t<span class=\" text-gray-600 dark:text-gray-300 font-medium\">{'{{'}</span>\r\n\t\t\t\t\t{$i18n.t('and')}\r\n\t\t\t\t\t<span class=\" text-gray-600 dark:text-gray-300 font-medium\">{'}}'}</span>.\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"text-xs text-gray-400 dark:text-gray-500\">\r\n\t\t\t\t\t{$i18n.t('Utilize')}<span class=\" text-gray-600 dark:text-gray-300 font-medium\">\r\n\t\t\t\t\t\t{` {{CLIPBOARD}}`}</span\r\n\t\t\t\t\t>\r\n\t\t\t\t\t{$i18n.t('variable to have them replaced with clipboard content.')}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"my-4 flex justify-end pb-20\">\r\n\t\t\t<button\r\n\t\t\t\tclass=\" text-sm w-full lg:w-fit px-4 py-2 transition rounded-lg {loading\r\n\t\t\t\t\t? ' cursor-not-allowed bg-black hover:bg-gray-900 text-white dark:bg-white dark:hover:bg-gray-100 dark:text-black'\r\n\t\t\t\t\t: 'bg-black hover:bg-gray-900 text-white dark:bg-white dark:hover:bg-gray-100 dark:text-black'} flex w-full justify-center\"\r\n\t\t\t\ttype=\"submit\"\r\n\t\t\t\tdisabled={loading}\r\n\t\t\t>\r\n\t\t\t\t<div class=\" self-center font-medium\">{$i18n.t('Save & Create')}</div>\r\n\r\n\t\t\t\t{#if loading}\r\n\t\t\t\t\t<div class=\"ml-1.5 self-center\">\r\n\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\tclass=\" w-4 h-4\"\r\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t><style>\r\n\t\t\t\t\t\t\t\t.spinner_ajPY {\r\n\t\t\t\t\t\t\t\t\ttransform-origin: center;\r\n\t\t\t\t\t\t\t\t\tanimation: spinner_AtaB 0.75s infinite linear;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t@keyframes spinner_AtaB {\r\n\t\t\t\t\t\t\t\t\t100% {\r\n\t\t\t\t\t\t\t\t\t\ttransform: rotate(360deg);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</style><path\r\n\t\t\t\t\t\t\t\td=\"M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z\"\r\n\t\t\t\t\t\t\t\topacity=\".25\"\r\n\t\t\t\t\t\t\t/><path\r\n\t\t\t\t\t\t\t\td=\"M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z\"\r\n\t\t\t\t\t\t\t\tclass=\"spinner_ajPY\"\r\n\t\t\t\t\t\t\t/></svg\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t</form>\r\n</div>\r\n"],"names":["ctx","insert_hydration","target","div5","anchor","append_hydration","div2","input0","div1","button","div0","div4","div3","input1","set_data","t2","t2_value","div","accesscontrolmodal_props","create_if_block","div10","form","div7","div6","span0","span1","span2","span3","div9","div8","dirty","tooltip_changes","t6","t6_value","t9","t9_value","t12","t12_value","t16","t16_value","t21","t21_value","t24","t24_value","t26","t26_value","onSubmit","$$props","edit","prompt","i18n","getContext","loading","title","command","content","accessControl","showAccessControlModal","submitHandler","validateCommandString","toast","$i18n","inputString","onMount","$$invalidate","tick","value"],"mappings":"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"}