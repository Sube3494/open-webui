{"version":3,"file":"Messages.CHEA0xf8.js","sources":["../../../../../../src/lib/workers/KokoroWorker.ts","../../../../../../src/lib/components/chat/Messages/Skeleton.svelte","../../../../../../src/lib/components/chat/Messages/RateComment.svelte","../../../../../../src/lib/components/chat/Messages/ResponseMessage/WebSearchResults.svelte","../../../../../../src/lib/components/icons/Sparkles.svelte","../../../../../../src/lib/components/chat/Messages/Error.svelte","../../../../../../src/lib/components/chat/Messages/CitationsModal.svelte","../../../../../../src/lib/components/chat/Messages/Citations.svelte","../../../../../../src/lib/components/chat/Messages/CodeExecutionModal.svelte","../../../../../../src/lib/components/chat/Messages/CodeExecutions.svelte","../../../../../../src/lib/components/icons/ChatBubble.svelte","../../../../../../src/lib/components/icons/LightBlub.svelte","../../../../../../src/lib/components/chat/ContentRenderer/FloatingButtons.svelte","../../../../../../src/lib/components/chat/Messages/ContentRenderer.svelte","../../../../../../src/lib/components/chat/Messages/ResponseMessage.svelte","../../../../../../src/lib/components/icons/Merge.svelte","../../../../../../src/lib/components/chat/Messages/MultiResponseMessages.svelte","../../../../../../src/lib/components/chat/Messages/UserMessage.svelte","../../../../../../src/lib/components/chat/Messages/Message.svelte","../../../../../../src/lib/components/icons/Bolt.svelte","../../../../../../src/lib/components/chat/Suggestions.svelte","../../../../../../src/lib/components/icons/EyeSlash.svelte","../../../../../../src/lib/components/chat/ChatPlaceholder.svelte","../../../../../../src/lib/components/chat/Messages.svelte"],"sourcesContent":["import WorkerInstance from '$lib/workers/kokoro.worker?worker';\r\n\r\nexport class KokoroWorker {\r\n\tprivate worker: Worker | null = null;\r\n\tprivate initialized: boolean = false;\r\n\tprivate dtype: string;\r\n\tprivate requestQueue: Array<{\r\n\t\ttext: string;\r\n\t\tvoice: string;\r\n\t\tresolve: (value: string) => void;\r\n\t\treject: (reason: any) => void;\r\n\t}> = [];\r\n\tprivate processing = false; // To track if a request is being processed\r\n\r\n\tconstructor(dtype: string = 'fp32') {\r\n\t\tthis.dtype = dtype;\r\n\t}\r\n\r\n\tpublic async init() {\r\n\t\tif (this.worker) {\r\n\t\t\tconsole.warn('KokoroWorker is already initialized.');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.worker = new WorkerInstance();\r\n\r\n\t\t// Handle worker messages\r\n\t\tthis.worker.onmessage = (event) => {\r\n\t\t\tconst { status, error, audioUrl } = event.data;\r\n\r\n\t\t\tif (status === 'init:complete') {\r\n\t\t\t\tthis.initialized = true;\r\n\t\t\t} else if (status === 'init:error') {\r\n\t\t\t\tconsole.error(error);\r\n\t\t\t\tthis.initialized = false;\r\n\t\t\t} else if (status === 'generate:complete') {\r\n\t\t\t\t// Resolve promise from queue\r\n\t\t\t\tconst request = this.requestQueue.shift();\r\n\t\t\t\tif (request) {\r\n\t\t\t\t\trequest.resolve(audioUrl);\r\n\t\t\t\t\tthis.processNextRequest(); // Process next request in queue\r\n\t\t\t\t}\r\n\t\t\t} else if (status === 'generate:error') {\r\n\t\t\t\tconst request = this.requestQueue.shift();\r\n\t\t\t\tif (request) {\r\n\t\t\t\t\trequest.reject(new Error(error));\r\n\t\t\t\t\tthis.processNextRequest(); // Continue processing next in queue\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn new Promise<void>((resolve, reject) => {\r\n\t\t\tthis.worker!.postMessage({\r\n\t\t\t\ttype: 'init',\r\n\t\t\t\tpayload: { dtype: this.dtype }\r\n\t\t\t});\r\n\r\n\t\t\tconst handleMessage = (event: MessageEvent) => {\r\n\t\t\t\tif (event.data.status === 'init:complete') {\r\n\t\t\t\t\tthis.worker!.removeEventListener('message', handleMessage);\r\n\t\t\t\t\tthis.initialized = true;\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t} else if (event.data.status === 'init:error') {\r\n\t\t\t\t\tthis.worker!.removeEventListener('message', handleMessage);\r\n\t\t\t\t\treject(new Error(event.data.error));\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tthis.worker!.addEventListener('message', handleMessage);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic async generate({ text, voice }: { text: string; voice: string }): Promise<string> {\r\n\t\tif (!this.initialized || !this.worker) {\r\n\t\t\tthrow new Error('KokoroTTS Worker is not initialized yet.');\r\n\t\t}\r\n\r\n\t\treturn new Promise<string>((resolve, reject) => {\r\n\t\t\tthis.requestQueue.push({ text, voice, resolve, reject });\r\n\t\t\tif (!this.processing) {\r\n\t\t\t\tthis.processNextRequest();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate processNextRequest() {\r\n\t\tif (this.requestQueue.length === 0) {\r\n\t\t\tthis.processing = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.processing = true;\r\n\t\tconst { text, voice } = this.requestQueue[0]; // Get first request but don't remove yet\r\n\t\tthis.worker!.postMessage({ type: 'generate', payload: { text, voice } });\r\n\t}\r\n\r\n\tpublic terminate() {\r\n\t\tif (this.worker) {\r\n\t\t\tthis.worker.terminate();\r\n\t\t\tthis.worker = null;\r\n\t\t\tthis.initialized = false;\r\n\t\t\tthis.requestQueue = [];\r\n\t\t\tthis.processing = false;\r\n\t\t}\r\n\t}\r\n}\r\n","<script lang=\"ts\">\r\n\texport let size = 'md';\r\n</script>\r\n\r\n<div class=\"w-full mt-2 mb-2\">\r\n\t<div class=\"animate-pulse flex w-full\">\r\n\t\t<div class=\"{size === 'md' ? 'space-y-2' : 'space-y-1.5'} w-full\">\r\n\t\t\t<div\r\n\t\t\t\tclass=\"{size === 'md' ? 'h-2' : 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm mr-14\"\r\n\t\t\t/>\r\n\r\n\t\t\t<div class=\"grid grid-cols-3 gap-4\">\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"{size === 'md'\r\n\t\t\t\t\t\t? 'h-2'\r\n\t\t\t\t\t\t: 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2\"\r\n\t\t\t\t/>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"{size === 'md'\r\n\t\t\t\t\t\t? 'h-2'\r\n\t\t\t\t\t\t: 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1\"\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"grid grid-cols-4 gap-4\">\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"{size === 'md'\r\n\t\t\t\t\t\t? 'h-2'\r\n\t\t\t\t\t\t: 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1\"\r\n\t\t\t\t/>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"{size === 'md'\r\n\t\t\t\t\t\t? 'h-2'\r\n\t\t\t\t\t\t: 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2\"\r\n\t\t\t\t/>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"{size === 'md'\r\n\t\t\t\t\t\t? 'h-2'\r\n\t\t\t\t\t\t: 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4\"\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"{size === 'md' ? 'h-2' : 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm\" />\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\timport { createEventDispatcher, onMount, getContext } from 'svelte';\r\n\timport { config, models } from '$lib/stores';\r\n\timport Tags from '$lib/components/common/Tags.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\texport let message;\r\n\texport let show = false;\r\n\r\n\tlet LIKE_REASONS = [\r\n\t\t'accurate_information',\r\n\t\t'followed_instructions_perfectly',\r\n\t\t'showcased_creativity',\r\n\t\t'positive_attitude',\r\n\t\t'attention_to_detail',\r\n\t\t'thorough_explanation',\r\n\t\t'other'\r\n\t];\r\n\tlet DISLIKE_REASONS = [\r\n\t\t'dont_like_the_style',\r\n\t\t'too_verbose',\r\n\t\t'not_helpful',\r\n\t\t'not_factually_correct',\r\n\t\t'didnt_fully_follow_instructions',\r\n\t\t'refused_when_it_shouldnt_have',\r\n\t\t'being_lazy',\r\n\t\t'other'\r\n\t];\r\n\r\n\tlet tags = [];\r\n\r\n\tlet reasons = [];\r\n\tlet selectedReason = null;\r\n\tlet comment = '';\r\n\r\n\tlet detailedRating = null;\r\n\tlet selectedModel = null;\r\n\r\n\t$: if (message?.annotation?.rating === 1) {\r\n\t\treasons = LIKE_REASONS;\r\n\t} else if (message?.annotation?.rating === -1) {\r\n\t\treasons = DISLIKE_REASONS;\r\n\t}\r\n\r\n\t$: if (message) {\r\n\t\tinit();\r\n\t}\r\n\r\n\tconst init = () => {\r\n\t\tif (!selectedReason) {\r\n\t\t\tselectedReason = message?.annotation?.reason ?? '';\r\n\t\t}\r\n\r\n\t\tif (!comment) {\r\n\t\t\tcomment = message?.annotation?.comment ?? '';\r\n\t\t}\r\n\r\n\t\ttags = (message?.annotation?.tags ?? []).map((tag) => ({\r\n\t\t\tname: tag\r\n\t\t}));\r\n\r\n\t\tif (!detailedRating) {\r\n\t\t\tdetailedRating = message?.annotation?.details?.rating ?? null;\r\n\t\t}\r\n\t};\r\n\r\n\tonMount(() => {\r\n\t\tif (message?.arena) {\r\n\t\t\tselectedModel = $models.find((m) => m.id === message.selectedModelId);\r\n\t\t\ttoast.success(\r\n\t\t\t\t$i18n.t('This response was generated by \"{{model}}\"', {\r\n\t\t\t\t\tmodel: selectedModel ? (selectedModel?.name ?? selectedModel.id) : message.selectedModelId\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\t});\r\n\r\n\tconst saveHandler = () => {\r\n\t\tconsole.log('saveHandler');\r\n\t\t// if (!selectedReason) {\r\n\t\t// \ttoast.error($i18n.t('Please select a reason'));\r\n\t\t// \treturn;\r\n\t\t// }\r\n\r\n\t\tdispatch('save', {\r\n\t\t\treason: selectedReason,\r\n\t\t\tcomment: comment,\r\n\t\t\ttags: tags.map((tag) => tag.name),\r\n\t\t\tdetails: {\r\n\t\t\t\trating: detailedRating\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\ttoast.success($i18n.t('Thanks for your feedback!'));\r\n\t\tshow = false;\r\n\t};\r\n</script>\r\n\r\n{#if message?.arena}\r\n\t<div class=\"text-xs font-medium pt-1.5 -mb-0.5\">\r\n\t\t{$i18n.t('This response was generated by \"{{model}}\"', {\r\n\t\t\tmodel: selectedModel ? (selectedModel?.name ?? selectedModel.id) : message.selectedModelId\r\n\t\t})}\r\n\t</div>\r\n{/if}\r\n\r\n<div\r\n\tclass=\" my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850\"\r\n\tid=\"message-feedback-{message.id}\"\r\n>\r\n\t<div class=\"flex justify-between items-center\">\r\n\t\t<div class=\"text-sm font-medium\">{$i18n.t('How would you rate this response?')}</div>\r\n\r\n\t\t<!-- <div class=\" text-sm\">{$i18n.t('Tell us more:')}</div> -->\r\n\r\n\t\t<button\r\n\t\t\ton:click={() => {\r\n\t\t\t\tshow = false;\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<svg\r\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\tfill=\"none\"\r\n\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\tstroke-width=\"1.5\"\r\n\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\tclass=\"size-4\"\r\n\t\t\t>\r\n\t\t\t\t<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6 18 18 6M6 6l12 12\" />\r\n\t\t\t</svg>\r\n\t\t</button>\r\n\t</div>\r\n\r\n\t<div class=\"w-full flex justify-center\">\r\n\t\t<div class=\" relative w-fit\">\r\n\t\t\t<div class=\"mt-1.5 w-fit flex gap-1 pb-5\">\r\n\t\t\t\t<!-- 1-10 scale -->\r\n\t\t\t\t{#each Array.from({ length: 10 }).map((_, i) => i + 1) as rating}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclass=\"size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 {detailedRating ===\r\n\t\t\t\t\t\trating\r\n\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-800'\r\n\t\t\t\t\t\t\t: ''} transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tdetailedRating = rating;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tdisabled={message?.annotation?.rating === -1 ? rating > 5 : rating < 6}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{rating}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/each}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"absolute bottom-0 left-0 right-0 flex justify-between text-xs\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t1 - {$i18n.t('Awful')}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div>\r\n\t\t\t\t\t10 - {$i18n.t('Amazing')}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div>\r\n\t\t{#if reasons.length > 0}\r\n\t\t\t<div class=\"text-sm mt-1.5 font-medium\">{$i18n.t('Why?')}</div>\r\n\r\n\t\t\t<div class=\"flex flex-wrap gap-1.5 text-sm mt-1.5\">\r\n\t\t\t\t{#each reasons as reason}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclass=\"px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 {selectedReason ===\r\n\t\t\t\t\t\treason\r\n\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-800'\r\n\t\t\t\t\t\t\t: ''} transition rounded-xl\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tselectedReason = reason;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#if reason === 'accurate_information'}\r\n\t\t\t\t\t\t\t{$i18n.t('Accurate information')}\r\n\t\t\t\t\t\t{:else if reason === 'followed_instructions_perfectly'}\r\n\t\t\t\t\t\t\t{$i18n.t('Followed instructions perfectly')}\r\n\t\t\t\t\t\t{:else if reason === 'showcased_creativity'}\r\n\t\t\t\t\t\t\t{$i18n.t('Showcased creativity')}\r\n\t\t\t\t\t\t{:else if reason === 'positive_attitude'}\r\n\t\t\t\t\t\t\t{$i18n.t('Positive attitude')}\r\n\t\t\t\t\t\t{:else if reason === 'attention_to_detail'}\r\n\t\t\t\t\t\t\t{$i18n.t('Attention to detail')}\r\n\t\t\t\t\t\t{:else if reason === 'thorough_explanation'}\r\n\t\t\t\t\t\t\t{$i18n.t('Thorough explanation')}\r\n\t\t\t\t\t\t{:else if reason === 'dont_like_the_style'}\r\n\t\t\t\t\t\t\t{$i18n.t(\"Don't like the style\")}\r\n\t\t\t\t\t\t{:else if reason === 'too_verbose'}\r\n\t\t\t\t\t\t\t{$i18n.t('Too verbose')}\r\n\t\t\t\t\t\t{:else if reason === 'not_helpful'}\r\n\t\t\t\t\t\t\t{$i18n.t('Not helpful')}\r\n\t\t\t\t\t\t{:else if reason === 'not_factually_correct'}\r\n\t\t\t\t\t\t\t{$i18n.t('Not factually correct')}\r\n\t\t\t\t\t\t{:else if reason === 'didnt_fully_follow_instructions'}\r\n\t\t\t\t\t\t\t{$i18n.t(\"Didn't fully follow instructions\")}\r\n\t\t\t\t\t\t{:else if reason === 'refused_when_it_shouldnt_have'}\r\n\t\t\t\t\t\t\t{$i18n.t(\"Refused when it shouldn't have\")}\r\n\t\t\t\t\t\t{:else if reason === 'being_lazy'}\r\n\t\t\t\t\t\t\t{$i18n.t('Being lazy')}\r\n\t\t\t\t\t\t{:else if reason === 'other'}\r\n\t\t\t\t\t\t\t{$i18n.t('Other')}\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t{reason}\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/each}\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\t</div>\r\n\r\n\t<div class=\"mt-2\">\r\n\t\t<textarea\r\n\t\t\tbind:value={comment}\r\n\t\t\tclass=\"w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl\"\r\n\t\t\tplaceholder={$i18n.t('Feel free to add specific details')}\r\n\t\t\trows=\"3\"\r\n\t\t/>\r\n\t</div>\r\n\r\n\t<div class=\"mt-2 gap-1.5 flex justify-between\">\r\n\t\t<div class=\"flex items-end group\">\r\n\t\t\t<Tags\r\n\t\t\t\t{tags}\r\n\t\t\t\ton:delete={(e) => {\r\n\t\t\t\t\ttags = tags.filter(\r\n\t\t\t\t\t\t(tag) =>\r\n\t\t\t\t\t\t\ttag.name.replaceAll(' ', '_').toLowerCase() !==\r\n\t\t\t\t\t\t\te.detail.replaceAll(' ', '_').toLowerCase()\r\n\t\t\t\t\t);\r\n\t\t\t\t}}\r\n\t\t\t\ton:add={(e) => {\r\n\t\t\t\t\ttags = [...tags, { name: e.detail }];\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</div>\r\n\r\n\t\t<button\r\n\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\r\n\t\t\ton:click={() => {\r\n\t\t\t\tsaveHandler();\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t{$i18n.t('Save')}\r\n\t\t</button>\r\n\t</div>\r\n</div>\r\n","<script lang=\"ts\">\r\n\timport ChevronDown from '$lib/components/icons/ChevronDown.svelte';\r\n\timport ChevronUp from '$lib/components/icons/ChevronUp.svelte';\r\n\timport MagnifyingGlass from '$lib/components/icons/MagnifyingGlass.svelte';\r\n\timport Collapsible from '$lib/components/common/Collapsible.svelte';\r\n\r\n\texport let status = { urls: [], query: '' };\r\n\tlet state = false;\r\n</script>\r\n\r\n<Collapsible bind:open={state} className=\"w-full space-y-1\">\r\n\t<div\r\n\t\tclass=\"flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition\"\r\n\t>\r\n\t\t<slot />\r\n\r\n\t\t{#if state}\r\n\t\t\t<ChevronUp strokeWidth=\"3.5\" className=\"size-3.5 \" />\r\n\t\t{:else}\r\n\t\t\t<ChevronDown strokeWidth=\"3.5\" className=\"size-3.5 \" />\r\n\t\t{/if}\r\n\t</div>\r\n\t<div\r\n\t\tclass=\"text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5\"\r\n\t\tslot=\"content\"\r\n\t>\r\n\t\t{#if status?.query}\r\n\t\t\t<a\r\n\t\t\t\thref=\"https://www.google.com/search?q={status.query}\"\r\n\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\tclass=\"flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"flex gap-2 items-center\">\r\n\t\t\t\t\t<MagnifyingGlass />\r\n\r\n\t\t\t\t\t<div class=\" line-clamp-1\">\r\n\t\t\t\t\t\t{status.query}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\" ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<!--  -->\r\n\t\t\t\t\t<svg\r\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\tviewBox=\"0 0 16 16\"\r\n\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\tclass=\"size-4\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\td=\"M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z\"\r\n\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</div>\r\n\t\t\t</a>\r\n\t\t{/if}\r\n\r\n\t\t{#each status.urls as url, urlIdx}\r\n\t\t\t<a\r\n\t\t\t\thref={url}\r\n\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\tclass=\"flex w-full items-center p-3 px-4 {urlIdx === status.urls.length - 1\r\n\t\t\t\t\t? ''\r\n\t\t\t\t\t: 'border-b border-gray-300/30 dark:border-gray-700/50'} group/item justify-between font-normal text-gray-800 dark:text-gray-300\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\" line-clamp-1\">\r\n\t\t\t\t\t{url}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\" ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<!--  -->\r\n\t\t\t\t\t<svg\r\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\tviewBox=\"0 0 16 16\"\r\n\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\tclass=\"size-4\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\td=\"M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z\"\r\n\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</div>\r\n\t\t\t</a>\r\n\t\t{/each}\r\n\t</div>\r\n</Collapsible>\r\n","<script lang=\"ts\">\r\n\texport let className = 'w-4 h-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport Info from '$lib/components/icons/Info.svelte';\r\n\r\n\texport let content = '';\r\n</script>\r\n\r\n<div class=\"flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg\">\r\n\t<div class=\" self-start mt-0.5\">\r\n\t\t<Info className=\"size-5 text-red-700 dark:text-red-400\" />\r\n\t</div>\r\n\r\n\t<div class=\" self-center text-sm\">\r\n\t\t{typeof content === 'string' ? content : JSON.stringify(content)}\r\n\t</div>\r\n</div>\r\n","<script lang=\"ts\">\r\n\timport { getContext, onMount, tick } from 'svelte';\r\n\timport Modal from '$lib/components/common/Modal.svelte';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport { WEBUI_API_BASE_URL } from '$lib/constants';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let show = false;\r\n\texport let citation;\r\n\texport let showPercentage = false;\r\n\texport let showRelevance = true;\r\n\r\n\tlet mergedDocuments = [];\r\n\r\n\tfunction calculatePercentage(distance: number) {\r\n\t\tif (distance < 0) return 0;\r\n\t\tif (distance > 1) return 100;\r\n\t\treturn Math.round(distance * 10000) / 100;\r\n\t}\r\n\r\n\tfunction getRelevanceColor(percentage: number) {\r\n\t\tif (percentage >= 80)\r\n\t\t\treturn 'bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200';\r\n\t\tif (percentage >= 60)\r\n\t\t\treturn 'bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200';\r\n\t\tif (percentage >= 40)\r\n\t\t\treturn 'bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200';\r\n\t\treturn 'bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200';\r\n\t}\r\n\r\n\t$: if (citation) {\r\n\t\tmergedDocuments = citation.document?.map((c, i) => {\r\n\t\t\treturn {\r\n\t\t\t\tsource: citation.source,\r\n\t\t\t\tdocument: c,\r\n\t\t\t\tmetadata: citation.metadata?.[i],\r\n\t\t\t\tdistance: citation.distances?.[i]\r\n\t\t\t};\r\n\t\t});\r\n\t\tif (mergedDocuments.every((doc) => doc.distance !== undefined)) {\r\n\t\t\tmergedDocuments = mergedDocuments.sort(\r\n\t\t\t\t(a, b) => (b.distance ?? Infinity) - (a.distance ?? Infinity)\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<Modal size=\"lg\" bind:show>\r\n\t<div>\r\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-5 pt-4 pb-2\">\r\n\t\t\t<div class=\" text-lg font-medium self-center capitalize\">\r\n\t\t\t\t{$i18n.t('Citation')}\r\n\t\t\t</div>\r\n\t\t\t<button\r\n\t\t\t\tclass=\"self-center\"\r\n\t\t\t\ton:click={() => {\r\n\t\t\t\t\tshow = false;\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<svg\r\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\tclass=\"w-5 h-5\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<path\r\n\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</svg>\r\n\t\t\t</button>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4\">\r\n\t\t\t<div\r\n\t\t\t\tclass=\"flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden\"\r\n\t\t\t>\r\n\t\t\t\t{#each mergedDocuments as document, documentIdx}\r\n\t\t\t\t\t<div class=\"flex flex-col w-full\">\r\n\t\t\t\t\t\t<div class=\"text-sm font-medium dark:text-gray-300\">\r\n\t\t\t\t\t\t\t{$i18n.t('Source')}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{#if document.source?.name}\r\n\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\tclassName=\"w-fit\"\r\n\t\t\t\t\t\t\t\tcontent={$i18n.t('Open file')}\r\n\t\t\t\t\t\t\t\tplacement=\"top-start\"\r\n\t\t\t\t\t\t\t\ttippyOptions={{ duration: [500, 0] }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<div class=\"text-sm dark:text-gray-400 flex items-center gap-2 w-fit\">\r\n\t\t\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\t\t\tclass=\"hover:text-gray-500 dark:hover:text-gray-100 underline grow\"\r\n\t\t\t\t\t\t\t\t\t\thref={document?.metadata?.file_id\r\n\t\t\t\t\t\t\t\t\t\t\t? `${WEBUI_API_BASE_URL}/files/${document?.metadata?.file_id}/content${document?.metadata?.page !== undefined ? `#page=${document.metadata.page + 1}` : ''}`\r\n\t\t\t\t\t\t\t\t\t\t\t: document.source?.url?.includes('http')\r\n\t\t\t\t\t\t\t\t\t\t\t\t? document.source.url\r\n\t\t\t\t\t\t\t\t\t\t\t\t: `#`}\r\n\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{document?.metadata?.name ?? document.source.name}\r\n\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t{#if document?.metadata?.page}\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"text-xs text-gray-500 dark:text-gray-400\">\r\n\t\t\t\t\t\t\t\t\t\t\t({$i18n.t('page')}\r\n\t\t\t\t\t\t\t\t\t\t\t{document.metadata.page + 1})\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t{#if showRelevance}\r\n\t\t\t\t\t\t\t\t<div class=\"text-sm font-medium dark:text-gray-300 mt-2\">\r\n\t\t\t\t\t\t\t\t\t{$i18n.t('Relevance')}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{#if document.distance !== undefined}\r\n\t\t\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"w-fit\"\r\n\t\t\t\t\t\t\t\t\t\tcontent={$i18n.t('Semantic distance to query')}\r\n\t\t\t\t\t\t\t\t\t\tplacement=\"top-start\"\r\n\t\t\t\t\t\t\t\t\t\ttippyOptions={{ duration: [500, 0] }}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit\">\r\n\t\t\t\t\t\t\t\t\t\t\t{#if showPercentage}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{@const percentage = calculatePercentage(document.distance)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass={`px-1 rounded-sm font-medium ${getRelevanceColor(percentage)}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{percentage.toFixed(2)}%\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-gray-500 dark:text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t({document.distance.toFixed(4)})\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-gray-500 dark:text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{document.distance.toFixed(4)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t<div class=\"text-sm dark:text-gray-400\">\r\n\t\t\t\t\t\t\t\t\t\t{$i18n.t('No distance available')}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<div class=\"text-sm dark:text-gray-400\">\r\n\t\t\t\t\t\t\t\t{$i18n.t('No source available')}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"flex flex-col w-full\">\r\n\t\t\t\t\t\t<div class=\" text-sm font-medium dark:text-gray-300 mt-2\">\r\n\t\t\t\t\t\t\t{$i18n.t('Content')}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{#if document.metadata?.html}\r\n\t\t\t\t\t\t\t<iframe\r\n\t\t\t\t\t\t\t\tclass=\"w-full border-0 h-auto rounded-none\"\r\n\t\t\t\t\t\t\t\tsandbox=\"allow-scripts allow-forms allow-same-origin\"\r\n\t\t\t\t\t\t\t\tsrcdoc={document.document}\r\n\t\t\t\t\t\t\t\ttitle={$i18n.t('Content')}\r\n\t\t\t\t\t\t\t></iframe>\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<pre class=\"text-sm dark:text-gray-400 whitespace-pre-line\">\r\n                {document.document}\r\n              </pre>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if documentIdx !== mergedDocuments.length - 1}\r\n\t\t\t\t\t\t<hr class=\"border-gray-100 dark:border-gray-850 my-3\" />\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t{/each}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</Modal>\r\n","<script lang=\"ts\">\r\n\timport { getContext } from 'svelte';\r\n\timport CitationsModal from './CitationsModal.svelte';\r\n\timport Collapsible from '$lib/components/common/Collapsible.svelte';\r\n\timport ChevronDown from '$lib/components/icons/ChevronDown.svelte';\r\n\timport ChevronUp from '$lib/components/icons/ChevronUp.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let id = '';\r\n\texport let sources = [];\r\n\r\n\tlet citations = [];\r\n\tlet showPercentage = false;\r\n\tlet showRelevance = true;\r\n\r\n\tlet showCitationModal = false;\r\n\tlet selectedCitation: any = null;\r\n\tlet isCollapsibleOpen = false;\r\n\r\n\tfunction calculateShowRelevance(sources: any[]) {\r\n\t\tconst distances = sources.flatMap((citation) => citation.distances ?? []);\r\n\t\tconst inRange = distances.filter((d) => d !== undefined && d >= -1 && d <= 1).length;\r\n\t\tconst outOfRange = distances.filter((d) => d !== undefined && (d < -1 || d > 1)).length;\r\n\r\n\t\tif (distances.length === 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (\r\n\t\t\t(inRange === distances.length - 1 && outOfRange === 1) ||\r\n\t\t\t(outOfRange === distances.length - 1 && inRange === 1)\r\n\t\t) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tfunction shouldShowPercentage(sources: any[]) {\r\n\t\tconst distances = sources.flatMap((citation) => citation.distances ?? []);\r\n\t\treturn distances.every((d) => d !== undefined && d >= -1 && d <= 1);\r\n\t}\r\n\r\n\t$: {\r\n\t\tcitations = sources.reduce((acc, source) => {\r\n\t\t\tif (Object.keys(source).length === 0) {\r\n\t\t\t\treturn acc;\r\n\t\t\t}\r\n\r\n\t\t\tsource.document.forEach((document, index) => {\r\n\t\t\t\tconst metadata = source.metadata?.[index];\r\n\t\t\t\tconst distance = source.distances?.[index];\r\n\r\n\t\t\t\t// Within the same citation there could be multiple documents\r\n\t\t\t\tconst id = metadata?.source ?? 'N/A';\r\n\t\t\t\tlet _source = source?.source;\r\n\r\n\t\t\t\tif (metadata?.name) {\r\n\t\t\t\t\t_source = { ..._source, name: metadata.name };\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (id.startsWith('http://') || id.startsWith('https://')) {\r\n\t\t\t\t\t_source = { ..._source, name: id, url: id };\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst existingSource = acc.find((item) => item.id === id);\r\n\r\n\t\t\t\tif (existingSource) {\r\n\t\t\t\t\texistingSource.document.push(document);\r\n\t\t\t\t\texistingSource.metadata.push(metadata);\r\n\t\t\t\t\tif (distance !== undefined) existingSource.distances.push(distance);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tacc.push({\r\n\t\t\t\t\t\tid: id,\r\n\t\t\t\t\t\tsource: _source,\r\n\t\t\t\t\t\tdocument: [document],\r\n\t\t\t\t\t\tmetadata: metadata ? [metadata] : [],\r\n\t\t\t\t\t\tdistances: distance !== undefined ? [distance] : undefined\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn acc;\r\n\t\t}, []);\r\n\r\n\t\tshowRelevance = calculateShowRelevance(citations);\r\n\t\tshowPercentage = shouldShowPercentage(citations);\r\n\t}\r\n</script>\r\n\r\n<CitationsModal\r\n\tbind:show={showCitationModal}\r\n\tcitation={selectedCitation}\r\n\t{showPercentage}\r\n\t{showRelevance}\r\n/>\r\n\r\n{#if citations.length > 0}\r\n\t<div class=\" py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap\">\r\n\t\t{#if citations.length <= 3}\r\n\t\t\t<div class=\"flex text-xs font-medium flex-wrap\">\r\n\t\t\t\t{#each citations as citation, idx}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tid={`source-${id}-${idx}`}\r\n\t\t\t\t\t\tclass=\"no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tshowCitationModal = true;\r\n\t\t\t\t\t\t\tselectedCitation = citation;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#if citations.every((c) => c.distances !== undefined)}\r\n\t\t\t\t\t\t\t<div class=\"bg-gray-50 dark:bg-gray-800 rounded-full size-4\">\r\n\t\t\t\t\t\t\t\t{idx + 1}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\"flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{citation.source.name}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/each}\r\n\t\t\t</div>\r\n\t\t{:else}\r\n\t\t\t<Collapsible\r\n\t\t\t\tid=\"collapsible-sources\"\r\n\t\t\t\tbind:open={isCollapsibleOpen}\r\n\t\t\t\tclassName=\"w-full max-w-full \"\r\n\t\t\t\tbuttonClassName=\"w-fit max-w-full\"\r\n\t\t\t>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\"flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<span class=\"whitespace-nowrap hidden sm:inline shrink-0\"\r\n\t\t\t\t\t\t\t>{$i18n.t('References from')}</span\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t<div class=\"flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1\">\r\n\t\t\t\t\t\t\t<div class=\"flex text-xs font-medium items-center\">\r\n\t\t\t\t\t\t\t\t{#each citations.slice(0, 2) as citation, idx}\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tshowCitationModal = true;\r\n\t\t\t\t\t\t\t\t\t\t\tselectedCitation = citation;\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\ton:pointerup={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{#if citations.every((c) => c.distances !== undefined)}\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"bg-gray-50 dark:bg-gray-800 rounded-full size-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{idx + 1}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex-1 mx-1 truncate\">\r\n\t\t\t\t\t\t\t\t\t\t\t{citation.source.name}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"flex items-center gap-1 whitespace-nowrap shrink-0\">\r\n\t\t\t\t\t\t\t<span class=\"hidden sm:inline\">{$i18n.t('and')}</span>\r\n\t\t\t\t\t\t\t{citations.length - 2}\r\n\t\t\t\t\t\t\t<span>{$i18n.t('more')}</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"shrink-0\">\r\n\t\t\t\t\t\t{#if isCollapsibleOpen}\r\n\t\t\t\t\t\t\t<ChevronUp strokeWidth=\"3.5\" className=\"size-3.5\" />\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<ChevronDown strokeWidth=\"3.5\" className=\"size-3.5\" />\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div slot=\"content\">\r\n\t\t\t\t\t<div class=\"flex text-xs font-medium flex-wrap\">\r\n\t\t\t\t\t\t{#each citations as citation, idx}\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tid={`source-${id}-${idx}`}\r\n\t\t\t\t\t\t\t\tclass=\"no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96\"\r\n\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\tshowCitationModal = true;\r\n\t\t\t\t\t\t\t\t\tselectedCitation = citation;\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{#if citations.every((c) => c.distances !== undefined)}\r\n\t\t\t\t\t\t\t\t\t<div class=\"bg-gray-50 dark:bg-gray-800 rounded-full size-4\">\r\n\t\t\t\t\t\t\t\t\t\t{idx + 1}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t<div class=\"flex-1 mx-1 truncate\">\r\n\t\t\t\t\t\t\t\t\t{citation.source.name}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</Collapsible>\r\n\t\t{/if}\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { getContext } from 'svelte';\r\n\timport CodeBlock from './CodeBlock.svelte';\r\n\timport Modal from '$lib/components/common/Modal.svelte';\r\n\timport Spinner from '$lib/components/common/Spinner.svelte';\r\n\timport Badge from '$lib/components/common/Badge.svelte';\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let show = false;\r\n\texport let codeExecution = null;\r\n</script>\r\n\r\n<Modal size=\"lg\" bind:show>\r\n\t<div>\r\n\t\t<div class=\"flex justify-between dark:text-gray-300 px-5 pt-4 pb-2\">\r\n\t\t\t<div class=\"text-lg font-medium self-center flex flex-col gap-0.5 capitalize\">\r\n\t\t\t\t{#if codeExecution?.result}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t{#if codeExecution.result?.error}\r\n\t\t\t\t\t\t\t<Badge type=\"error\" content=\"error\" />\r\n\t\t\t\t\t\t{:else if codeExecution.result?.output}\r\n\t\t\t\t\t\t\t<Badge type=\"success\" content=\"success\" />\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<Badge type=\"warning\" content=\"incomplete\" />\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t<div class=\"flex gap-2 items-center\">\r\n\t\t\t\t\t{#if !codeExecution?.result}\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<Spinner className=\"size-4\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t{#if codeExecution?.name}\r\n\t\t\t\t\t\t\t{$i18n.t('Code execution')}: {codeExecution?.name}\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t{$i18n.t('Code execution')}\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<button\r\n\t\t\t\tclass=\"self-center\"\r\n\t\t\t\ton:click={() => {\r\n\t\t\t\t\tshow = false;\r\n\t\t\t\t\tcodeExecution = null;\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<svg\r\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\tclass=\"w-5 h-5\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<path\r\n\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</svg>\r\n\t\t\t</button>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"flex flex-col md:flex-row w-full px-4 pb-5\">\r\n\t\t\t<div\r\n\t\t\t\tclass=\"flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"flex flex-col w-full\">\r\n\t\t\t\t\t<CodeBlock\r\n\t\t\t\t\t\tid=\"code-exec-{codeExecution?.id}-code\"\r\n\t\t\t\t\t\tlang={codeExecution?.language ?? ''}\r\n\t\t\t\t\t\tcode={codeExecution?.code ?? ''}\r\n\t\t\t\t\t\tclassName=\"\"\r\n\t\t\t\t\t\teditorClassName={codeExecution?.result &&\r\n\t\t\t\t\t\t(codeExecution?.result?.error || codeExecution?.result?.output)\r\n\t\t\t\t\t\t\t? 'rounded-b-none'\r\n\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t\tstickyButtonsClassName=\"top-0\"\r\n\t\t\t\t\t\trun={false}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{#if codeExecution?.result && (codeExecution?.result?.error || codeExecution?.result?.output)}\r\n\t\t\t\t\t<div class=\"dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3\">\r\n\t\t\t\t\t\t{#if codeExecution?.result?.error}\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<div class=\" text-gray-500 text-xs mb-1\">{$i18n.t('ERROR')}</div>\r\n\t\t\t\t\t\t\t\t<div class=\"text-sm\">{codeExecution?.result?.error}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t{#if codeExecution?.result?.output}\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<div class=\" text-gray-500 text-xs mb-1\">{$i18n.t('OUTPUT')}</div>\r\n\t\t\t\t\t\t\t\t<div class=\"text-sm\">{codeExecution?.result?.output}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t\t{#if codeExecution?.result?.files && codeExecution?.result?.files.length > 0}\r\n\t\t\t\t\t<div class=\"flex flex-col w-full\">\r\n\t\t\t\t\t\t<hr class=\"border-gray-100 dark:border-gray-850 my-2\" />\r\n\t\t\t\t\t\t<div class=\" text-sm font-medium dark:text-gray-300\">\r\n\t\t\t\t\t\t\t{$i18n.t('Files')}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<ul class=\"mt-1 list-disc pl-4 text-xs\">\r\n\t\t\t\t\t\t\t{#each codeExecution?.result?.files as file}\r\n\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t<a href={file.url} target=\"_blank\">{file.name}</a>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</Modal>\r\n","<script lang=\"ts\">\r\n\timport CodeExecutionModal from './CodeExecutionModal.svelte';\r\n\timport Spinner from '$lib/components/common/Spinner.svelte';\r\n\timport Check from '$lib/components/icons/Check.svelte';\r\n\timport XMark from '$lib/components/icons/XMark.svelte';\r\n\timport EllipsisHorizontal from '$lib/components/icons/EllipsisHorizontal.svelte';\r\n\r\n\texport let codeExecutions = [];\r\n\r\n\tlet selectedCodeExecution = null;\r\n\tlet showCodeExecutionModal = false;\r\n\r\n\t$: if (codeExecutions) {\r\n\t\tupdateSelectedCodeExecution();\r\n\t}\r\n\r\n\tconst updateSelectedCodeExecution = () => {\r\n\t\tif (selectedCodeExecution) {\r\n\t\t\tselectedCodeExecution = codeExecutions.find(\r\n\t\t\t\t(execution) => execution.id === selectedCodeExecution.id\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<CodeExecutionModal bind:show={showCodeExecutionModal} codeExecution={selectedCodeExecution} />\r\n\r\n{#if codeExecutions.length > 0}\r\n\t<div class=\"mt-1 mb-2 w-full flex gap-1 items-center flex-wrap\">\r\n\t\t{#each codeExecutions as execution (execution.id)}\r\n\t\t\t<div class=\"flex gap-1 text-xs font-semibold\">\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass=\"flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96\"\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tselectedCodeExecution = execution;\r\n\t\t\t\t\t\tshowCodeExecutionModal = true;\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\"bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#if execution?.result}\r\n\t\t\t\t\t\t\t{#if execution.result?.error}\r\n\t\t\t\t\t\t\t\t<XMark />\r\n\t\t\t\t\t\t\t{:else if execution.result?.output}\r\n\t\t\t\t\t\t\t\t<Check strokeWidth=\"3\" className=\"size-3\" />\r\n\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t<EllipsisHorizontal />\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<Spinner className=\"size-4\" />\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\"flex-1 mx-2 line-clamp-1 code-execution-name {execution?.result ? '' : 'pulse'}\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{execution.name}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t{/each}\r\n\t</div>\r\n{/if}\r\n\r\n<style>\r\n\t@keyframes pulse {\r\n\t\t0%,\r\n\t\t100% {\r\n\t\t\topacity: 1;\r\n\t\t}\r\n\t\t50% {\r\n\t\t\topacity: 0.6;\r\n\t\t}\r\n\t}\r\n\r\n\t.pulse {\r\n\t\topacity: 1;\r\n\t\tanimation: pulse 1.5s ease;\r\n\t}\r\n</style>\r\n","<script lang=\"ts\">\r\n\texport let className = 'size-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\texport let className = 'w-4 h-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\timport DOMPurify from 'dompurify';\r\n\timport { marked } from 'marked';\r\n\r\n\timport { getContext, tick } from 'svelte';\r\n\tconst i18n = getContext('i18n');\r\n\r\n\timport { chatCompletion } from '$lib/apis/openai';\r\n\r\n\timport ChatBubble from '$lib/components/icons/ChatBubble.svelte';\r\n\timport LightBlub from '$lib/components/icons/LightBlub.svelte';\r\n\timport Markdown from '../Messages/Markdown.svelte';\r\n\timport Skeleton from '../Messages/Skeleton.svelte';\r\n\r\n\texport let id = '';\r\n\texport let model = null;\r\n\texport let messages = [];\r\n\texport let onAdd = () => {};\r\n\r\n\tlet floatingInput = false;\r\n\r\n\tlet selectedText = '';\r\n\tlet floatingInputValue = '';\r\n\r\n\tlet prompt = '';\r\n\tlet responseContent = null;\r\n\tlet responseDone = false;\r\n\r\n\tconst autoScroll = async () => {\r\n\t\t// Scroll to bottom only if the scroll is at the bottom give 50px buffer\r\n\t\tconst responseContainer = document.getElementById('response-container');\r\n\t\tif (\r\n\t\t\tresponseContainer.scrollHeight - responseContainer.clientHeight <=\r\n\t\t\tresponseContainer.scrollTop + 50\r\n\t\t) {\r\n\t\t\tresponseContainer.scrollTop = responseContainer.scrollHeight;\r\n\t\t}\r\n\t};\r\n\r\n\tconst askHandler = async () => {\r\n\t\tif (!model) {\r\n\t\t\ttoast.error('Model not selected');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tprompt = `${floatingInputValue}\\n\\`\\`\\`\\n${selectedText}\\n\\`\\`\\``;\r\n\t\tfloatingInputValue = '';\r\n\r\n\t\tresponseContent = '';\r\n\t\tconst [res, controller] = await chatCompletion(localStorage.token, {\r\n\t\t\tmodel: model,\r\n\t\t\tmessages: [\r\n\t\t\t\t...messages,\r\n\t\t\t\t{\r\n\t\t\t\t\trole: 'user',\r\n\t\t\t\t\tcontent: prompt\r\n\t\t\t\t}\r\n\t\t\t].map((message) => ({\r\n\t\t\t\trole: message.role,\r\n\t\t\t\tcontent: message.content\r\n\t\t\t})),\r\n\t\t\tstream: true // Enable streaming\r\n\t\t});\r\n\r\n\t\tif (res && res.ok) {\r\n\t\t\tconst reader = res.body.getReader();\r\n\t\t\tconst decoder = new TextDecoder();\r\n\r\n\t\t\tconst processStream = async () => {\r\n\t\t\t\twhile (true) {\r\n\t\t\t\t\t// Read data chunks from the response stream\r\n\t\t\t\t\tconst { done, value } = await reader.read();\r\n\t\t\t\t\tif (done) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Decode the received chunk\r\n\t\t\t\t\tconst chunk = decoder.decode(value, { stream: true });\r\n\r\n\t\t\t\t\t// Process lines within the chunk\r\n\t\t\t\t\tconst lines = chunk.split('\\n').filter((line) => line.trim() !== '');\r\n\r\n\t\t\t\t\tfor (const line of lines) {\r\n\t\t\t\t\t\tif (line.startsWith('data: ')) {\r\n\t\t\t\t\t\t\tif (line.startsWith('data: [DONE]')) {\r\n\t\t\t\t\t\t\t\tresponseDone = true;\r\n\r\n\t\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t\t\tautoScroll();\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// Parse the JSON chunk\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tconst data = JSON.parse(line.slice(6));\r\n\r\n\t\t\t\t\t\t\t\t\t// Append the `content` field from the \"choices\" object\r\n\t\t\t\t\t\t\t\t\tif (data.choices && data.choices[0]?.delta?.content) {\r\n\t\t\t\t\t\t\t\t\t\tresponseContent += data.choices[0].delta.content;\r\n\r\n\t\t\t\t\t\t\t\t\t\tautoScroll();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\tconsole.error(e);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// Process the stream in the background\r\n\t\t\tawait processStream();\r\n\t\t} else {\r\n\t\t\ttoast.error('An error occurred while fetching the explanation');\r\n\t\t}\r\n\t};\r\n\r\n\tconst explainHandler = async () => {\r\n\t\tif (!model) {\r\n\t\t\ttoast.error('Model not selected');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tprompt = `Explain this section to me in more detail\\n\\n\\`\\`\\`\\n${selectedText}\\n\\`\\`\\``;\r\n\r\n\t\tresponseContent = '';\r\n\t\tconst [res, controller] = await chatCompletion(localStorage.token, {\r\n\t\t\tmodel: model,\r\n\t\t\tmessages: [\r\n\t\t\t\t...messages,\r\n\t\t\t\t{\r\n\t\t\t\t\trole: 'user',\r\n\t\t\t\t\tcontent: prompt\r\n\t\t\t\t}\r\n\t\t\t].map((message) => ({\r\n\t\t\t\trole: message.role,\r\n\t\t\t\tcontent: message.content\r\n\t\t\t})),\r\n\t\t\tstream: true // Enable streaming\r\n\t\t});\r\n\r\n\t\tif (res && res.ok) {\r\n\t\t\tconst reader = res.body.getReader();\r\n\t\t\tconst decoder = new TextDecoder();\r\n\r\n\t\t\tconst processStream = async () => {\r\n\t\t\t\twhile (true) {\r\n\t\t\t\t\t// Read data chunks from the response stream\r\n\t\t\t\t\tconst { done, value } = await reader.read();\r\n\t\t\t\t\tif (done) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Decode the received chunk\r\n\t\t\t\t\tconst chunk = decoder.decode(value, { stream: true });\r\n\r\n\t\t\t\t\t// Process lines within the chunk\r\n\t\t\t\t\tconst lines = chunk.split('\\n').filter((line) => line.trim() !== '');\r\n\r\n\t\t\t\t\tfor (const line of lines) {\r\n\t\t\t\t\t\tif (line.startsWith('data: ')) {\r\n\t\t\t\t\t\t\tif (line.startsWith('data: [DONE]')) {\r\n\t\t\t\t\t\t\t\tresponseDone = true;\r\n\r\n\t\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t\t\tautoScroll();\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// Parse the JSON chunk\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tconst data = JSON.parse(line.slice(6));\r\n\r\n\t\t\t\t\t\t\t\t\t// Append the `content` field from the \"choices\" object\r\n\t\t\t\t\t\t\t\t\tif (data.choices && data.choices[0]?.delta?.content) {\r\n\t\t\t\t\t\t\t\t\t\tresponseContent += data.choices[0].delta.content;\r\n\r\n\t\t\t\t\t\t\t\t\t\tautoScroll();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\tconsole.error(e);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// Process the stream in the background\r\n\t\t\tawait processStream();\r\n\t\t} else {\r\n\t\t\ttoast.error('An error occurred while fetching the explanation');\r\n\t\t}\r\n\t};\r\n\r\n\tconst addHandler = async () => {\r\n\t\tconst messages = [\r\n\t\t\t{\r\n\t\t\t\trole: 'user',\r\n\t\t\t\tcontent: prompt\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\trole: 'assistant',\r\n\t\t\t\tcontent: responseContent\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\tonAdd({\r\n\t\t\tmodelId: model,\r\n\t\t\tparentId: id,\r\n\t\t\tmessages: messages\r\n\t\t});\r\n\t};\r\n\r\n\texport const closeHandler = () => {\r\n\t\tresponseContent = null;\r\n\t\tresponseDone = false;\r\n\t\tfloatingInput = false;\r\n\t\tfloatingInputValue = '';\r\n\t};\r\n</script>\r\n\r\n<div\r\n\tid={`floating-buttons-${id}`}\r\n\tclass=\"absolute rounded-lg mt-1 text-xs z-9999\"\r\n\tstyle=\"display: none\"\r\n>\r\n\t{#if responseContent === null}\r\n\t\t{#if !floatingInput}\r\n\t\t\t<div\r\n\t\t\t\tclass=\"flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl\"\r\n\t\t\t>\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass=\"px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit\"\r\n\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\tselectedText = window.getSelection().toString();\r\n\t\t\t\t\t\tfloatingInput = true;\r\n\r\n\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tconst input = document.getElementById('floating-message-input');\r\n\t\t\t\t\t\t\tif (input) {\r\n\t\t\t\t\t\t\t\tinput.focus();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, 0);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<ChatBubble className=\"size-3 shrink-0\" />\r\n\r\n\t\t\t\t\t<div class=\"shrink-0\">Ask</div>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass=\"px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit\"\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tselectedText = window.getSelection().toString();\r\n\t\t\t\t\t\texplainHandler();\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<LightBlub className=\"size-3 shrink-0\" />\r\n\r\n\t\t\t\t\t<div class=\"shrink-0\">Explain</div>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t{:else}\r\n\t\t\t<div\r\n\t\t\t\tclass=\"py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border dark:border-gray-850 w-72 rounded-full shadow-xl\"\r\n\t\t\t>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tid=\"floating-message-input\"\r\n\t\t\t\t\tclass=\"ml-5 bg-transparent outline-hidden w-full flex-1 text-sm\"\r\n\t\t\t\t\tplaceholder={$i18n.t('Ask a question')}\r\n\t\t\t\t\tbind:value={floatingInputValue}\r\n\t\t\t\t\ton:keydown={(e) => {\r\n\t\t\t\t\t\tif (e.key === 'Enter') {\r\n\t\t\t\t\t\t\taskHandler();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t<div class=\"ml-1 mr-2\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclass=\"{floatingInputValue !== ''\r\n\t\t\t\t\t\t\t? 'bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 '\r\n\t\t\t\t\t\t\t: 'text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled'} transition rounded-full p-1.5 m-0.5 self-center\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\taskHandler();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\r\n\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\tclass=\"size-4\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\td=\"M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z\"\r\n\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\t{:else}\r\n\t\t<div class=\"bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full\">\r\n\t\t\t<div\r\n\t\t\t\tclass=\"bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"font-medium\">\r\n\t\t\t\t\t<Markdown id={`${id}-float-prompt`} content={prompt} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclass=\"bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\" max-h-80 overflow-y-auto w-full markdown-prose-xs\" id=\"response-container\">\r\n\t\t\t\t\t{#if responseContent.trim() === ''}\r\n\t\t\t\t\t\t<Skeleton size=\"sm\" />\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<Markdown id={`${id}-float-response`} content={responseContent} />\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t{#if responseDone}\r\n\t\t\t\t\t\t<div class=\"flex justify-end pt-3 text-sm font-medium\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\r\n\t\t\t\t\t\t\t\ton:click={addHandler}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{$i18n.t('Add')}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t{/if}\r\n</div>\r\n","<script>\r\n\timport { onDestroy, onMount, tick, getContext, createEventDispatcher } from 'svelte';\r\n\tconst i18n = getContext('i18n');\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\timport Markdown from './Markdown.svelte';\r\n\timport { chatId, mobile, showArtifacts, showControls, showOverview } from '$lib/stores';\r\n\timport FloatingButtons from '../ContentRenderer/FloatingButtons.svelte';\r\n\timport { createMessagesList } from '$lib/utils';\r\n\r\n\texport let id;\r\n\texport let content;\r\n\texport let history;\r\n\texport let model = null;\r\n\texport let sources = null;\r\n\r\n\texport let save = false;\r\n\texport let floatingButtons = true;\r\n\r\n\texport let onSourceClick = () => {};\r\n\texport let onTaskClick = () => {};\r\n\r\n\texport let onAddMessages = () => {};\r\n\r\n\tlet contentContainerElement;\r\n\r\n\tlet floatingButtonsElement;\r\n\r\n\tconst updateButtonPosition = (event) => {\r\n\t\tconst buttonsContainerElement = document.getElementById(`floating-buttons-${id}`);\r\n\t\tif (\r\n\t\t\t!contentContainerElement?.contains(event.target) &&\r\n\t\t\t!buttonsContainerElement?.contains(event.target)\r\n\t\t) {\r\n\t\t\tcloseFloatingButtons();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetTimeout(async () => {\r\n\t\t\tawait tick();\r\n\r\n\t\t\tif (!contentContainerElement?.contains(event.target)) return;\r\n\r\n\t\t\tlet selection = window.getSelection();\r\n\r\n\t\t\tif (selection.toString().trim().length > 0) {\r\n\t\t\t\tconst range = selection.getRangeAt(0);\r\n\t\t\t\tconst rect = range.getBoundingClientRect();\r\n\r\n\t\t\t\tconst parentRect = contentContainerElement.getBoundingClientRect();\r\n\r\n\t\t\t\t// Adjust based on parent rect\r\n\t\t\t\tconst top = rect.bottom - parentRect.top;\r\n\t\t\t\tconst left = rect.left - parentRect.left;\r\n\r\n\t\t\t\tif (buttonsContainerElement) {\r\n\t\t\t\t\tbuttonsContainerElement.style.display = 'block';\r\n\r\n\t\t\t\t\t// Calculate space available on the right\r\n\t\t\t\t\tconst spaceOnRight = parentRect.width - left;\r\n\t\t\t\t\tlet halfScreenWidth = $mobile ? window.innerWidth / 2 : window.innerWidth / 3;\r\n\r\n\t\t\t\t\tif (spaceOnRight < halfScreenWidth) {\r\n\t\t\t\t\t\tconst right = parentRect.right - rect.right;\r\n\t\t\t\t\t\tbuttonsContainerElement.style.right = `${right}px`;\r\n\t\t\t\t\t\tbuttonsContainerElement.style.left = 'auto'; // Reset left\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Enough space, position using 'left'\r\n\t\t\t\t\t\tbuttonsContainerElement.style.left = `${left}px`;\r\n\t\t\t\t\t\tbuttonsContainerElement.style.right = 'auto'; // Reset right\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbuttonsContainerElement.style.top = `${top + 5}px`; // +5 to add some spacing\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tcloseFloatingButtons();\r\n\t\t\t}\r\n\t\t}, 0);\r\n\t};\r\n\r\n\tconst closeFloatingButtons = () => {\r\n\t\tconst buttonsContainerElement = document.getElementById(`floating-buttons-${id}`);\r\n\t\tif (buttonsContainerElement) {\r\n\t\t\tbuttonsContainerElement.style.display = 'none';\r\n\t\t}\r\n\r\n\t\tif (floatingButtonsElement) {\r\n\t\t\tfloatingButtonsElement.closeHandler();\r\n\t\t}\r\n\t};\r\n\r\n\tconst keydownHandler = (e) => {\r\n\t\tif (e.key === 'Escape') {\r\n\t\t\tcloseFloatingButtons();\r\n\t\t}\r\n\t};\r\n\r\n\tonMount(() => {\r\n\t\tif (floatingButtons) {\r\n\t\t\tcontentContainerElement?.addEventListener('mouseup', updateButtonPosition);\r\n\t\t\tdocument.addEventListener('mouseup', updateButtonPosition);\r\n\t\t\tdocument.addEventListener('keydown', keydownHandler);\r\n\t\t}\r\n\t});\r\n\r\n\tonDestroy(() => {\r\n\t\tif (floatingButtons) {\r\n\t\t\tcontentContainerElement?.removeEventListener('mouseup', updateButtonPosition);\r\n\t\t\tdocument.removeEventListener('mouseup', updateButtonPosition);\r\n\t\t\tdocument.removeEventListener('keydown', keydownHandler);\r\n\t\t}\r\n\t});\r\n</script>\r\n\r\n<div bind:this={contentContainerElement}>\r\n\t<Markdown\r\n\t\t{id}\r\n\t\t{content}\r\n\t\t{model}\r\n\t\t{save}\r\n\t\tsourceIds={(sources ?? []).reduce((acc, s) => {\r\n\t\t\tlet ids = [];\r\n\t\t\ts.document.forEach((document, index) => {\r\n\t\t\t\tif (model?.info?.meta?.capabilities?.citations == false) {\r\n\t\t\t\t\tids.push('N/A');\r\n\t\t\t\t\treturn ids;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst metadata = s.metadata?.[index];\r\n\t\t\t\tconst id = metadata?.source ?? 'N/A';\r\n\r\n\t\t\t\tif (metadata?.name) {\r\n\t\t\t\t\tids.push(metadata.name);\r\n\t\t\t\t\treturn ids;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (id.startsWith('http://') || id.startsWith('https://')) {\r\n\t\t\t\t\tids.push(id);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tids.push(s?.source?.name ?? id);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn ids;\r\n\t\t\t});\r\n\r\n\t\t\tacc = [...acc, ...ids];\r\n\r\n\t\t\t// remove duplicates\r\n\t\t\treturn acc.filter((item, index) => acc.indexOf(item) === index);\r\n\t\t}, [])}\r\n\t\t{onSourceClick}\r\n\t\t{onTaskClick}\r\n\t\ton:update={(e) => {\r\n\t\t\tdispatch('update', e.detail);\r\n\t\t}}\r\n\t\ton:code={(e) => {\r\n\t\t\tconst { lang, code } = e.detail;\r\n\r\n\t\t\tif (\r\n\t\t\t\t(['html', 'svg'].includes(lang) || (lang === 'xml' && code.includes('svg'))) &&\r\n\t\t\t\t!$mobile &&\r\n\t\t\t\t$chatId\r\n\t\t\t) {\r\n\t\t\t\tshowArtifacts.set(true);\r\n\t\t\t\tshowControls.set(true);\r\n\t\t\t}\r\n\t\t}}\r\n\t/>\r\n</div>\r\n\r\n{#if floatingButtons && model}\r\n\t<FloatingButtons\r\n\t\tbind:this={floatingButtonsElement}\r\n\t\t{id}\r\n\t\tmodel={model?.id}\r\n\t\tmessages={createMessagesList(history, id)}\r\n\t\tonAdd={({ modelId, parentId, messages }) => {\r\n\t\t\tconsole.log(modelId, parentId, messages);\r\n\t\t\tonAddMessages({ modelId, parentId, messages });\r\n\t\t\tcloseFloatingButtons();\r\n\t\t}}\r\n\t/>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\timport dayjs from 'dayjs';\r\n\r\n\timport { createEventDispatcher } from 'svelte';\r\n\timport { onMount, tick, getContext } from 'svelte';\r\n\timport type { Writable } from 'svelte/store';\r\n\timport type { i18n as i18nType } from 'i18next';\r\n\r\n\tconst i18n = getContext<Writable<i18nType>>('i18n');\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\timport { createNewFeedback, getFeedbackById, updateFeedbackById } from '$lib/apis/evaluations';\r\n\timport { getChatById } from '$lib/apis/chats';\r\n\timport { generateTags } from '$lib/apis';\r\n\r\n\timport { config, models, settings, temporaryChatEnabled, TTSWorker, user } from '$lib/stores';\r\n\timport { synthesizeOpenAISpeech } from '$lib/apis/audio';\r\n\timport { imageGenerations } from '$lib/apis/images';\r\n\timport {\r\n\t\tcopyToClipboard as _copyToClipboard,\r\n\t\tapproximateToHumanReadable,\r\n\t\tgetMessageContentParts,\r\n\t\tsanitizeResponseContent,\r\n\t\tcreateMessagesList,\r\n\t\tformatDate\r\n\t} from '$lib/utils';\r\n\timport { WEBUI_BASE_URL } from '$lib/constants';\r\n\r\n\timport Name from './Name.svelte';\r\n\timport ProfileImage from './ProfileImage.svelte';\r\n\timport Skeleton from './Skeleton.svelte';\r\n\timport Image from '$lib/components/common/Image.svelte';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport RateComment from './RateComment.svelte';\r\n\timport Spinner from '$lib/components/common/Spinner.svelte';\r\n\timport WebSearchResults from './ResponseMessage/WebSearchResults.svelte';\r\n\timport Sparkles from '$lib/components/icons/Sparkles.svelte';\r\n\r\n\timport DeleteConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\r\n\r\n\timport Error from './Error.svelte';\r\n\timport Citations from './Citations.svelte';\r\n\timport CodeExecutions from './CodeExecutions.svelte';\r\n\timport ContentRenderer from './ContentRenderer.svelte';\r\n\timport { KokoroWorker } from '$lib/workers/KokoroWorker';\r\n\r\n\tinterface MessageType {\r\n\t\tid: string;\r\n\t\tmodel: string;\r\n\t\tcontent: string;\r\n\t\tfiles?: { type: string; url: string }[];\r\n\t\ttimestamp: number;\r\n\t\trole: string;\r\n\t\tstatusHistory?: {\r\n\t\t\tdone: boolean;\r\n\t\t\taction: string;\r\n\t\t\tdescription: string;\r\n\t\t\turls?: string[];\r\n\t\t\tquery?: string;\r\n\t\t}[];\r\n\t\tstatus?: {\r\n\t\t\tdone: boolean;\r\n\t\t\taction: string;\r\n\t\t\tdescription: string;\r\n\t\t\turls?: string[];\r\n\t\t\tquery?: string;\r\n\t\t};\r\n\t\tdone: boolean;\r\n\t\terror?: boolean | { content: string };\r\n\t\tsources?: string[];\r\n\t\tcode_executions?: {\r\n\t\t\tuuid: string;\r\n\t\t\tname: string;\r\n\t\t\tcode: string;\r\n\t\t\tlanguage?: string;\r\n\t\t\tresult?: {\r\n\t\t\t\terror?: string;\r\n\t\t\t\toutput?: string;\r\n\t\t\t\tfiles?: { name: string; url: string }[];\r\n\t\t\t};\r\n\t\t}[];\r\n\t\tinfo?: {\r\n\t\t\topenai?: boolean;\r\n\t\t\tprompt_tokens?: number;\r\n\t\t\tcompletion_tokens?: number;\r\n\t\t\ttotal_tokens?: number;\r\n\t\t\teval_count?: number;\r\n\t\t\teval_duration?: number;\r\n\t\t\tprompt_eval_count?: number;\r\n\t\t\tprompt_eval_duration?: number;\r\n\t\t\ttotal_duration?: number;\r\n\t\t\tload_duration?: number;\r\n\t\t\tusage?: unknown;\r\n\t\t};\r\n\t\tannotation?: { type: string; rating: number };\r\n\t}\r\n\r\n\texport let chatId = '';\r\n\texport let history;\r\n\texport let messageId;\r\n\r\n\tlet message: MessageType = JSON.parse(JSON.stringify(history.messages[messageId]));\r\n\t$: if (history.messages) {\r\n\t\tif (JSON.stringify(message) !== JSON.stringify(history.messages[messageId])) {\r\n\t\t\tmessage = JSON.parse(JSON.stringify(history.messages[messageId]));\r\n\t\t}\r\n\t}\r\n\r\n\texport let siblings;\r\n\r\n\texport let showPreviousMessage: Function;\r\n\texport let showNextMessage: Function;\r\n\r\n\texport let updateChat: Function;\r\n\texport let editMessage: Function;\r\n\texport let saveMessage: Function;\r\n\texport let rateMessage: Function;\r\n\texport let actionMessage: Function;\r\n\texport let deleteMessage: Function;\r\n\r\n\texport let submitMessage: Function;\r\n\texport let continueResponse: Function;\r\n\texport let regenerateResponse: Function;\r\n\r\n\texport let addMessages: Function;\r\n\r\n\texport let isLastMessage = true;\r\n\texport let readOnly = false;\r\n\r\n\tlet showDeleteConfirm = false;\r\n\r\n\tlet model = null;\r\n\t$: model = $models.find((m) => m.id === message.model);\r\n\r\n\tlet edit = false;\r\n\tlet editedContent = '';\r\n\tlet editTextAreaElement: HTMLTextAreaElement;\r\n\r\n\tlet audioParts: Record<number, HTMLAudioElement | null> = {};\r\n\tlet speaking = false;\r\n\tlet speakingIdx: number | undefined;\r\n\r\n\tlet loadingSpeech = false;\r\n\tlet generatingImage = false;\r\n\r\n\tlet showRateComment = false;\r\n\r\n\tconst copyToClipboard = async (text) => {\r\n\t\tconst res = await _copyToClipboard(text);\r\n\t\tif (res) {\r\n\t\t\ttoast.success($i18n.t('Copying to clipboard was successful!'));\r\n\t\t}\r\n\t};\r\n\r\n\tconst playAudio = (idx: number) => {\r\n\t\treturn new Promise<void>((res) => {\r\n\t\t\tspeakingIdx = idx;\r\n\t\t\tconst audio = audioParts[idx];\r\n\r\n\t\t\tif (!audio) {\r\n\t\t\t\treturn res();\r\n\t\t\t}\r\n\r\n\t\t\taudio.play();\r\n\t\t\taudio.onended = async () => {\r\n\t\t\t\tawait new Promise((r) => setTimeout(r, 300));\r\n\r\n\t\t\t\tif (Object.keys(audioParts).length - 1 === idx) {\r\n\t\t\t\t\tspeaking = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tres();\r\n\t\t\t};\r\n\t\t});\r\n\t};\r\n\r\n\tconst toggleSpeakMessage = async () => {\r\n\t\tif (speaking) {\r\n\t\t\ttry {\r\n\t\t\t\tspeechSynthesis.cancel();\r\n\r\n\t\t\t\tif (speakingIdx !== undefined && audioParts[speakingIdx]) {\r\n\t\t\t\t\taudioParts[speakingIdx]!.pause();\r\n\t\t\t\t\taudioParts[speakingIdx]!.currentTime = 0;\r\n\t\t\t\t}\r\n\t\t\t} catch {}\r\n\r\n\t\t\tspeaking = false;\r\n\t\t\tspeakingIdx = undefined;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!(message?.content ?? '').trim().length) {\r\n\t\t\ttoast.info($i18n.t('No content to speak'));\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tspeaking = true;\r\n\r\n\t\tif ($config.audio.tts.engine === '') {\r\n\t\t\tlet voices = [];\r\n\t\t\tconst getVoicesLoop = setInterval(() => {\r\n\t\t\t\tvoices = speechSynthesis.getVoices();\r\n\t\t\t\tif (voices.length > 0) {\r\n\t\t\t\t\tclearInterval(getVoicesLoop);\r\n\r\n\t\t\t\t\tconst voice =\r\n\t\t\t\t\t\tvoices\r\n\t\t\t\t\t\t\t?.filter(\r\n\t\t\t\t\t\t\t\t(v) => v.voiceURI === ($settings?.audio?.tts?.voice ?? $config?.audio?.tts?.voice)\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t?.at(0) ?? undefined;\r\n\r\n\t\t\t\t\tconsole.log(voice);\r\n\r\n\t\t\t\t\tconst speak = new SpeechSynthesisUtterance(message.content);\r\n\t\t\t\t\tspeak.rate = $settings.audio?.tts?.playbackRate ?? 1;\r\n\r\n\t\t\t\t\tconsole.log(speak);\r\n\r\n\t\t\t\t\tspeak.onend = () => {\r\n\t\t\t\t\t\tspeaking = false;\r\n\t\t\t\t\t\tif ($settings.conversationMode) {\r\n\t\t\t\t\t\t\tdocument.getElementById('voice-input-button')?.click();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif (voice) {\r\n\t\t\t\t\t\tspeak.voice = voice;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tspeechSynthesis.speak(speak);\r\n\t\t\t\t}\r\n\t\t\t}, 100);\r\n\t\t} else {\r\n\t\t\tloadingSpeech = true;\r\n\r\n\t\t\tconst messageContentParts: string[] = getMessageContentParts(\r\n\t\t\t\tmessage.content,\r\n\t\t\t\t$config?.audio?.tts?.split_on ?? 'punctuation'\r\n\t\t\t);\r\n\r\n\t\t\tif (!messageContentParts.length) {\r\n\t\t\t\tconsole.log('No content to speak');\r\n\t\t\t\ttoast.info($i18n.t('No content to speak'));\r\n\r\n\t\t\t\tspeaking = false;\r\n\t\t\t\tloadingSpeech = false;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconsole.debug('Prepared message content for TTS', messageContentParts);\r\n\r\n\t\t\taudioParts = messageContentParts.reduce(\r\n\t\t\t\t(acc, _sentence, idx) => {\r\n\t\t\t\t\tacc[idx] = null;\r\n\t\t\t\t\treturn acc;\r\n\t\t\t\t},\r\n\t\t\t\t{} as typeof audioParts\r\n\t\t\t);\r\n\r\n\t\t\tlet lastPlayedAudioPromise = Promise.resolve(); // Initialize a promise that resolves immediately\r\n\r\n\t\t\tif ($settings.audio?.tts?.engine === 'browser-kokoro') {\r\n\t\t\t\tif (!$TTSWorker) {\r\n\t\t\t\t\tawait TTSWorker.set(\r\n\t\t\t\t\t\tnew KokoroWorker({\r\n\t\t\t\t\t\t\tdtype: $settings.audio?.tts?.engineConfig?.dtype ?? 'fp32'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tawait $TTSWorker.init();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (const [idx, sentence] of messageContentParts.entries()) {\r\n\t\t\t\t\tconst blob = await $TTSWorker\r\n\t\t\t\t\t\t.generate({\r\n\t\t\t\t\t\t\ttext: sentence,\r\n\t\t\t\t\t\t\tvoice: $settings?.audio?.tts?.voice ?? $config?.audio?.tts?.voice\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch((error) => {\r\n\t\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t\t\ttoast.error(`${error}`);\r\n\r\n\t\t\t\t\t\t\tspeaking = false;\r\n\t\t\t\t\t\t\tloadingSpeech = false;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (blob) {\r\n\t\t\t\t\t\tconst audio = new Audio(blob);\r\n\t\t\t\t\t\taudio.playbackRate = $settings.audio?.tts?.playbackRate ?? 1;\r\n\r\n\t\t\t\t\t\taudioParts[idx] = audio;\r\n\t\t\t\t\t\tloadingSpeech = false;\r\n\t\t\t\t\t\tlastPlayedAudioPromise = lastPlayedAudioPromise.then(() => playAudio(idx));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor (const [idx, sentence] of messageContentParts.entries()) {\r\n\t\t\t\t\tconst res = await synthesizeOpenAISpeech(\r\n\t\t\t\t\t\tlocalStorage.token,\r\n\t\t\t\t\t\t$settings?.audio?.tts?.defaultVoice === $config.audio.tts.voice\r\n\t\t\t\t\t\t\t? ($settings?.audio?.tts?.voice ?? $config?.audio?.tts?.voice)\r\n\t\t\t\t\t\t\t: $config?.audio?.tts?.voice,\r\n\t\t\t\t\t\tsentence\r\n\t\t\t\t\t).catch((error) => {\r\n\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t\ttoast.error(`${error}`);\r\n\r\n\t\t\t\t\t\tspeaking = false;\r\n\t\t\t\t\t\tloadingSpeech = false;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (res) {\r\n\t\t\t\t\t\tconst blob = await res.blob();\r\n\t\t\t\t\t\tconst blobUrl = URL.createObjectURL(blob);\r\n\t\t\t\t\t\tconst audio = new Audio(blobUrl);\r\n\t\t\t\t\t\taudio.playbackRate = $settings.audio?.tts?.playbackRate ?? 1;\r\n\r\n\t\t\t\t\t\taudioParts[idx] = audio;\r\n\t\t\t\t\t\tloadingSpeech = false;\r\n\t\t\t\t\t\tlastPlayedAudioPromise = lastPlayedAudioPromise.then(() => playAudio(idx));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst editMessageHandler = async () => {\r\n\t\tedit = true;\r\n\t\teditedContent = message.content;\r\n\r\n\t\tawait tick();\r\n\r\n\t\teditTextAreaElement.style.height = '';\r\n\t\teditTextAreaElement.style.height = `${editTextAreaElement.scrollHeight}px`;\r\n\t};\r\n\r\n\tconst editMessageConfirmHandler = async () => {\r\n\t\teditMessage(message.id, editedContent ? editedContent : '', false);\r\n\r\n\t\tedit = false;\r\n\t\teditedContent = '';\r\n\r\n\t\tawait tick();\r\n\t};\r\n\r\n\tconst saveAsCopyHandler = async () => {\r\n\t\teditMessage(message.id, editedContent ? editedContent : '');\r\n\r\n\t\tedit = false;\r\n\t\teditedContent = '';\r\n\r\n\t\tawait tick();\r\n\t};\r\n\r\n\tconst cancelEditMessage = async () => {\r\n\t\tedit = false;\r\n\t\teditedContent = '';\r\n\t\tawait tick();\r\n\t};\r\n\r\n\tconst generateImage = async (message: MessageType) => {\r\n\t\tgeneratingImage = true;\r\n\t\tconst res = await imageGenerations(localStorage.token, message.content).catch((error) => {\r\n\t\t\ttoast.error(`${error}`);\r\n\t\t});\r\n\t\tconsole.log(res);\r\n\r\n\t\tif (res) {\r\n\t\t\tconst files = res.map((image) => ({\r\n\t\t\t\ttype: 'image',\r\n\t\t\t\turl: `${image.url}`\r\n\t\t\t}));\r\n\r\n\t\t\tsaveMessage(message.id, {\r\n\t\t\t\t...message,\r\n\t\t\t\tfiles: files\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tgeneratingImage = false;\r\n\t};\r\n\r\n\tlet feedbackLoading = false;\r\n\r\n\tconst feedbackHandler = async (rating: number | null = null, details: object | null = null) => {\r\n\t\tfeedbackLoading = true;\r\n\t\tconsole.log('Feedback', rating, details);\r\n\r\n\t\tconst updatedMessage = {\r\n\t\t\t...message,\r\n\t\t\tannotation: {\r\n\t\t\t\t...(message?.annotation ?? {}),\r\n\t\t\t\t...(rating !== null ? { rating: rating } : {}),\r\n\t\t\t\t...(details ? details : {})\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst chat = await getChatById(localStorage.token, chatId).catch((error) => {\r\n\t\t\ttoast.error(`${error}`);\r\n\t\t});\r\n\t\tif (!chat) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst messages = createMessagesList(history, message.id);\r\n\r\n\t\tlet feedbackItem = {\r\n\t\t\ttype: 'rating',\r\n\t\t\tdata: {\r\n\t\t\t\t...(updatedMessage?.annotation ? updatedMessage.annotation : {}),\r\n\t\t\t\tmodel_id: message?.selectedModelId ?? message.model,\r\n\t\t\t\t...(history.messages[message.parentId].childrenIds.length > 1\r\n\t\t\t\t\t? {\r\n\t\t\t\t\t\t\tsibling_model_ids: history.messages[message.parentId].childrenIds\r\n\t\t\t\t\t\t\t\t.filter((id) => id !== message.id)\r\n\t\t\t\t\t\t\t\t.map((id) => history.messages[id]?.selectedModelId ?? history.messages[id].model)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t: {})\r\n\t\t\t},\r\n\t\t\tmeta: {\r\n\t\t\t\tarena: message ? message.arena : false,\r\n\t\t\t\tmodel_id: message.model,\r\n\t\t\t\tmessage_id: message.id,\r\n\t\t\t\tmessage_index: messages.length,\r\n\t\t\t\tchat_id: chatId\r\n\t\t\t},\r\n\t\t\tsnapshot: {\r\n\t\t\t\tchat: chat\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst baseModels = [\r\n\t\t\tfeedbackItem.data.model_id,\r\n\t\t\t...(feedbackItem.data.sibling_model_ids ?? [])\r\n\t\t].reduce((acc, modelId) => {\r\n\t\t\tconst model = $models.find((m) => m.id === modelId);\r\n\t\t\tif (model) {\r\n\t\t\t\tacc[model.id] = model?.info?.base_model_id ?? null;\r\n\t\t\t} else {\r\n\t\t\t\t// Log or handle cases where corresponding model is not found\r\n\t\t\t\tconsole.warn(`Model with ID ${modelId} not found`);\r\n\t\t\t}\r\n\t\t\treturn acc;\r\n\t\t}, {});\r\n\t\tfeedbackItem.meta.base_models = baseModels;\r\n\r\n\t\tlet feedback = null;\r\n\t\tif (message?.feedbackId) {\r\n\t\t\tfeedback = await updateFeedbackById(\r\n\t\t\t\tlocalStorage.token,\r\n\t\t\t\tmessage.feedbackId,\r\n\t\t\t\tfeedbackItem\r\n\t\t\t).catch((error) => {\r\n\t\t\t\ttoast.error(`${error}`);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tfeedback = await createNewFeedback(localStorage.token, feedbackItem).catch((error) => {\r\n\t\t\t\ttoast.error(`${error}`);\r\n\t\t\t});\r\n\r\n\t\t\tif (feedback) {\r\n\t\t\t\tupdatedMessage.feedbackId = feedback.id;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconsole.log(updatedMessage);\r\n\t\tsaveMessage(message.id, updatedMessage);\r\n\r\n\t\tawait tick();\r\n\r\n\t\tif (!details) {\r\n\t\t\tshowRateComment = true;\r\n\r\n\t\t\tif (!updatedMessage.annotation?.tags) {\r\n\t\t\t\t// attempt to generate tags\r\n\t\t\t\tconst tags = await generateTags(localStorage.token, message.model, messages, chatId).catch(\r\n\t\t\t\t\t(error) => {\r\n\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t\treturn [];\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t\tconsole.log(tags);\r\n\r\n\t\t\t\tif (tags) {\r\n\t\t\t\t\tupdatedMessage.annotation.tags = tags;\r\n\t\t\t\t\tfeedbackItem.data.tags = tags;\r\n\r\n\t\t\t\t\tsaveMessage(message.id, updatedMessage);\r\n\t\t\t\t\tawait updateFeedbackById(\r\n\t\t\t\t\t\tlocalStorage.token,\r\n\t\t\t\t\t\tupdatedMessage.feedbackId,\r\n\t\t\t\t\t\tfeedbackItem\r\n\t\t\t\t\t).catch((error) => {\r\n\t\t\t\t\t\ttoast.error(`${error}`);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfeedbackLoading = false;\r\n\t};\r\n\r\n\tconst deleteMessageHandler = async () => {\r\n\t\tdeleteMessage(message.id);\r\n\t};\r\n\r\n\t$: if (!edit) {\r\n\t\t(async () => {\r\n\t\t\tawait tick();\r\n\t\t})();\r\n\t}\r\n\r\n\tonMount(async () => {\r\n\t\t// console.log('ResponseMessage mounted');\r\n\r\n\t\tawait tick();\r\n\t});\r\n</script>\r\n\r\n<DeleteConfirmDialog\r\n\tbind:show={showDeleteConfirm}\r\n\ttitle={$i18n.t('Delete message?')}\r\n\ton:confirm={() => {\r\n\t\tdeleteMessageHandler();\r\n\t}}\r\n/>\r\n\r\n{#key message.id}\r\n\t<div\r\n\t\tclass=\" flex w-full message-{message.id}\"\r\n\t\tid=\"message-{message.id}\"\r\n\t\tdir={$settings.chatDirection}\r\n\t>\r\n\t\t<div class={`shrink-0 ${($settings?.chatDirection ?? 'LTR') === 'LTR' ? 'mr-3' : 'ml-3'}`}>\r\n\t\t\t<ProfileImage\r\n\t\t\t\tsrc={model?.info?.meta?.profile_image_url ??\r\n\t\t\t\t\t($i18n.language === 'dg-DG' ? `/doge.png` : `${WEBUI_BASE_URL}/static/favicon.png`)}\r\n\t\t\t\tclassName={'size-8'}\r\n\t\t\t/>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"flex-auto w-0 pl-1\">\r\n\t\t\t<Name>\r\n\t\t\t\t<Tooltip content={model?.name ?? message.model} placement=\"top-start\">\r\n\t\t\t\t\t<span class=\"line-clamp-1\">\r\n\t\t\t\t\t\t{model?.name ?? message.model}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t{#if message.timestamp}\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\" self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Tooltip content={dayjs(message.timestamp * 1000).format('LLLL')}>\r\n\t\t\t\t\t\t\t<span class=\"line-clamp-1\">{formatDate(message.timestamp * 1000)}</span>\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t</Name>\r\n\r\n\t\t\t<div>\r\n\t\t\t\t{#if message?.files && message.files?.filter((f) => f.type === 'image').length > 0}\r\n\t\t\t\t\t<div class=\"my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap\">\r\n\t\t\t\t\t\t{#each message.files as file}\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t{#if file.type === 'image'}\r\n\t\t\t\t\t\t\t\t\t<Image src={file.url} alt={message.content} />\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t<div class=\"chat-{message.role} w-full min-w-full markdown-prose\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t{#if (message?.statusHistory ?? [...(message?.status ? [message?.status] : [])]).length > 0}\r\n\t\t\t\t\t\t\t{@const status = (\r\n\t\t\t\t\t\t\t\tmessage?.statusHistory ?? [...(message?.status ? [message?.status] : [])]\r\n\t\t\t\t\t\t\t).at(-1)}\r\n\t\t\t\t\t\t\t{#if !status?.hidden}\r\n\t\t\t\t\t\t\t\t<div class=\"status-description flex items-center gap-2 py-0.5\">\r\n\t\t\t\t\t\t\t\t\t{#if status?.done === false}\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Spinner className=\"size-4\" />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t\t{#if status?.action === 'web_search' && status?.urls}\r\n\t\t\t\t\t\t\t\t\t\t<WebSearchResults {status}>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex flex-col justify-center -space-y-0.5\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{status?.done === false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'shimmer'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''} text-base line-clamp-1 text-wrap\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- $i18n.t(\"Generating search query\") -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- $i18n.t(\"No search query generated\") -->\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- $i18n.t('Searched {{count}} sites') -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{#if status?.description.includes('{{count}}')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t(status?.description, {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcount: status?.urls.length\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{:else if status?.description === 'No search query generated'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('No search query generated')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{:else if status?.description === 'Generating search query'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Generating search query')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{status?.description}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</WebSearchResults>\r\n\t\t\t\t\t\t\t\t\t{:else if status?.action === 'knowledge_search'}\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex flex-col justify-center -space-y-0.5\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{status?.done === false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'shimmer'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: ''} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t(`Searching Knowledge for \"{{searchQuery}}\"`, {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsearchQuery: status.query\r\n\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex flex-col justify-center -space-y-0.5\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{status?.done === false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'shimmer'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: ''} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- $i18n.t(`Searching \"{{searchQuery}}\"`) -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t{#if status?.description.includes('{{searchQuery}}')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t(status?.description, {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsearchQuery: status?.query\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{:else if status?.description === 'No search query generated'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('No search query generated')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{:else if status?.description === 'Generating search query'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Generating search query')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{status?.description}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t{#if edit === true}\r\n\t\t\t\t\t\t\t<div class=\"w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2\">\r\n\t\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\t\tid=\"message-edit-{message.id}\"\r\n\t\t\t\t\t\t\t\t\tbind:this={editTextAreaElement}\r\n\t\t\t\t\t\t\t\t\tclass=\" bg-transparent outline-hidden w-full resize-none\"\r\n\t\t\t\t\t\t\t\t\tbind:value={editedContent}\r\n\t\t\t\t\t\t\t\t\ton:input={(e) => {\r\n\t\t\t\t\t\t\t\t\t\te.target.style.height = '';\r\n\t\t\t\t\t\t\t\t\t\te.target.style.height = `${e.target.scrollHeight}px`;\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\ton:keydown={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\r\n\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById('close-edit-message-button')?.click();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst isCmdOrCtrlPressed = e.metaKey || e.ctrlKey;\r\n\t\t\t\t\t\t\t\t\t\tconst isEnterPressed = e.key === 'Enter';\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (isCmdOrCtrlPressed && isEnterPressed) {\r\n\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById('confirm-edit-message-button')?.click();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\" mt-2 mb-1 flex justify-between text-sm font-medium\">\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"save-new-message-button\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\" px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsaveAsCopyHandler();\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Save As Copy')}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"flex space-x-1.5\">\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"close-edit-message-button\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tcancelEditMessage();\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Cancel')}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"confirm-edit-message-button\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\" px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\teditMessageConfirmHandler();\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Save')}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<div class=\"w-full flex flex-col relative\" id=\"response-content-container\">\r\n\t\t\t\t\t\t\t\t{#if message.content === '' && !message.error}\r\n\t\t\t\t\t\t\t\t\t<Skeleton />\r\n\t\t\t\t\t\t\t\t{:else if message.content && message.error !== true}\r\n\t\t\t\t\t\t\t\t\t<!-- always show message contents even if there's an error -->\r\n\t\t\t\t\t\t\t\t\t<!-- unless message.error === true which is legacy error handling, where the error message is stored in message.content -->\r\n\t\t\t\t\t\t\t\t\t<ContentRenderer\r\n\t\t\t\t\t\t\t\t\t\tid={message.id}\r\n\t\t\t\t\t\t\t\t\t\t{history}\r\n\t\t\t\t\t\t\t\t\t\tcontent={message.content}\r\n\t\t\t\t\t\t\t\t\t\tsources={message.sources}\r\n\t\t\t\t\t\t\t\t\t\tfloatingButtons={message?.done}\r\n\t\t\t\t\t\t\t\t\t\tsave={!readOnly}\r\n\t\t\t\t\t\t\t\t\t\t{model}\r\n\t\t\t\t\t\t\t\t\t\tonTaskClick={async (e) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(e);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tonSourceClick={async (id, idx) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(id, idx);\r\n\t\t\t\t\t\t\t\t\t\t\tlet sourceButton = document.getElementById(`source-${message.id}-${idx}`);\r\n\t\t\t\t\t\t\t\t\t\t\tconst sourcesCollapsible = document.getElementById(`collapsible-sources`);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (sourceButton) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsourceButton.click();\r\n\t\t\t\t\t\t\t\t\t\t\t} else if (sourcesCollapsible) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t// Open sources collapsible so we can click the source button\r\n\t\t\t\t\t\t\t\t\t\t\t\tsourcesCollapsible\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.querySelector('div:first-child')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.dispatchEvent(new PointerEvent('pointerup', {}));\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t// Wait for next frame to ensure DOM updates\r\n\t\t\t\t\t\t\t\t\t\t\t\tawait new Promise((resolve) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trequestAnimationFrame(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trequestAnimationFrame(resolve);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t// Try clicking the source button again\r\n\t\t\t\t\t\t\t\t\t\t\t\tsourceButton = document.getElementById(`source-${message.id}-${idx}`);\r\n\t\t\t\t\t\t\t\t\t\t\t\tsourceButton && sourceButton.click();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tonAddMessages={({ modelId, parentId, messages }) => {\r\n\t\t\t\t\t\t\t\t\t\t\taddMessages({ modelId, parentId, messages });\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\ton:update={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconst { raw, oldContent, newContent } = e.detail;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\thistory.messages[message.id].content = history.messages[\r\n\t\t\t\t\t\t\t\t\t\t\t\tmessage.id\r\n\t\t\t\t\t\t\t\t\t\t\t].content.replace(raw, raw.replace(oldContent, newContent));\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tupdateChat();\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\ton:select={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconst { type, content } = e.detail;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (type === 'explain') {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsubmitMessage(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`Explain this section to me in more detail\\n\\n\\`\\`\\`\\n${content}\\n\\`\\`\\``\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t} else if (type === 'ask') {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst input = e.detail?.input ?? '';\r\n\t\t\t\t\t\t\t\t\t\t\t\tsubmitMessage(message.id, `\\`\\`\\`\\n${content}\\n\\`\\`\\`\\n${input}`);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t{#if message?.error}\r\n\t\t\t\t\t\t\t\t\t<Error content={message?.error?.content ?? message.content} />\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t{#if (message?.sources || message?.citations) && (model?.info?.meta?.capabilities?.citations ?? true)}\r\n\t\t\t\t\t\t\t\t\t<Citations id={message?.id} sources={message?.sources ?? message?.citations} />\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t{#if message.code_executions}\r\n\t\t\t\t\t\t\t\t\t<CodeExecutions codeExecutions={message.code_executions} />\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{#if !edit}\r\n\t\t\t\t\t{#if message.done || siblings.length > 1}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\" flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{#if siblings.length > 1}\r\n\t\t\t\t\t\t\t\t<div class=\"flex self-center min-w-fit\" dir=\"ltr\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tshowPreviousMessage(message);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.5\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"size-3.5\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M15.75 19.5 8.25 12l7.5-7.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tclass=\"text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{siblings.indexOf(message.id) + 1}/{siblings.length}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tshowNextMessage(message);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.5\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"size-3.5\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"m8.25 4.5 7.5 7.5-7.5 7.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t{#if message.done}\r\n\t\t\t\t\t\t\t\t{#if !readOnly}\r\n\t\t\t\t\t\t\t\t\t{#if $user.role === 'user' ? ($user?.permissions?.chat?.edit ?? true) : true}\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Edit')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\teditMessageHandler();\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Copy')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tcopyToClipboard(message.content);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Read Aloud')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tid=\"speak-button-{message.id}\"\r\n\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (!loadingSpeech) {\r\n\t\t\t\t\t\t\t\t\t\t\t\ttoggleSpeakMessage();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{#if loadingSpeech}\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\" w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<style>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.spinner_S1WN {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation: spinner_MGfb 0.8s linear infinite;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation-delay: -0.8s;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.spinner_Km9P {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation-delay: -0.65s;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.spinner_JApP {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation-delay: -0.5s;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t@keyframes spinner_MGfb {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t93.75%,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t100% {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topacity: 0.2;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</style>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<circle class=\"spinner_S1WN\" cx=\"4\" cy=\"12\" r=\"3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<circle class=\"spinner_S1WN spinner_Km9P\" cx=\"12\" cy=\"12\" r=\"3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<circle class=\"spinner_S1WN spinner_JApP\" cx=\"20\" cy=\"12\" r=\"3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t{:else if speaking}\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t\t\t\t\t{#if $config?.features.enable_image_generation && ($user.role === 'admin' || $user?.permissions?.features?.image_generation) && !readOnly}\r\n\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Generate Image')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'}  p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (!generatingImage) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tgenerateImage(message);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{#if generatingImage}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<style>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.spinner_S1WN {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation: spinner_MGfb 0.8s linear infinite;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation-delay: -0.8s;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.spinner_Km9P {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation-delay: -0.65s;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.spinner_JApP {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation-delay: -0.5s;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@keyframes spinner_MGfb {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t93.75%,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t100% {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topacity: 0.2;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</style>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<circle class=\"spinner_S1WN\" cx=\"4\" cy=\"12\" r=\"3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<circle class=\"spinner_S1WN spinner_Km9P\" cx=\"12\" cy=\"12\" r=\"3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<circle class=\"spinner_S1WN spinner_JApP\" cx=\"20\" cy=\"12\" r=\"3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t{#if message.usage}\r\n\t\t\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\t\t\tcontent={message.usage\r\n\t\t\t\t\t\t\t\t\t\t\t? `<pre>${sanitizeResponseContent(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tJSON.stringify(message.usage, null, 2)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.replace(/\"([^(\")\"]+)\":/g, '$1:')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.slice(1, -1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.split('\\n')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.map((line) => line.slice(2))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.map((line) => (line.endsWith(',') ? line.slice(0, -1) : line))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.join('\\n')\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}</pre>`\r\n\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t\t\t\t\t\tplacement=\"bottom\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\" {isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(message);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"info-{message.id}\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t{#if !readOnly}\r\n\t\t\t\t\t\t\t\t\t{#if !$temporaryChatEnabled && ($config?.features.enable_message_rating ?? true)}\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Good Response')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg {(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage?.annotation?.rating ?? ''\r\n\t\t\t\t\t\t\t\t\t\t\t\t).toString() === '1'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-800'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: ''} dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={feedbackLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tawait feedbackHandler(1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdocument\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.getElementById(`message-feedback-${message.id}`)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t?.scrollIntoView();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}, 0);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Bad Response')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg {(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage?.annotation?.rating ?? ''\r\n\t\t\t\t\t\t\t\t\t\t\t\t).toString() === '-1'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-800'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: ''} dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={feedbackLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tawait feedbackHandler(-1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdocument\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.getElementById(`message-feedback-${message.id}`)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t?.scrollIntoView();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}, 0);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t\t{#if isLastMessage}\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Continue Response')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"continue-response-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontinueResponse();\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Regenerate')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowRateComment = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\tregenerateResponse(message);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t(model?.actions ?? []).forEach((action) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdispatch('action', {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid: action.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tevent: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid: 'regenerate-response',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmessageId: message.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t\t\t\t\t\t{#if siblings.length > 1}\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Delete')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"continue-response-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowDeleteConfirm = true;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t\t{#if isLastMessage}\r\n\t\t\t\t\t\t\t\t\t\t{#each model?.actions ?? [] as action}\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={action.name} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tactionMessage(action.id, message);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{#if action.icon_url}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"size-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={action.icon_url}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4 {action.icon_url.includes('svg')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'dark:invert-[80%]'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"fill: currentColor;\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={action.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Sparkles strokeWidth=\"2.1\" className=\"size-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t{#if message.done && showRateComment}\r\n\t\t\t\t\t\t<RateComment\r\n\t\t\t\t\t\t\tbind:message\r\n\t\t\t\t\t\t\tbind:show={showRateComment}\r\n\t\t\t\t\t\t\ton:save={async (e) => {\r\n\t\t\t\t\t\t\t\tawait feedbackHandler(null, {\r\n\t\t\t\t\t\t\t\t\t...e.detail\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n{/key}\r\n\r\n<style>\r\n\t.buttons::-webkit-scrollbar {\r\n\t\tdisplay: none; /* for Chrome, Safari and Opera */\r\n\t}\r\n\r\n\t.buttons {\r\n\t\t-ms-overflow-style: none; /* IE and Edge */\r\n\t\tscrollbar-width: none; /* Firefox */\r\n\t}\r\n</style>\r\n","<script lang=\"ts\">\r\n\texport let className = 'w-4 h-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport dayjs from 'dayjs';\r\n\timport { onMount, tick, getContext } from 'svelte';\r\n\timport { createEventDispatcher } from 'svelte';\r\n\r\n\timport { mobile, settings } from '$lib/stores';\r\n\r\n\timport { generateMoACompletion } from '$lib/apis';\r\n\timport { updateChatById } from '$lib/apis/chats';\r\n\timport { createOpenAITextStream } from '$lib/apis/streaming';\r\n\r\n\timport ResponseMessage from './ResponseMessage.svelte';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport Merge from '$lib/components/icons/Merge.svelte';\r\n\r\n\timport Markdown from './Markdown.svelte';\r\n\timport Name from './Name.svelte';\r\n\timport Skeleton from './Skeleton.svelte';\r\n\timport localizedFormat from 'dayjs/plugin/localizedFormat';\r\n\tconst i18n = getContext('i18n');\r\n\tdayjs.extend(localizedFormat);\r\n\r\n\texport let chatId;\r\n\texport let history;\r\n\texport let messageId;\r\n\r\n\texport let isLastMessage;\r\n\texport let readOnly = false;\r\n\r\n\texport let updateChat: Function;\r\n\texport let editMessage: Function;\r\n\texport let saveMessage: Function;\r\n\texport let rateMessage: Function;\r\n\texport let actionMessage: Function;\r\n\r\n\texport let submitMessage: Function;\r\n\texport let deleteMessage: Function;\r\n\r\n\texport let continueResponse: Function;\r\n\texport let regenerateResponse: Function;\r\n\texport let mergeResponses: Function;\r\n\r\n\texport let addMessages: Function;\r\n\r\n\texport let triggerScroll: Function;\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\tlet currentMessageId;\r\n\tlet parentMessage;\r\n\tlet groupedMessageIds = {};\r\n\tlet groupedMessageIdsIdx = {};\r\n\r\n\tlet message = JSON.parse(JSON.stringify(history.messages[messageId]));\r\n\t$: if (history.messages) {\r\n\t\tif (JSON.stringify(message) !== JSON.stringify(history.messages[messageId])) {\r\n\t\t\tmessage = JSON.parse(JSON.stringify(history.messages[messageId]));\r\n\t\t}\r\n\t}\r\n\r\n\tconst showPreviousMessage = async (modelIdx) => {\r\n\t\tgroupedMessageIdsIdx[modelIdx] = Math.max(0, groupedMessageIdsIdx[modelIdx] - 1);\r\n\r\n\t\tlet messageId = groupedMessageIds[modelIdx].messageIds[groupedMessageIdsIdx[modelIdx]];\r\n\t\tconsole.log(messageId);\r\n\r\n\t\tlet messageChildrenIds = history.messages[messageId].childrenIds;\r\n\r\n\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\tmessageId = messageChildrenIds.at(-1);\r\n\t\t\tmessageChildrenIds = history.messages[messageId].childrenIds;\r\n\t\t}\r\n\r\n\t\thistory.currentId = messageId;\r\n\r\n\t\tawait tick();\r\n\t\tawait updateChat();\r\n\t\ttriggerScroll();\r\n\t};\r\n\r\n\tconst showNextMessage = async (modelIdx) => {\r\n\t\tgroupedMessageIdsIdx[modelIdx] = Math.min(\r\n\t\t\tgroupedMessageIds[modelIdx].messageIds.length - 1,\r\n\t\t\tgroupedMessageIdsIdx[modelIdx] + 1\r\n\t\t);\r\n\r\n\t\tlet messageId = groupedMessageIds[modelIdx].messageIds[groupedMessageIdsIdx[modelIdx]];\r\n\t\tconsole.log(messageId);\r\n\r\n\t\tlet messageChildrenIds = history.messages[messageId].childrenIds;\r\n\r\n\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\tmessageId = messageChildrenIds.at(-1);\r\n\t\t\tmessageChildrenIds = history.messages[messageId].childrenIds;\r\n\t\t}\r\n\r\n\t\thistory.currentId = messageId;\r\n\r\n\t\tawait tick();\r\n\t\tawait updateChat();\r\n\t\ttriggerScroll();\r\n\t};\r\n\r\n\tconst initHandler = async () => {\r\n\t\tconsole.log('multiresponse:initHandler');\r\n\t\tawait tick();\r\n\r\n\t\tcurrentMessageId = messageId;\r\n\t\tparentMessage = history.messages[messageId].parentId\r\n\t\t\t? history.messages[history.messages[messageId].parentId]\r\n\t\t\t: null;\r\n\r\n\t\tgroupedMessageIds = parentMessage?.models.reduce((a, model, modelIdx) => {\r\n\t\t\t// Find all messages that are children of the parent message and have the same model\r\n\t\t\tlet modelMessageIds = parentMessage?.childrenIds\r\n\t\t\t\t.map((id) => history.messages[id])\r\n\t\t\t\t.filter((m) => m?.modelIdx === modelIdx)\r\n\t\t\t\t.map((m) => m.id);\r\n\r\n\t\t\t// Legacy support for messages that don't have a modelIdx\r\n\t\t\t// Find all messages that are children of the parent message and have the same model\r\n\t\t\tif (modelMessageIds.length === 0) {\r\n\t\t\t\tlet modelMessages = parentMessage?.childrenIds\r\n\t\t\t\t\t.map((id) => history.messages[id])\r\n\t\t\t\t\t.filter((m) => m?.model === model);\r\n\r\n\t\t\t\tmodelMessages.forEach((m) => {\r\n\t\t\t\t\tm.modelIdx = modelIdx;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tmodelMessageIds = modelMessages.map((m) => m.id);\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\t...a,\r\n\t\t\t\t[modelIdx]: { messageIds: modelMessageIds }\r\n\t\t\t};\r\n\t\t}, {});\r\n\r\n\t\tgroupedMessageIdsIdx = parentMessage?.models.reduce((a, model, modelIdx) => {\r\n\t\t\tconst idx = groupedMessageIds[modelIdx].messageIds.findIndex((id) => id === messageId);\r\n\t\t\tif (idx !== -1) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...a,\r\n\t\t\t\t\t[modelIdx]: idx\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...a,\r\n\t\t\t\t\t[modelIdx]: groupedMessageIds[modelIdx].messageIds.length - 1\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}, {});\r\n\r\n\t\tconsole.log(groupedMessageIds, groupedMessageIdsIdx);\r\n\r\n\t\tawait tick();\r\n\t};\r\n\r\n\tconst mergeResponsesHandler = async () => {\r\n\t\tconst responses = Object.keys(groupedMessageIds).map((modelIdx) => {\r\n\t\t\tconst { messageIds } = groupedMessageIds[modelIdx];\r\n\t\t\tconst messageId = messageIds[groupedMessageIdsIdx[modelIdx]];\r\n\r\n\t\t\treturn history.messages[messageId].content;\r\n\t\t});\r\n\t\tmergeResponses(messageId, responses, chatId);\r\n\t};\r\n\r\n\tonMount(async () => {\r\n\t\tawait initHandler();\r\n\t\tawait tick();\r\n\r\n\t\tconst messageElement = document.getElementById(`message-${messageId}`);\r\n\t\tif (messageElement) {\r\n\t\t\tmessageElement.scrollIntoView({ block: 'start' });\r\n\t\t}\r\n\t});\r\n</script>\r\n\r\n{#if parentMessage}\r\n\t<div>\r\n\t\t<div\r\n\t\t\tclass=\"flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden\"\r\n\t\t\tid=\"responses-container-{chatId}-{parentMessage.id}\"\r\n\t\t>\r\n\t\t\t{#each Object.keys(groupedMessageIds) as modelIdx}\r\n\t\t\t\t{#if groupedMessageIdsIdx[modelIdx] !== undefined && groupedMessageIds[modelIdx].messageIds.length > 0}\r\n\t\t\t\t\t<!-- svelte-ignore a11y-no-static-element-interactions -->\r\n\t\t\t\t\t<!-- svelte-ignore a11y-click-events-have-key-events -->\r\n\t\t\t\t\t{@const _messageId =\r\n\t\t\t\t\t\tgroupedMessageIds[modelIdx].messageIds[groupedMessageIdsIdx[modelIdx]]}\r\n\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\" snap-center w-full max-w-full m-1 border {history.messages[messageId]\r\n\t\t\t\t\t\t\t?.modelIdx == modelIdx\r\n\t\t\t\t\t\t\t? `border-gray-100 dark:border-gray-850 border-[1.5px] ${\r\n\t\t\t\t\t\t\t\t\t$mobile ? 'min-w-full' : 'min-w-80'\r\n\t\t\t\t\t\t\t\t}`\r\n\t\t\t\t\t\t\t: `border-gray-100 dark:border-gray-850 border-dashed ${\r\n\t\t\t\t\t\t\t\t\t$mobile ? 'min-w-full' : 'min-w-80'\r\n\t\t\t\t\t\t\t\t}`} transition-all p-5 rounded-2xl\"\r\n\t\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\t\tif (messageId != _messageId) {\r\n\t\t\t\t\t\t\t\tlet currentMessageId = _messageId;\r\n\t\t\t\t\t\t\t\tlet messageChildrenIds = history.messages[currentMessageId].childrenIds;\r\n\t\t\t\t\t\t\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\t\t\t\t\t\t\tcurrentMessageId = messageChildrenIds.at(-1);\r\n\t\t\t\t\t\t\t\t\tmessageChildrenIds = history.messages[currentMessageId].childrenIds;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\thistory.currentId = currentMessageId;\r\n\r\n\t\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t\t\tawait updateChat();\r\n\t\t\t\t\t\t\t\ttriggerScroll();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#key history.currentId}\r\n\t\t\t\t\t\t\t{#if message}\r\n\t\t\t\t\t\t\t\t<ResponseMessage\r\n\t\t\t\t\t\t\t\t\t{chatId}\r\n\t\t\t\t\t\t\t\t\t{history}\r\n\t\t\t\t\t\t\t\t\tmessageId={_messageId}\r\n\t\t\t\t\t\t\t\t\tisLastMessage={true}\r\n\t\t\t\t\t\t\t\t\tsiblings={groupedMessageIds[modelIdx].messageIds}\r\n\t\t\t\t\t\t\t\t\tshowPreviousMessage={() => showPreviousMessage(modelIdx)}\r\n\t\t\t\t\t\t\t\t\tshowNextMessage={() => showNextMessage(modelIdx)}\r\n\t\t\t\t\t\t\t\t\t{updateChat}\r\n\t\t\t\t\t\t\t\t\t{editMessage}\r\n\t\t\t\t\t\t\t\t\t{saveMessage}\r\n\t\t\t\t\t\t\t\t\t{rateMessage}\r\n\t\t\t\t\t\t\t\t\t{deleteMessage}\r\n\t\t\t\t\t\t\t\t\t{actionMessage}\r\n\t\t\t\t\t\t\t\t\t{submitMessage}\r\n\t\t\t\t\t\t\t\t\t{continueResponse}\r\n\t\t\t\t\t\t\t\t\tregenerateResponse={async (message) => {\r\n\t\t\t\t\t\t\t\t\t\tregenerateResponse(message);\r\n\t\t\t\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t\t\t\t\tgroupedMessageIdsIdx[modelIdx] =\r\n\t\t\t\t\t\t\t\t\t\t\tgroupedMessageIds[modelIdx].messageIds.length - 1;\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t{addMessages}\r\n\t\t\t\t\t\t\t\t\t{readOnly}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t{/key}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\r\n\t\t{#if !readOnly}\r\n\t\t\t{#if !Object.keys(groupedMessageIds).find((modelIdx) => {\r\n\t\t\t\tconst { messageIds } = groupedMessageIds[modelIdx];\r\n\t\t\t\tconst _messageId = messageIds[groupedMessageIdsIdx[modelIdx]];\r\n\t\t\t\treturn !history.messages[_messageId]?.done ?? false;\r\n\t\t\t})}\r\n\t\t\t\t<div class=\"flex justify-end\">\r\n\t\t\t\t\t<div class=\"w-full\">\r\n\t\t\t\t\t\t{#if history.messages[messageId]?.merged?.status}\r\n\t\t\t\t\t\t\t{@const message = history.messages[messageId]?.merged}\r\n\r\n\t\t\t\t\t\t\t<div class=\"w-full rounded-xl pl-5 pr-2 py-2\">\r\n\t\t\t\t\t\t\t\t<Name>\r\n\t\t\t\t\t\t\t\t\tMerged Response\r\n\r\n\t\t\t\t\t\t\t\t\t{#if message.timestamp}\r\n\t\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\" self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{dayjs(message.timestamp * 1000).format('LT')}\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t</Name>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"mt-1 markdown-prose w-full min-w-full\">\r\n\t\t\t\t\t\t\t\t\t{#if (message?.content ?? '') === ''}\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton />\r\n\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t<Markdown id={`merged`} content={message.content ?? ''} />\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if isLastMessage}\r\n\t\t\t\t\t\t<div class=\" shrink-0 text-gray-600 dark:text-gray-500 mt-1\">\r\n\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Merge Responses')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\tid=\"merge-response-button\"\r\n\t\t\t\t\t\t\t\t\tclass=\"{true\r\n\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\tmergeResponsesHandler();\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Merge className=\" size-5 \" />\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\t\t{/if}\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport dayjs from 'dayjs';\r\n\timport { toast } from 'svelte-sonner';\r\n\timport { tick, getContext, onMount } from 'svelte';\r\n\r\n\timport { models, settings } from '$lib/stores';\r\n\timport { user as _user } from '$lib/stores';\r\n\timport { copyToClipboard as _copyToClipboard, formatDate } from '$lib/utils';\r\n\r\n\timport Name from './Name.svelte';\r\n\timport ProfileImage from './ProfileImage.svelte';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport FileItem from '$lib/components/common/FileItem.svelte';\r\n\timport Markdown from './Markdown.svelte';\r\n\timport Image from '$lib/components/common/Image.svelte';\r\n\timport DeleteConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\r\n\r\n\timport localizedFormat from 'dayjs/plugin/localizedFormat';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\tdayjs.extend(localizedFormat);\r\n\r\n\texport let user;\r\n\r\n\texport let history;\r\n\texport let messageId;\r\n\r\n\texport let siblings;\r\n\r\n\texport let showPreviousMessage: Function;\r\n\texport let showNextMessage: Function;\r\n\r\n\texport let editMessage: Function;\r\n\texport let deleteMessage: Function;\r\n\r\n\texport let isFirstMessage: boolean;\r\n\texport let readOnly: boolean;\r\n\r\n\tlet showDeleteConfirm = false;\r\n\r\n\tlet edit = false;\r\n\tlet editedContent = '';\r\n\tlet messageEditTextAreaElement: HTMLTextAreaElement;\r\n\r\n\tlet message = JSON.parse(JSON.stringify(history.messages[messageId]));\r\n\t$: if (history.messages) {\r\n\t\tif (JSON.stringify(message) !== JSON.stringify(history.messages[messageId])) {\r\n\t\t\tmessage = JSON.parse(JSON.stringify(history.messages[messageId]));\r\n\t\t}\r\n\t}\r\n\r\n\tconst copyToClipboard = async (text) => {\r\n\t\tconst res = await _copyToClipboard(text);\r\n\t\tif (res) {\r\n\t\t\ttoast.success($i18n.t('Copying to clipboard was successful!'));\r\n\t\t}\r\n\t};\r\n\r\n\tconst editMessageHandler = async () => {\r\n\t\tedit = true;\r\n\t\teditedContent = message.content;\r\n\r\n\t\tawait tick();\r\n\r\n\t\tmessageEditTextAreaElement.style.height = '';\r\n\t\tmessageEditTextAreaElement.style.height = `${messageEditTextAreaElement.scrollHeight}px`;\r\n\r\n\t\tmessageEditTextAreaElement?.focus();\r\n\t};\r\n\r\n\tconst editMessageConfirmHandler = async (submit = true) => {\r\n\t\teditMessage(message.id, editedContent, submit);\r\n\r\n\t\tedit = false;\r\n\t\teditedContent = '';\r\n\t};\r\n\r\n\tconst cancelEditMessage = () => {\r\n\t\tedit = false;\r\n\t\teditedContent = '';\r\n\t};\r\n\r\n\tconst deleteMessageHandler = async () => {\r\n\t\tdeleteMessage(message.id);\r\n\t};\r\n\r\n\tonMount(() => {\r\n\t\t// console.log('UserMessage mounted');\r\n\t});\r\n</script>\r\n\r\n<DeleteConfirmDialog\r\n\tbind:show={showDeleteConfirm}\r\n\ttitle={$i18n.t('Delete message?')}\r\n\ton:confirm={() => {\r\n\t\tdeleteMessageHandler();\r\n\t}}\r\n/>\r\n\r\n<div class=\" flex w-full user-message\" dir={$settings.chatDirection} id=\"message-{message.id}\">\r\n\t{#if !($settings?.chatBubble ?? true)}\r\n\t\t<div class={`shrink-0 ${($settings?.chatDirection ?? 'LTR') === 'LTR' ? 'mr-3' : 'ml-3'}`}>\r\n\t\t\t<ProfileImage\r\n\t\t\t\tsrc={message.user\r\n\t\t\t\t\t? ($models.find((m) => m.id === message.user)?.info?.meta?.profile_image_url ??\r\n\t\t\t\t\t\t'/user.png')\r\n\t\t\t\t\t: (user?.profile_image_url ?? '/user.png')}\r\n\t\t\t\tclassName={'size-8'}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t{/if}\r\n\t<div class=\"flex-auto w-0 max-w-full pl-1\">\r\n\t\t{#if !($settings?.chatBubble ?? true)}\r\n\t\t\t<div>\r\n\t\t\t\t<Name>\r\n\t\t\t\t\t{#if message.user}\r\n\t\t\t\t\t\t{$i18n.t('You')}\r\n\t\t\t\t\t\t<span class=\" text-gray-500 text-sm font-medium\">{message?.user ?? ''}</span>\r\n\t\t\t\t\t{:else if $settings.showUsername || $_user.name !== user.name}\r\n\t\t\t\t\t\t{user.name}\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t{$i18n.t('You')}\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t{#if message.timestamp}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\" self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Tooltip content={dayjs(message.timestamp * 1000).format('LLLL')}>\r\n\t\t\t\t\t\t\t\t<span class=\"line-clamp-1\">{formatDate(message.timestamp * 1000)}</span>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</Name>\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\r\n\t\t<div class=\"chat-{message.role} w-full min-w-full markdown-prose\">\r\n\t\t\t{#if message.files}\r\n\t\t\t\t<div class=\"mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap\">\r\n\t\t\t\t\t{#each message.files as file}\r\n\t\t\t\t\t\t<div class={($settings?.chatBubble ?? true) ? 'self-end' : ''}>\r\n\t\t\t\t\t\t\t{#if file.type === 'image'}\r\n\t\t\t\t\t\t\t\t<Image src={file.url} imageClassName=\" max-h-96 rounded-lg\" />\r\n\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t<FileItem\r\n\t\t\t\t\t\t\t\t\titem={file}\r\n\t\t\t\t\t\t\t\t\turl={file.url}\r\n\t\t\t\t\t\t\t\t\tname={file.name}\r\n\t\t\t\t\t\t\t\t\ttype={file.type}\r\n\t\t\t\t\t\t\t\t\tsize={file?.size}\r\n\t\t\t\t\t\t\t\t\tcolorClassName=\"bg-white dark:bg-gray-850 \"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\r\n\t\t\t{#if message.content !== ''}\r\n\t\t\t\t{#if edit === true}\r\n\t\t\t\t\t<div class=\" w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2\">\r\n\t\t\t\t\t\t<div class=\"max-h-96 overflow-auto\">\r\n\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\tid=\"message-edit-{message.id}\"\r\n\t\t\t\t\t\t\t\tbind:this={messageEditTextAreaElement}\r\n\t\t\t\t\t\t\t\tclass=\" bg-transparent outline-hidden w-full resize-none\"\r\n\t\t\t\t\t\t\t\tbind:value={editedContent}\r\n\t\t\t\t\t\t\t\ton:input={(e) => {\r\n\t\t\t\t\t\t\t\t\te.target.style.height = '';\r\n\t\t\t\t\t\t\t\t\te.target.style.height = `${e.target.scrollHeight}px`;\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\ton:keydown={(e) => {\r\n\t\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\r\n\t\t\t\t\t\t\t\t\t\tdocument.getElementById('close-edit-message-button')?.click();\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tconst isCmdOrCtrlPressed = e.metaKey || e.ctrlKey;\r\n\t\t\t\t\t\t\t\t\tconst isEnterPressed = e.key === 'Enter';\r\n\r\n\t\t\t\t\t\t\t\t\tif (isCmdOrCtrlPressed && isEnterPressed) {\r\n\t\t\t\t\t\t\t\t\t\tdocument.getElementById('confirm-edit-message-button')?.click();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\" mt-2 mb-1 flex justify-between text-sm font-medium\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tid=\"save-edit-message-button\"\r\n\t\t\t\t\t\t\t\t\tclass=\" px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\teditMessageConfirmHandler(false);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{$i18n.t('Save')}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"flex space-x-1.5\">\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tid=\"close-edit-message-button\"\r\n\t\t\t\t\t\t\t\t\tclass=\"px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\tcancelEditMessage();\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{$i18n.t('Cancel')}\r\n\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tid=\"confirm-edit-message-button\"\r\n\t\t\t\t\t\t\t\t\tclass=\" px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\teditMessageConfirmHandler();\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{$i18n.t('Send')}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<div class=\"w-full\">\r\n\t\t\t\t\t\t<div class=\"flex {($settings?.chatBubble ?? true) ? 'justify-end pb-1' : 'w-full'}\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\"rounded-3xl {($settings?.chatBubble ?? true)\r\n\t\t\t\t\t\t\t\t\t? `max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${\r\n\t\t\t\t\t\t\t\t\t\t\tmessage.files ? 'rounded-tr-lg' : ''\r\n\t\t\t\t\t\t\t\t\t\t}`\r\n\t\t\t\t\t\t\t\t\t: ' w-full'}\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{#if message.content}\r\n\t\t\t\t\t\t\t\t\t<Markdown id={message.id} content={message.content} />\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\" flex {($settings?.chatBubble ?? true)\r\n\t\t\t\t\t\t\t\t? 'justify-end'\r\n\t\t\t\t\t\t\t\t: ''}  text-gray-600 dark:text-gray-500\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{#if !($settings?.chatBubble ?? true)}\r\n\t\t\t\t\t\t\t\t{#if siblings.length > 1}\r\n\t\t\t\t\t\t\t\t\t<div class=\"flex self-center\" dir=\"ltr\">\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowPreviousMessage(message);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-3.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M15.75 19.5 8.25 12l7.5-7.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"text-sm tracking-widest font-semibold self-center dark:text-gray-100\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{siblings.indexOf(message.id) + 1}/{siblings.length}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowNextMessage(message);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-3.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"m8.25 4.5 7.5 7.5-7.5 7.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{#if !readOnly}\r\n\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Edit')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\teditMessageHandler();\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Copy')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tclass=\"invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\tcopyToClipboard(message.content);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\td=\"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t\t\t\t{#if !isFirstMessage && !readOnly}\r\n\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Delete')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tshowDeleteConfirm = true;\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t{#if $settings?.chatBubble ?? true}\r\n\t\t\t\t\t\t\t\t{#if siblings.length > 1}\r\n\t\t\t\t\t\t\t\t\t<div class=\"flex self-center\" dir=\"ltr\">\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowPreviousMessage(message);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-3.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M15.75 19.5 8.25 12l7.5-7.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"text-sm tracking-widest font-semibold self-center dark:text-gray-100\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{siblings.indexOf(message.id) + 1}/{siblings.length}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowNextMessage(message);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-3.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"m8.25 4.5 7.5 7.5-7.5 7.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\timport { tick, getContext, onMount, createEventDispatcher } from 'svelte';\r\n\tconst dispatch = createEventDispatcher();\r\n\tconst i18n = getContext('i18n');\r\n\r\n\timport { settings } from '$lib/stores';\r\n\timport { copyToClipboard } from '$lib/utils';\r\n\r\n\timport MultiResponseMessages from './MultiResponseMessages.svelte';\r\n\timport ResponseMessage from './ResponseMessage.svelte';\r\n\timport UserMessage from './UserMessage.svelte';\r\n\r\n\texport let chatId;\r\n\texport let idx = 0;\r\n\r\n\texport let history;\r\n\texport let messageId;\r\n\r\n\texport let user;\r\n\r\n\texport let showPreviousMessage;\r\n\texport let showNextMessage;\r\n\texport let updateChat;\r\n\r\n\texport let editMessage;\r\n\texport let saveMessage;\r\n\texport let deleteMessage;\r\n\texport let rateMessage;\r\n\texport let actionMessage;\r\n\texport let submitMessage;\r\n\r\n\texport let regenerateResponse;\r\n\texport let continueResponse;\r\n\texport let mergeResponses;\r\n\r\n\texport let addMessages;\r\n\texport let triggerScroll;\r\n\texport let readOnly = false;\r\n</script>\r\n\r\n<div\r\n\tclass=\"flex flex-col justify-between px-5 mb-3 w-full {($settings?.widescreenMode ?? null)\r\n\t\t? 'max-w-full'\r\n\t\t: 'max-w-5xl'} mx-auto rounded-lg group\"\r\n>\r\n\t{#if history.messages[messageId]}\r\n\t\t{#if history.messages[messageId].role === 'user'}\r\n\t\t\t<UserMessage\r\n\t\t\t\t{user}\r\n\t\t\t\t{history}\r\n\t\t\t\t{messageId}\r\n\t\t\t\tisFirstMessage={idx === 0}\r\n\t\t\t\tsiblings={history.messages[messageId].parentId !== null\r\n\t\t\t\t\t? (history.messages[history.messages[messageId].parentId]?.childrenIds ?? [])\r\n\t\t\t\t\t: (Object.values(history.messages)\r\n\t\t\t\t\t\t\t.filter((message) => message.parentId === null)\r\n\t\t\t\t\t\t\t.map((message) => message.id) ?? [])}\r\n\t\t\t\t{showPreviousMessage}\r\n\t\t\t\t{showNextMessage}\r\n\t\t\t\t{editMessage}\r\n\t\t\t\t{deleteMessage}\r\n\t\t\t\t{readOnly}\r\n\t\t\t/>\r\n\t\t{:else if (history.messages[history.messages[messageId].parentId]?.models?.length ?? 1) === 1}\r\n\t\t\t<ResponseMessage\r\n\t\t\t\t{chatId}\r\n\t\t\t\t{history}\r\n\t\t\t\t{messageId}\r\n\t\t\t\tisLastMessage={messageId === history.currentId}\r\n\t\t\t\tsiblings={history.messages[history.messages[messageId].parentId]?.childrenIds ?? []}\r\n\t\t\t\t{showPreviousMessage}\r\n\t\t\t\t{showNextMessage}\r\n\t\t\t\t{updateChat}\r\n\t\t\t\t{editMessage}\r\n\t\t\t\t{saveMessage}\r\n\t\t\t\t{rateMessage}\r\n\t\t\t\t{actionMessage}\r\n\t\t\t\t{submitMessage}\r\n\t\t\t\t{deleteMessage}\r\n\t\t\t\t{continueResponse}\r\n\t\t\t\t{regenerateResponse}\r\n\t\t\t\t{addMessages}\r\n\t\t\t\t{readOnly}\r\n\t\t\t/>\r\n\t\t{:else}\r\n\t\t\t<MultiResponseMessages\r\n\t\t\t\tbind:history\r\n\t\t\t\t{chatId}\r\n\t\t\t\t{messageId}\r\n\t\t\t\tisLastMessage={messageId === history?.currentId}\r\n\t\t\t\t{updateChat}\r\n\t\t\t\t{editMessage}\r\n\t\t\t\t{saveMessage}\r\n\t\t\t\t{rateMessage}\r\n\t\t\t\t{actionMessage}\r\n\t\t\t\t{submitMessage}\r\n\t\t\t\t{deleteMessage}\r\n\t\t\t\t{continueResponse}\r\n\t\t\t\t{regenerateResponse}\r\n\t\t\t\t{mergeResponses}\r\n\t\t\t\t{triggerScroll}\r\n\t\t\t\t{addMessages}\r\n\t\t\t\t{readOnly}\r\n\t\t\t/>\r\n\t\t{/if}\r\n\t{/if}\r\n</div>\r\n","<script lang=\"ts\">\r\n\texport let className = 'size-3';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport Fuse from 'fuse.js';\r\n\timport Bolt from '$lib/components/icons/Bolt.svelte';\r\n\timport { onMount, getContext, createEventDispatcher } from 'svelte';\r\n\timport { WEBUI_NAME } from '$lib/stores';\r\n\timport { WEBUI_VERSION } from '$lib/constants';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\texport let suggestionPrompts = [];\r\n\texport let className = '';\r\n\texport let inputValue = '';\r\n\r\n\tlet sortedPrompts = [];\r\n\r\n\tconst fuseOptions = {\r\n\t\tkeys: ['content', 'title'],\r\n\t\tthreshold: 0.5\r\n\t};\r\n\r\n\tlet fuse;\r\n\tlet filteredPrompts = [];\r\n\r\n\t// Initialize Fuse\r\n\t$: fuse = new Fuse(sortedPrompts, fuseOptions);\r\n\r\n\t// Update the filteredPrompts if inputValue changes\r\n\t// Only increase version if something wirklich gendert hat\r\n\t$: getFilteredPrompts(inputValue);\r\n\r\n\t// Helper function to check if arrays are the same\r\n\t// (based on unique IDs oder content)\r\n\tfunction arraysEqual(a, b) {\r\n\t\tif (a.length !== b.length) return false;\r\n\t\tfor (let i = 0; i < a.length; i++) {\r\n\t\t\tif ((a[i].id ?? a[i].content) !== (b[i].id ?? b[i].content)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tconst getFilteredPrompts = (inputValue) => {\r\n\t\tif (inputValue.length > 500) {\r\n\t\t\tfilteredPrompts = [];\r\n\t\t} else {\r\n\t\t\tconst newFilteredPrompts = inputValue.trim()\r\n\t\t\t\t? fuse.search(inputValue.trim()).map((result) => result.item)\r\n\t\t\t\t: sortedPrompts;\r\n\r\n\t\t\t// Compare with the oldFilteredPrompts\r\n\t\t\t// If there's a difference, update array + version\r\n\t\t\tif (!arraysEqual(filteredPrompts, newFilteredPrompts)) {\r\n\t\t\t\tfilteredPrompts = newFilteredPrompts;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t$: if (suggestionPrompts) {\r\n\t\tsortedPrompts = [...(suggestionPrompts ?? [])].sort(() => Math.random() - 0.5);\r\n\t\tgetFilteredPrompts(inputValue);\r\n\t}\r\n</script>\r\n\r\n<div class=\"mb-1 flex gap-1 text-xs font-medium items-center text-gray-400 dark:text-gray-600\">\r\n\t{#if filteredPrompts.length > 0}\r\n\t\t<Bolt />\r\n\t\t{$i18n.t('Suggested')}\r\n\t{:else}\r\n\t\t<!-- Keine Vorschlge -->\r\n\r\n\t\t<div\r\n\t\t\tclass=\"flex w-full text-center items-center justify-center self-start text-gray-400 dark:text-gray-600\"\r\n\t\t>\r\n\t\t\t{$WEBUI_NAME}  v{WEBUI_VERSION}\r\n\t\t</div>\r\n\t{/if}\r\n</div>\r\n\r\n<div class=\"h-40 overflow-auto scrollbar-none {className} items-start\">\r\n\t{#if filteredPrompts.length > 0}\r\n\t\t{#each filteredPrompts as prompt, idx (prompt.id || prompt.content)}\r\n\t\t\t<button\r\n\t\t\t\tclass=\"waterfall flex flex-col flex-1 shrink-0 w-full justify-between\r\n\t\t\t\t       px-3 py-2 rounded-xl bg-transparent hover:bg-black/5\r\n\t\t\t\t       dark:hover:bg-white/5 transition group\"\r\n\t\t\t\tstyle=\"animation-delay: {idx * 60}ms\"\r\n\t\t\t\ton:click={() => dispatch('select', prompt.content)}\r\n\t\t\t>\r\n\t\t\t\t<div class=\"flex flex-col text-left\">\r\n\t\t\t\t\t{#if prompt.title && prompt.title[0] !== ''}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\"font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{prompt.title[0]}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"text-xs text-gray-500 font-normal line-clamp-1\">\r\n\t\t\t\t\t\t\t{prompt.title[1]}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\"font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{prompt.content}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"text-xs text-gray-500 font-normal line-clamp-1\">{$i18n.t('Prompt')}</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t</button>\r\n\t\t{/each}\r\n\t{/if}\r\n</div>\r\n\r\n<style>\r\n\t/* Waterfall animation for the suggestions */\r\n\t@keyframes fadeInUp {\r\n\t\t0% {\r\n\t\t\topacity: 0;\r\n\t\t\ttransform: translateY(20px);\r\n\t\t}\r\n\t\t100% {\r\n\t\t\topacity: 1;\r\n\t\t\ttransform: translateY(0);\r\n\t\t}\r\n\t}\r\n\r\n\t.waterfall {\r\n\t\topacity: 0;\r\n\t\tanimation-name: fadeInUp;\r\n\t\tanimation-duration: 200ms;\r\n\t\tanimation-fill-mode: forwards;\r\n\t\tanimation-timing-function: ease;\r\n\t}\r\n</style>\r\n","<script lang=\"ts\">\r\n\texport let className = 'w-4 h-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport { WEBUI_BASE_URL } from '$lib/constants';\r\n\timport { marked } from 'marked';\r\n\r\n\timport { config, user, models as _models, temporaryChatEnabled } from '$lib/stores';\r\n\timport { onMount, getContext } from 'svelte';\r\n\r\n\timport { blur, fade } from 'svelte/transition';\r\n\r\n\timport Suggestions from './Suggestions.svelte';\r\n\timport { sanitizeResponseContent } from '$lib/utils';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport EyeSlash from '$lib/components/icons/EyeSlash.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let modelIds = [];\r\n\texport let models = [];\r\n\r\n\texport let submitPrompt;\r\n\r\n\tlet mounted = false;\r\n\tlet selectedModelIdx = 0;\r\n\r\n\t$: if (modelIds.length > 0) {\r\n\t\tselectedModelIdx = models.length - 1;\r\n\t}\r\n\r\n\t$: models = modelIds.map((id) => $_models.find((m) => m.id === id));\r\n\r\n\tonMount(() => {\r\n\t\tmounted = true;\r\n\t});\r\n</script>\r\n\r\n{#key mounted}\r\n\t<div class=\"m-auto w-full max-w-6xl px-8 lg:px-20\">\r\n\t\t<div class=\"flex justify-start\">\r\n\t\t\t<div class=\"flex -space-x-4 mb-0.5\" in:fade={{ duration: 200 }}>\r\n\t\t\t\t{#each models as model, modelIdx}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tselectedModelIdx = modelIdx;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\tcontent={marked.parse(\r\n\t\t\t\t\t\t\t\tsanitizeResponseContent(models[selectedModelIdx]?.info?.meta?.description ?? '')\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\tplacement=\"right\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\tcrossorigin=\"anonymous\"\r\n\t\t\t\t\t\t\t\tsrc={model?.info?.meta?.profile_image_url ??\r\n\t\t\t\t\t\t\t\t\t($i18n.language === 'dg-DG'\r\n\t\t\t\t\t\t\t\t\t\t? `/doge.png`\r\n\t\t\t\t\t\t\t\t\t\t: `${WEBUI_BASE_URL}/static/favicon.png`)}\r\n\t\t\t\t\t\t\t\tclass=\" size-[2.7rem] rounded-full border-[1px] border-gray-200 dark:border-none\"\r\n\t\t\t\t\t\t\t\talt=\"logo\"\r\n\t\t\t\t\t\t\t\tdraggable=\"false\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/each}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t{#if $temporaryChatEnabled}\r\n\t\t\t<Tooltip\r\n\t\t\t\tcontent=\"This chat won't appear in history and your messages will not be saved.\"\r\n\t\t\t\tclassName=\"w-fit\"\r\n\t\t\t\tplacement=\"top-start\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit\">\r\n\t\t\t\t\t<EyeSlash strokeWidth=\"2.5\" className=\"size-5\" /> Temporary Chat\r\n\t\t\t\t</div>\r\n\t\t\t</Tooltip>\r\n\t\t{/if}\r\n\r\n\t\t<div\r\n\t\t\tclass=\" mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary\"\r\n\t\t>\r\n\t\t\t<div>\r\n\t\t\t\t<div class=\" capitalize line-clamp-1\" in:fade={{ duration: 200 }}>\r\n\t\t\t\t\t{#if models[selectedModelIdx]?.name}\r\n\t\t\t\t\t\t{models[selectedModelIdx]?.name}\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t{$i18n.t('Hello, {{name}}', { name: $user.name })}\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div in:fade={{ duration: 200, delay: 200 }}>\r\n\t\t\t\t\t{#if models[selectedModelIdx]?.info?.meta?.description ?? null}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\"mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{@html marked.parse(\r\n\t\t\t\t\t\t\t\tsanitizeResponseContent(models[selectedModelIdx]?.info?.meta?.description)\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{#if models[selectedModelIdx]?.info?.meta?.user}\r\n\t\t\t\t\t\t\t<div class=\"mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500\">\r\n\t\t\t\t\t\t\t\tBy\r\n\t\t\t\t\t\t\t\t{#if models[selectedModelIdx]?.info?.meta?.user.community}\r\n\t\t\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\t\t\thref=\"https://openwebui.com/m/{models[selectedModelIdx]?.info?.meta?.user\r\n\t\t\t\t\t\t\t\t\t\t\t.username}\"\r\n\t\t\t\t\t\t\t\t\t\t>{models[selectedModelIdx]?.info?.meta?.user.name\r\n\t\t\t\t\t\t\t\t\t\t\t? models[selectedModelIdx]?.info?.meta?.user.name\r\n\t\t\t\t\t\t\t\t\t\t\t: `@${models[selectedModelIdx]?.info?.meta?.user.username}`}</a\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t{models[selectedModelIdx]?.info?.meta?.user.name}\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<div class=\" font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p\">\r\n\t\t\t\t\t\t\t{$i18n.t('How can I help you today?')}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\" w-full font-primary\" in:fade={{ duration: 200, delay: 300 }}>\r\n\t\t\t<Suggestions\r\n\t\t\t\tclassName=\"grid grid-cols-2\"\r\n\t\t\t\tsuggestionPrompts={models[selectedModelIdx]?.info?.meta?.suggestion_prompts ??\r\n\t\t\t\t\t$config?.default_prompt_suggestions ??\r\n\t\t\t\t\t[]}\r\n\t\t\t\ton:select={(e) => {\r\n\t\t\t\t\tsubmitPrompt(e.detail);\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t</div>\r\n{/key}\r\n","<script lang=\"ts\">\r\n\timport { v4 as uuidv4 } from 'uuid';\r\n\timport {\r\n\t\tchats,\r\n\t\tconfig,\r\n\t\tsettings,\r\n\t\tuser as _user,\r\n\t\tmobile,\r\n\t\tcurrentChatPage,\r\n\t\ttemporaryChatEnabled\r\n\t} from '$lib/stores';\r\n\timport { tick, getContext, onMount, createEventDispatcher } from 'svelte';\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\timport { toast } from 'svelte-sonner';\r\n\timport { getChatList, updateChatById } from '$lib/apis/chats';\r\n\timport { copyToClipboard, findWordIndices } from '$lib/utils';\r\n\r\n\timport Message from './Messages/Message.svelte';\r\n\timport Loader from '../common/Loader.svelte';\r\n\timport Spinner from '../common/Spinner.svelte';\r\n\r\n\timport ChatPlaceholder from './ChatPlaceholder.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let className = 'h-full flex pt-8';\r\n\r\n\texport let chatId = '';\r\n\texport let user = $_user;\r\n\r\n\texport let prompt;\r\n\texport let history = {};\r\n\texport let selectedModels;\r\n\r\n\tlet messages = [];\r\n\r\n\texport let sendPrompt: Function;\r\n\texport let continueResponse: Function;\r\n\texport let regenerateResponse: Function;\r\n\texport let mergeResponses: Function;\r\n\r\n\texport let chatActionHandler: Function;\r\n\texport let showMessage: Function = () => {};\r\n\texport let submitMessage: Function = () => {};\r\n\texport let addMessages: Function = () => {};\r\n\r\n\texport let readOnly = false;\r\n\r\n\texport let bottomPadding = false;\r\n\texport let autoScroll;\r\n\r\n\tlet messagesCount = 20;\r\n\tlet messagesLoading = false;\r\n\r\n\tconst loadMoreMessages = async () => {\r\n\t\t// scroll slightly down to disable continuous loading\r\n\t\tconst element = document.getElementById('messages-container');\r\n\t\telement.scrollTop = element.scrollTop + 100;\r\n\r\n\t\tmessagesLoading = true;\r\n\t\tmessagesCount += 20;\r\n\r\n\t\tawait tick();\r\n\r\n\t\tmessagesLoading = false;\r\n\t};\r\n\r\n\t$: if (history.currentId) {\r\n\t\tlet _messages = [];\r\n\r\n\t\tlet message = history.messages[history.currentId];\r\n\t\twhile (message && _messages.length <= messagesCount) {\r\n\t\t\t_messages.unshift({ ...message });\r\n\t\t\tmessage = message.parentId !== null ? history.messages[message.parentId] : null;\r\n\t\t}\r\n\r\n\t\tmessages = _messages;\r\n\t} else {\r\n\t\tmessages = [];\r\n\t}\r\n\r\n\t$: if (autoScroll && bottomPadding) {\r\n\t\t(async () => {\r\n\t\t\tawait tick();\r\n\t\t\tscrollToBottom();\r\n\t\t})();\r\n\t}\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tconst element = document.getElementById('messages-container');\r\n\t\telement.scrollTop = element.scrollHeight;\r\n\t};\r\n\r\n\tconst updateChat = async () => {\r\n\t\tif (!$temporaryChatEnabled) {\r\n\t\t\thistory = history;\r\n\t\t\tawait tick();\r\n\t\t\tawait updateChatById(localStorage.token, chatId, {\r\n\t\t\t\thistory: history,\r\n\t\t\t\tmessages: messages\r\n\t\t\t});\r\n\r\n\t\t\tcurrentChatPage.set(1);\r\n\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\r\n\t\t}\r\n\t};\r\n\r\n\tconst showPreviousMessage = async (message) => {\r\n\t\tif (message.parentId !== null) {\r\n\t\t\tlet messageId =\r\n\t\t\t\thistory.messages[message.parentId].childrenIds[\r\n\t\t\t\t\tMath.max(history.messages[message.parentId].childrenIds.indexOf(message.id) - 1, 0)\r\n\t\t\t\t];\r\n\r\n\t\t\tif (message.id !== messageId) {\r\n\t\t\t\tlet messageChildrenIds = history.messages[messageId].childrenIds;\r\n\r\n\t\t\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\t\t\tmessageId = messageChildrenIds.at(-1);\r\n\t\t\t\t\tmessageChildrenIds = history.messages[messageId].childrenIds;\r\n\t\t\t\t}\r\n\r\n\t\t\t\thistory.currentId = messageId;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tlet childrenIds = Object.values(history.messages)\r\n\t\t\t\t.filter((message) => message.parentId === null)\r\n\t\t\t\t.map((message) => message.id);\r\n\t\t\tlet messageId = childrenIds[Math.max(childrenIds.indexOf(message.id) - 1, 0)];\r\n\r\n\t\t\tif (message.id !== messageId) {\r\n\t\t\t\tlet messageChildrenIds = history.messages[messageId].childrenIds;\r\n\r\n\t\t\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\t\t\tmessageId = messageChildrenIds.at(-1);\r\n\t\t\t\t\tmessageChildrenIds = history.messages[messageId].childrenIds;\r\n\t\t\t\t}\r\n\r\n\t\t\t\thistory.currentId = messageId;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tawait tick();\r\n\r\n\t\tif ($settings?.scrollOnBranchChange ?? true) {\r\n\t\t\tconst element = document.getElementById('messages-container');\r\n\t\t\tautoScroll = element.scrollHeight - element.scrollTop <= element.clientHeight + 50;\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tscrollToBottom();\r\n\t\t\t}, 100);\r\n\t\t}\r\n\t};\r\n\r\n\tconst showNextMessage = async (message) => {\r\n\t\tif (message.parentId !== null) {\r\n\t\t\tlet messageId =\r\n\t\t\t\thistory.messages[message.parentId].childrenIds[\r\n\t\t\t\t\tMath.min(\r\n\t\t\t\t\t\thistory.messages[message.parentId].childrenIds.indexOf(message.id) + 1,\r\n\t\t\t\t\t\thistory.messages[message.parentId].childrenIds.length - 1\r\n\t\t\t\t\t)\r\n\t\t\t\t];\r\n\r\n\t\t\tif (message.id !== messageId) {\r\n\t\t\t\tlet messageChildrenIds = history.messages[messageId].childrenIds;\r\n\r\n\t\t\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\t\t\tmessageId = messageChildrenIds.at(-1);\r\n\t\t\t\t\tmessageChildrenIds = history.messages[messageId].childrenIds;\r\n\t\t\t\t}\r\n\r\n\t\t\t\thistory.currentId = messageId;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tlet childrenIds = Object.values(history.messages)\r\n\t\t\t\t.filter((message) => message.parentId === null)\r\n\t\t\t\t.map((message) => message.id);\r\n\t\t\tlet messageId =\r\n\t\t\t\tchildrenIds[Math.min(childrenIds.indexOf(message.id) + 1, childrenIds.length - 1)];\r\n\r\n\t\t\tif (message.id !== messageId) {\r\n\t\t\t\tlet messageChildrenIds = history.messages[messageId].childrenIds;\r\n\r\n\t\t\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\t\t\tmessageId = messageChildrenIds.at(-1);\r\n\t\t\t\t\tmessageChildrenIds = history.messages[messageId].childrenIds;\r\n\t\t\t\t}\r\n\r\n\t\t\t\thistory.currentId = messageId;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tawait tick();\r\n\r\n\t\tif ($settings?.scrollOnBranchChange ?? true) {\r\n\t\t\tconst element = document.getElementById('messages-container');\r\n\t\t\tautoScroll = element.scrollHeight - element.scrollTop <= element.clientHeight + 50;\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tscrollToBottom();\r\n\t\t\t}, 100);\r\n\t\t}\r\n\t};\r\n\r\n\tconst rateMessage = async (messageId, rating) => {\r\n\t\thistory.messages[messageId].annotation = {\r\n\t\t\t...history.messages[messageId].annotation,\r\n\t\t\trating: rating\r\n\t\t};\r\n\r\n\t\tawait updateChat();\r\n\t};\r\n\r\n\tconst editMessage = async (messageId, content, submit = true) => {\r\n\t\tif (history.messages[messageId].role === 'user') {\r\n\t\t\tif (submit) {\r\n\t\t\t\t// New user message\r\n\t\t\t\tlet userPrompt = content;\r\n\t\t\t\tlet userMessageId = uuidv4();\r\n\r\n\t\t\t\tlet userMessage = {\r\n\t\t\t\t\tid: userMessageId,\r\n\t\t\t\t\tparentId: history.messages[messageId].parentId,\r\n\t\t\t\t\tchildrenIds: [],\r\n\t\t\t\t\trole: 'user',\r\n\t\t\t\t\tcontent: userPrompt,\r\n\t\t\t\t\t...(history.messages[messageId].files && { files: history.messages[messageId].files }),\r\n\t\t\t\t\tmodels: selectedModels\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlet messageParentId = history.messages[messageId].parentId;\r\n\r\n\t\t\t\tif (messageParentId !== null) {\r\n\t\t\t\t\thistory.messages[messageParentId].childrenIds = [\r\n\t\t\t\t\t\t...history.messages[messageParentId].childrenIds,\r\n\t\t\t\t\t\tuserMessageId\r\n\t\t\t\t\t];\r\n\t\t\t\t}\r\n\r\n\t\t\t\thistory.messages[userMessageId] = userMessage;\r\n\t\t\t\thistory.currentId = userMessageId;\r\n\r\n\t\t\t\tawait tick();\r\n\t\t\t\tawait sendPrompt(history, userPrompt, userMessageId);\r\n\t\t\t} else {\r\n\t\t\t\t// Edit user message\r\n\t\t\t\thistory.messages[messageId].content = content;\r\n\t\t\t\tawait updateChat();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (submit) {\r\n\t\t\t\t// New response message\r\n\t\t\t\tconst responseMessageId = uuidv4();\r\n\t\t\t\tconst message = history.messages[messageId];\r\n\t\t\t\tconst parentId = message.parentId;\r\n\r\n\t\t\t\tconst responseMessage = {\r\n\t\t\t\t\t...message,\r\n\t\t\t\t\tid: responseMessageId,\r\n\t\t\t\t\tparentId: parentId,\r\n\t\t\t\t\tchildrenIds: [],\r\n\t\t\t\t\tfiles: undefined,\r\n\t\t\t\t\tcontent: content,\r\n\t\t\t\t\ttimestamp: Math.floor(Date.now() / 1000) // Unix epoch\r\n\t\t\t\t};\r\n\r\n\t\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\t\t\t\thistory.currentId = responseMessageId;\r\n\r\n\t\t\t\t// Append messageId to childrenIds of parent message\r\n\t\t\t\tif (parentId !== null) {\r\n\t\t\t\t\thistory.messages[parentId].childrenIds = [\r\n\t\t\t\t\t\t...history.messages[parentId].childrenIds,\r\n\t\t\t\t\t\tresponseMessageId\r\n\t\t\t\t\t];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tawait updateChat();\r\n\t\t\t} else {\r\n\t\t\t\t// Edit response message\r\n\t\t\t\thistory.messages[messageId].originalContent = history.messages[messageId].content;\r\n\t\t\t\thistory.messages[messageId].content = content;\r\n\t\t\t\tawait updateChat();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst actionMessage = async (actionId, message, event = null) => {\r\n\t\tawait chatActionHandler(chatId, actionId, message.model, message.id, event);\r\n\t};\r\n\r\n\tconst saveMessage = async (messageId, message) => {\r\n\t\thistory.messages[messageId] = message;\r\n\t\tawait updateChat();\r\n\t};\r\n\r\n\tconst deleteMessage = async (messageId) => {\r\n\t\tconst messageToDelete = history.messages[messageId];\r\n\t\tconst parentMessageId = messageToDelete.parentId;\r\n\t\tconst childMessageIds = messageToDelete.childrenIds ?? [];\r\n\r\n\t\t// Collect all grandchildren\r\n\t\tconst grandchildrenIds = childMessageIds.flatMap(\r\n\t\t\t(childId) => history.messages[childId]?.childrenIds ?? []\r\n\t\t);\r\n\r\n\t\t// Update parent's children\r\n\t\tif (parentMessageId && history.messages[parentMessageId]) {\r\n\t\t\thistory.messages[parentMessageId].childrenIds = [\r\n\t\t\t\t...history.messages[parentMessageId].childrenIds.filter((id) => id !== messageId),\r\n\t\t\t\t...grandchildrenIds\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\t// Update grandchildren's parent\r\n\t\tgrandchildrenIds.forEach((grandchildId) => {\r\n\t\t\tif (history.messages[grandchildId]) {\r\n\t\t\t\thistory.messages[grandchildId].parentId = parentMessageId;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Delete the message and its children\r\n\t\t[messageId, ...childMessageIds].forEach((id) => {\r\n\t\t\tdelete history.messages[id];\r\n\t\t});\r\n\r\n\t\tawait tick();\r\n\r\n\t\tshowMessage({ id: parentMessageId });\r\n\r\n\t\t// Update the chat\r\n\t\tawait updateChat();\r\n\t};\r\n\r\n\tconst triggerScroll = () => {\r\n\t\tif (autoScroll) {\r\n\t\t\tconst element = document.getElementById('messages-container');\r\n\t\t\tautoScroll = element.scrollHeight - element.scrollTop <= element.clientHeight + 50;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tscrollToBottom();\r\n\t\t\t}, 100);\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<div class={className}>\r\n\t{#if Object.keys(history?.messages ?? {}).length == 0}\r\n\t\t<ChatPlaceholder\r\n\t\t\tmodelIds={selectedModels}\r\n\t\t\tsubmitPrompt={async (p) => {\r\n\t\t\t\tlet text = p;\r\n\r\n\t\t\t\tif (p.includes('{{CLIPBOARD}}')) {\r\n\t\t\t\t\tconst clipboardText = await navigator.clipboard.readText().catch((err) => {\r\n\t\t\t\t\t\ttoast.error($i18n.t('Failed to read clipboard contents'));\r\n\t\t\t\t\t\treturn '{{CLIPBOARD}}';\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\ttext = p.replaceAll('{{CLIPBOARD}}', clipboardText);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tprompt = text;\r\n\r\n\t\t\t\tawait tick();\r\n\r\n\t\t\t\tconst chatInputContainerElement = document.getElementById('chat-input-container');\r\n\t\t\t\tif (chatInputContainerElement) {\r\n\t\t\t\t\tprompt = p;\r\n\r\n\t\t\t\t\tchatInputContainerElement.style.height = '';\r\n\t\t\t\t\tchatInputContainerElement.style.height =\r\n\t\t\t\t\t\tMath.min(chatInputContainerElement.scrollHeight, 200) + 'px';\r\n\t\t\t\t\tchatInputContainerElement.focus();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tawait tick();\r\n\t\t\t}}\r\n\t\t/>\r\n\t{:else}\r\n\t\t<div class=\"w-full pt-2\">\r\n\t\t\t{#key chatId}\r\n\t\t\t\t<div class=\"w-full\">\r\n\t\t\t\t\t{#if messages.at(0)?.parentId !== null}\r\n\t\t\t\t\t\t<Loader\r\n\t\t\t\t\t\t\ton:visible={(e) => {\r\n\t\t\t\t\t\t\t\tconsole.log('visible');\r\n\t\t\t\t\t\t\t\tif (!messagesLoading) {\r\n\t\t\t\t\t\t\t\t\tloadMoreMessages();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div class=\"w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2\">\r\n\t\t\t\t\t\t\t\t<Spinner className=\" size-4\" />\r\n\t\t\t\t\t\t\t\t<div class=\" \">Loading...</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Loader>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t{#each messages as message, messageIdx (message.id)}\r\n\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\t{chatId}\r\n\t\t\t\t\t\t\tbind:history\r\n\t\t\t\t\t\t\tmessageId={message.id}\r\n\t\t\t\t\t\t\tidx={messageIdx}\r\n\t\t\t\t\t\t\t{user}\r\n\t\t\t\t\t\t\t{showPreviousMessage}\r\n\t\t\t\t\t\t\t{showNextMessage}\r\n\t\t\t\t\t\t\t{updateChat}\r\n\t\t\t\t\t\t\t{editMessage}\r\n\t\t\t\t\t\t\t{deleteMessage}\r\n\t\t\t\t\t\t\t{rateMessage}\r\n\t\t\t\t\t\t\t{actionMessage}\r\n\t\t\t\t\t\t\t{saveMessage}\r\n\t\t\t\t\t\t\t{submitMessage}\r\n\t\t\t\t\t\t\t{regenerateResponse}\r\n\t\t\t\t\t\t\t{continueResponse}\r\n\t\t\t\t\t\t\t{mergeResponses}\r\n\t\t\t\t\t\t\t{addMessages}\r\n\t\t\t\t\t\t\t{triggerScroll}\r\n\t\t\t\t\t\t\t{readOnly}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"pb-12\" />\r\n\t\t\t\t{#if bottomPadding}\r\n\t\t\t\t\t<div class=\"  pb-6\" />\r\n\t\t\t\t{/if}\r\n\t\t\t{/key}\r\n\t\t</div>\r\n\t{/if}\r\n</div>\r\n"],"names":["KokoroWorker","dtype","__publicField","WorkerInstance","event","status","error","audioUrl","request","resolve","reject","handleMessage","text","voice","attr","div0","div0_class_value","ctx","div1","div1_class_value","div2","div2_class_value","div4","div4_class_value","div5","div5_class_value","div6","div6_class_value","div8","div8_class_value","div9","div9_class_value","insert_hydration","target","div11","anchor","append_hydration","div10","div3","div7","dirty","size","$$props","_a","div","button","button_class_value","button_disabled_value","_b","i","set_data","t0","t0_value","t_value","create_if_block_1","create_if_block_2","create_if_block_3","create_if_block_4","create_if_block_5","create_if_block_6","create_if_block_7","create_if_block_8","create_if_block_9","create_if_block_10","create_if_block_11","create_if_block_12","create_if_block_13","create_if_block_14","if_block0","create_if_block_15","each_value_1","ensure_array_like","func","create_if_block","div12","div12_id_value","button0","textarea","button1","t1","t1_value","t6","t6_value","t9","t9_value","t14","t14_value","current","_","i18n","getContext","dispatch","createEventDispatcher","message","show","LIKE_REASONS","DISLIKE_REASONS","tags","reasons","selectedReason","comment","detailedRating","selectedModel","init","$$invalidate","_c","tag","_e","_d","onMount","$models","m","toast","$i18n","saveHandler","rating","reason","e","a","a_href_value","a_class_value","if_block","each_value","state","value","svg","path","className","strokeWidth","content","calculatePercentage","child_ctx","t","t3_value","span","t3","WEBUI_API_BASE_URL","_f","_h","_g","_j","_i","_l","_k","t4_value","span0","span0_class_value","getRelevanceColor","span1","t4","pre","iframe","iframe_srcdoc_value","hr","if_block2","each_blocks","distance","percentage","citation","showPercentage","showRelevance","mergedDocuments","c","doc","b","show_if","each_value_2","span2","t5","t5_value","t7","t7_value","button_id_value","calculateShowRelevance","sources","distances","inRange","d","outOfRange","shouldShowPercentage","id","citations","showCitationModal","selectedCitation","isCollapsibleOpen","func_1","func_2","acc","source","document","index","metadata","_source","existingSource","item","t2_value","t2","ul","li","if_block1","if_block3","_m","_o","_n","if_block4","_q","_p","_s","_r","codeblock_changes","codeExecution","get_key","codeExecutions","selectedCodeExecution","showCodeExecutionModal","updateSelectedCodeExecution","execution","input","model","messages","onAdd","floatingInput","selectedText","floatingInputValue","prompt","responseContent","responseDone","autoScroll","responseContainer","askHandler","res","controller","chatCompletion","reader","decoder","done","lines","line","tick","data","explainHandler","addHandler","closeHandler","createMessagesList","floatingbuttons_changes","markdown_changes","history","save","floatingButtons","onSourceClick","onTaskClick","onAddMessages","contentContainerElement","floatingButtonsElement","updateButtonPosition","buttonsContainerElement","closeFloatingButtons","selection","rect","parentRect","top","left","spaceOnRight","halfScreenWidth","$mobile","right","keydownHandler","onDestroy","s","ids","lang","code","$chatId","showArtifacts","showControls","$$value","modelId","parentId","constants_0","dayjs","formatDate","create_if_block_37","tooltip_changes","image_changes","create_if_block_36","create_if_block_25","create_if_block_34","create_if_block_32","create_if_block_33","create_if_block_28","create_if_block_29","create_if_block_21","create_if_block_20","create_if_block_19","textarea_id_value","button2","contentrenderer_changes","error_changes","citations_changes","codeexecutions_changes","create_if_block_17","create_if_block_16","style","circle0","circle1","circle2","sanitizeResponseContent","func_4","func_5","path0","path1","src_url_equal","img","img_src_value","img_class_value","img_alt_value","WEBUI_BASE_URL","create_if_block_24","get_if_ctx","null_to_empty","div5_id_value","div5_dir_value","previous_key","safe_not_equal","f","chatId","messageId","siblings","showPreviousMessage","showNextMessage","updateChat","editMessage","saveMessage","rateMessage","actionMessage","deleteMessage","submitMessage","continueResponse","regenerateResponse","addMessages","isLastMessage","readOnly","showDeleteConfirm","edit","editedContent","editTextAreaElement","audioParts","speaking","speakingIdx","loadingSpeech","generatingImage","showRateComment","copyToClipboard","_copyToClipboard","playAudio","idx","audio","r","toggleSpeakMessage","$config","voices","getVoicesLoop","v","$settings","speak","messageContentParts","getMessageContentParts","_sentence","lastPlayedAudioPromise","$TTSWorker","TTSWorker","sentence","blob","synthesizeOpenAISpeech","_u","_t","blobUrl","_w","_v","editMessageHandler","editMessageConfirmHandler","saveAsCopyHandler","cancelEditMessage","generateImage","imageGenerations","files","image","feedbackLoading","feedbackHandler","details","updatedMessage","chat","getChatById","feedbackItem","baseModels","feedback","updateFeedbackById","createNewFeedback","generateTags","deleteMessageHandler","isCmdOrCtrlPressed","isEnterPressed","sourceButton","sourcesCollapsible","raw","oldContent","newContent","type","action","div_class_value","get_if_ctx_1","localizedFormat","mergeResponses","triggerScroll","currentMessageId","parentMessage","groupedMessageIds","groupedMessageIdsIdx","modelIdx","messageChildrenIds","initHandler","modelMessageIds","modelMessages","mergeResponsesHandler","responses","messageIds","messageElement","_messageId","profileimage_changes","fileitem_changes","div2_dir_value","div2_id_value","user","isFirstMessage","messageEditTextAreaElement","submit","usermessage_changes","WEBUI_VERSION","set_style","arraysEqual","suggestionPrompts","inputValue","sortedPrompts","fuseOptions","fuse","filteredPrompts","getFilteredPrompts","newFilteredPrompts","result","click_handler","Fuse","marked","raw_value","html_tag","div0_intro","create_in_transition","fade","div2_intro","div3_intro","div6_intro","modelIds","models","submitPrompt","mounted","selectedModelIdx","$_models","message_1_changes","$_user","selectedModels","sendPrompt","chatActionHandler","showMessage","bottomPadding","messagesCount","messagesLoading","loadMoreMessages","element","scrollToBottom","$temporaryChatEnabled","updateChatById","currentChatPage","chats","getChatList","$currentChatPage","childrenIds","userPrompt","userMessageId","uuidv4","userMessage","messageParentId","responseMessageId","responseMessage","actionId","messageToDelete","parentMessageId","childMessageIds","grandchildrenIds","childId","grandchildId","p","clipboardText","err","chatInputContainerElement","_messages"],"mappings":"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"}